<!DOCTYPE html>
<html lang="zh-cn" itemscope itemtype="http://schema.org/WebPage">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>【项目 Vue2 轮子】1.2 简单轮子VueButton 添加单元测试 - Joel in The House</title>
  

<meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=yes"/>

<meta name="MobileOptimized" content="width"/>
<meta name="HandheldFriendly" content="true"/>


<meta name="applicable-device" content="pc,mobile">

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">

<meta name="mobile-web-app-capable" content="yes">

<meta name="author" content="Joel Xu" />
  <meta name="description" content="VueButton添加单元测试 [toc] 添加单元测试与Mock数据 Chai 让测试更方便，断言代码符合自然语言描述 Chai.js 官网 https://www.chaijs.com/ BDD - Behavior-Driven Development 自然语言描述需求 foo.shoud.be.a(&#39;string&#39;) TDD - Test-Driven Development" />

  <meta name="keywords" content="Hugo, theme, jane" />






<meta name="generator" content="Hugo 0.91.2" />


<link rel="canonical" href="http://xmasuhai.xyz/post/project/vueel2/%E9%A1%B9%E7%9B%AE-vue2-%E8%BD%AE%E5%AD%901.2-%E7%AE%80%E5%8D%95%E8%BD%AE%E5%AD%90-vuebutton-%E6%B7%BB%E5%8A%A0%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95/" />





<link rel="icon" href="/favicon.ico" />











<link rel="stylesheet" href="/sass/jane.min.af20b78e95c84de86b00a0242a4a77bd2601700e1b250edf27537d957ac0041d.css" integrity="sha256-ryC3jpXITehrAKAkKkp3vSYBcA4bJQ7fJ1N9lXrABB0=" media="screen" crossorigin="anonymous">





<meta property="og:title" content="【项目 Vue2 轮子】1.2 简单轮子VueButton 添加单元测试" />
<meta property="og:description" content="VueButton添加单元测试 [toc] 添加单元测试与Mock数据 Chai 让测试更方便，断言代码符合自然语言描述 Chai.js 官网 https://www.chaijs.com/ BDD - Behavior-Driven Development 自然语言描述需求 foo.shoud.be.a(&#39;string&#39;) TDD - Test-Driven Development" />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://xmasuhai.xyz/post/project/vueel2/%E9%A1%B9%E7%9B%AE-vue2-%E8%BD%AE%E5%AD%901.2-%E7%AE%80%E5%8D%95%E8%BD%AE%E5%AD%90-vuebutton-%E6%B7%BB%E5%8A%A0%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2021-12-09T12:25:45+08:00" />
<meta property="article:modified_time" content="2022-09-03T10:26:25+08:00" />

<meta itemprop="name" content="【项目 Vue2 轮子】1.2 简单轮子VueButton 添加单元测试">
<meta itemprop="description" content="VueButton添加单元测试 [toc] 添加单元测试与Mock数据 Chai 让测试更方便，断言代码符合自然语言描述 Chai.js 官网 https://www.chaijs.com/ BDD - Behavior-Driven Development 自然语言描述需求 foo.shoud.be.a(&#39;string&#39;) TDD - Test-Driven Development"><meta itemprop="datePublished" content="2021-12-09T12:25:45+08:00" />
<meta itemprop="dateModified" content="2022-09-03T10:26:25+08:00" />
<meta itemprop="wordCount" content="12515">
<meta itemprop="keywords" content="FrontEnd,Project,vueel,vue2," /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="【项目 Vue2 轮子】1.2 简单轮子VueButton 添加单元测试"/>
<meta name="twitter:description" content="VueButton添加单元测试 [toc] 添加单元测试与Mock数据 Chai 让测试更方便，断言代码符合自然语言描述 Chai.js 官网 https://www.chaijs.com/ BDD - Behavior-Driven Development 自然语言描述需求 foo.shoud.be.a(&#39;string&#39;) TDD - Test-Driven Development"/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->




</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">Joel in The House</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="http://xmasuhai.xyz/">主页</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="http://xmasuhai.xyz/post/">文档</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="http://xmasuhai.xyz/tags/">标签</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="http://xmasuhai.xyz/categories/">目录</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="http://xmasuhai.xyz/about/">关于我</a>
          
        
      </li>
    

    
  </ul>
</nav>


  
    






  <link rel="stylesheet" href="/lib/photoswipe/photoswipe.min.css" />
  <link rel="stylesheet" href="/lib/photoswipe/default-skin/default-skin.min.css" />




<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

<div class="pswp__bg"></div>

<div class="pswp__scroll-wrap">
    
    <div class="pswp__container">
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
    </div>
    
    <div class="pswp__ui pswp__ui--hidden">
    <div class="pswp__top-bar">
      
      <div class="pswp__counter"></div>
      <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
      <button class="pswp__button pswp__button--share" title="Share"></button>
      <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
      <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
      
      
      <div class="pswp__preloader">
        <div class="pswp__preloader__icn">
          <div class="pswp__preloader__cut">
            <div class="pswp__preloader__donut"></div>
          </div>
        </div>
      </div>
    </div>
    <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
      <div class="pswp__share-tooltip"></div>
    </div>
    <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
    </button>
    <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
    </button>
    <div class="pswp__caption">
      <div class="pswp__caption__center"></div>
    </div>
    </div>
    </div>
</div>

  

  

  

  <header id="header" class="header container">
    <div class="logo-wrapper">
  <a href="/" class="logo">
    
      Joel in The House
    
  </a>
</div>

<nav class="site-navbar">
  <ul id="menu" class="menu">
    
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="http://xmasuhai.xyz/">主页</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="http://xmasuhai.xyz/post/">文档</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="http://xmasuhai.xyz/tags/">标签</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="http://xmasuhai.xyz/categories/">目录</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="http://xmasuhai.xyz/about/">关于我</a>
          

        

      </li>
    

    
    

    
  </ul>
</nav>

  </header>

  <div id="mobile-panel">
    <main id="main" class="main bg-llight">
      <div class="content-wrapper">
        <div id="content" class="content container">
          <article class="post bg-white">
    
    <header class="post-header">
      <h1 class="post-title">【项目 Vue2 轮子】1.2 简单轮子VueButton 添加单元测试</h1>
      
      <div class="post-meta">
        <time datetime="2021-12-09" class="post-time">
          2021-12-09
        </time>
        <div class="post-category">
            
          </div>
        <span class="more-meta"> 约 12515 字 </span>
          <span class="more-meta"> 预计阅读 25 分钟 </span>

        
        

        
        
      </div>
    </header>

    
    
<div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">文章目录</h2>
  <div class="post-toc-content">
    <nav id="TableOfContents">
  <ul>
    <li><a href="#添加单元测试与mock数据">添加单元测试与<code>Mock</code>数据</a>
      <ul>
        <li><a href="#动态生成一个按钮组件const-constructor--vueextendvuebutton">动态生成一个按钮（组件）<code>const Constructor = Vue.extend(VueButton)</code></a></li>
        <li><a href="#如何决定写几个单元测试">如何决定写几个单元测试</a></li>
        <li><a href="#测试-isloading-属性">测试 <code>isLoading</code> 属性</a></li>
        <li><a href="#加载-button">加载 button</a></li>
        <li><a href="#使用-chaispies-监听函数mock函数测试事件">使用 <code>chai.spies</code> 监听函数，<code>mock</code>函数，测试事件</a></li>
        <li><a href="#单元测试小结">单元测试小结</a></li>
      </ul>
    </li>
    <li><a href="#自动化测试">自动化测试</a>
      <ul>
        <li><a href="#使用-karma--mocha-做单元测试">使用 <code>Karma + Mocha</code> 做单元测试</a></li>
        <li><a href="#单元测试步骤">单元测试步骤</a></li>
        <li><a href="#在测试用例中使用-typescript">在测试用例中使用 <code>TypeScript</code></a></li>
      </ul>
    </li>
    <li><a href="#持续集成">持续集成</a>
      <ul>
        <li><a href="#持续集成的内容">持续集成的内容</a></li>
        <li><a href="#使用travis-ci做持续集成">使用<code>Travis CI</code>做持续集成</a></li>
      </ul>
    </li>
    <li><a href="#使用github-actions代替travis-ci">使用<code>GitHub Actions</code>代替<code>Travis CI</code></a>
      <ul>
        <li><a href="#github-actions配置文件文件名任意"><code>GitHub Actions</code>配置文件（文件名任意）</a></li>
        <li><a href="#邮件通知">邮件通知</a></li>
        <li><a href="#小结">小结</a></li>
      </ul>
    </li>
    <li><a href="#发布npm包">发布<code>npm</code>包</a>
      <ul>
        <li><a href="#1-确保代码测试通过了">1 确保代码测试通过了</a></li>
        <li><a href="#2-上传代码到-npmjsorg">2 上传代码到 <code>npmjs.org</code></a></li>
        <li><a href="#3-试用自己的包">3 试用自己的包</a></li>
        <li><a href="#使用本地注册-npm-link">使用本地注册 <code>npm link</code></a></li>
        <li><a href="#记录一个node入口文件名字的bug">记录一个<code>node</code>入口文件名字的bug</a></li>
      </ul>
    </li>
    <li><a href="#完成-readmemd">完成 <code>README.md</code></a>
      <ul>
        <li><a href="#添加badge">添加<code>badge</code></a></li>
      </ul>
    </li>
    <li><a href="#总结">总结</a></li>
  </ul>
</nav>
  </div>
</div>

    
    <div class="post-content">
      <h1 id="vuebutton添加单元测试">VueButton添加单元测试</h1>
<p>[toc]</p>
<hr>
<h2 id="添加单元测试与mock数据">添加单元测试与<code>Mock</code>数据</h2>
<blockquote>
<p><code>Chai</code> 让测试更方便，断言代码符合自然语言描述</p>
</blockquote>
<ul>
<li><code>Chai.js</code> <a href="https://www.chaijs.com/">官网 https://www.chaijs.com/</a></li>
<li><code>BDD</code> - <code>Behavior-Driven Development</code> 自然语言描述需求 <code>foo.shoud.be.a('string')</code></li>
<li><code>TDD</code> - <code>Test-Driven Development</code> 测试驱动开发——根据需求写出用例，实现用例，测试通过</li>
<li><code>Assert</code> 断言：主观的判断语句
<ul>
<li><code>console.assert(1 === 1)</code> 控制台内置的简单断言，断言判断为真，则后台无任何提示</li>
<li><code>console.assert(1 === 2)</code>  - 断言判断为假，则报错 <code>Asseration failed</code></li>
<li><code>console.assert( !!document.body )</code> 断言存在</li>
</ul>
</li>
</ul>
<blockquote>
<p>符合自然语言的断言，类似<code>assert('1').is.a('string')</code>（伪代码）</p>
</blockquote>
<ul>
<li>三种断言的形式：<code>should</code> <code>expect</code> <code>assert</code></li>
<li>使用最直观的 <code>expect</code>：<code>expect(varidate).to.be.a('string')</code></li>
<li><a href="http://caibaojian.com/scb/chai.html"><code>Chai.js</code> 前端速查表</a></li>
<li><a href="https://www.jianshu.com/p/aa53ac34e4c0"><code>Mocha</code>与<code>chai</code></a></li>
<li><a href="https://www.jianshu.com/p/f200a75a15d2"><code>Chai.js</code>断言库API中文文档</a></li>
<li><a href="https://www.jianshu.com/p/62f16cd4fef3">深度解读 - TDD（测试驱动开发）</a></li>
</ul>
<blockquote>
<p>安装<code>chai</code></p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="nb">cd</span> yourProject
<span class="c1"># npm install -D chai</span>
yarn add -D chai
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p><a href="https://www.chaijs.com/plugins/chai-spies/">安装<code>chai-spies</code> 断言库监听函数</a></p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="nb">cd</span> yourProject
<span class="c1"># npm install -D chai-spies</span>
yarn add -D chai-spies
</code></pre></td></tr></table>
</div>
</div><ul>
<li><a href="https://cn.vuejs.org/v2/guide/testing.html">Vue 文档单元测试</a></li>
</ul>
<hr>
<blockquote>
<p>引入<code>App.vue</code></p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-vue" data-lang="vue"><span class="p">&lt;</span><span class="nt">script</span><span class="p">&gt;</span>
<span class="kr">import</span> <span class="nx">Vue</span> <span class="nx">from</span> <span class="s1">&#39;vue&#39;</span>
<span class="kr">import</span> <span class="nx">VueButton</span> <span class="nx">from</span> <span class="s1">&#39;./components/vuebutton/VueButton.vue&#39;</span>
<span class="kr">import</span> <span class="nx">VueButtonGroup</span> <span class="nx">from</span> <span class="s1">&#39;./components/ButtonGroup/ButtonGroup.vue&#39;</span>

<span class="kr">import</span> <span class="nx">VueButton2</span> <span class="nx">from</span> <span class="s1">&#39;./components/vuebutton/VueButton&#39;</span>
<span class="kr">import</span> <span class="nx">VueIcon</span> <span class="nx">from</span> <span class="s1">&#39;./components/icon/Icon&#39;</span>

<span class="nx">Vue</span><span class="p">.</span><span class="nx">component</span><span class="p">(</span><span class="s1">&#39;v-button&#39;</span><span class="p">,</span> <span class="nx">VueButton2</span><span class="p">)</span>
<span class="nx">Vue</span><span class="p">.</span><span class="nx">component</span><span class="p">(</span><span class="s1">&#39;v-icon&#39;</span><span class="p">,</span> <span class="nx">VueIcon</span><span class="p">)</span>
<span class="nx">Vue</span><span class="p">.</span><span class="nx">component</span><span class="p">(</span><span class="s1">&#39;v-button-group&#39;</span><span class="p">,</span> <span class="nx">VueButtonGroup</span><span class="p">)</span>

<span class="c1">// 单元测试
</span><span class="c1"></span><span class="kr">import</span> <span class="nx">chai</span> <span class="nx">from</span> <span class="s1">&#39;chai&#39;</span>
<span class="kr">const</span> <span class="nx">expect</span> <span class="o">=</span> <span class="nx">chai</span><span class="p">.</span><span class="nx">expect</span>

<span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">VueButton</span><span class="p">)</span>
<span class="p">}</span>

<span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="动态生成一个按钮组件const-constructor--vueextendvuebutton">动态生成一个按钮（组件）<code>const Constructor = Vue.extend(VueButton)</code></h3>
<ul>
<li><code>VueButton</code> 是一个对象，无法通过对象去实例化</li>
<li>需要 构造函数 <code>const Constructor = Vue.extend(VueButton)</code>
<ul>
<li>扩展为<code>VueComponent</code> 函数</li>
</ul>
</li>
<li>实例化<code>const button = new Constructor()</code></li>
<li>挂载到一个节点上 <code>button.$mount('#test')</code></li>
<li>区别于直接把按钮写在页面里，是通过JS把按钮写在页面里</li>
</ul>
<blockquote>
<p><code>App.vue</code>动态创建按钮</p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-vue" data-lang="vue"><span class="p">&lt;</span><span class="nt">script</span><span class="p">&gt;</span>
<span class="kr">import</span> <span class="p">...</span>
<span class="c1">// 单元测试
</span><span class="c1"></span><span class="kr">import</span> <span class="nx">chai</span> <span class="nx">from</span> <span class="s1">&#39;chai&#39;</span>
<span class="kr">const</span> <span class="nx">expect</span> <span class="o">=</span> <span class="nx">chai</span><span class="p">.</span><span class="nx">expect</span>

<span class="p">{</span>
  <span class="c1">// 构造函数 扩展为全局的 VueComponent函数
</span><span class="c1"></span>  <span class="kr">const</span> <span class="nx">Constructor</span> <span class="o">=</span> <span class="nx">Vue</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nx">VueButton2</span><span class="p">)</span>
  <span class="kr">const</span> <span class="nx">button</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Constructor</span><span class="p">({</span>
    <span class="nx">propsData</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">icon</span><span class="o">:</span> <span class="s1">&#39;settings&#39;</span>
    <span class="p">},</span>
  <span class="p">})</span>
  <span class="c1">// button.$mount(&#39;#test&#39;)
</span><span class="c1"></span>  <span class="nx">button</span><span class="p">.</span><span class="nx">$mount</span><span class="p">()</span>
  
  <span class="c1">// 找到 &lt;svg class=&#34;v-icon&#34;&gt;&lt;use :xlink:href=&#34;`#i-${name}`&#34;&gt;&lt;/use&gt;&lt;/svg&gt;
</span><span class="c1"></span>  <span class="kr">const</span> <span class="nx">useElement</span> <span class="o">=</span> <span class="nx">button</span><span class="p">.</span><span class="nx">$el</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s1">&#39;use&#39;</span><span class="p">)</span>
  
  <span class="c1">// console.log(userElement)
</span><span class="c1"></span>  <span class="cm">/*
</span><span class="cm">  // Uncaught AssertionError
</span><span class="cm">  // expect(useElement.getAttribute(&#39;xlink:href&#39;)).to.equal(&#39;settings&#39;)
</span><span class="cm">  */</span>
  
  <span class="c1">// 可以通过的测试用例
</span><span class="c1"></span>  <span class="nx">expect</span><span class="p">(</span><span class="nx">useElement</span><span class="p">.</span><span class="nx">getAttribute</span><span class="p">(</span><span class="s1">&#39;xlink:href&#39;</span><span class="p">)).</span><span class="nx">to</span><span class="p">.</span><span class="nx">equal</span><span class="p">(</span><span class="s1">&#39;#i-settings&#39;</span><span class="p">)</span>
  <span class="kr">const</span> <span class="nx">href</span> <span class="o">=</span> <span class="nx">useElement</span><span class="p">.</span><span class="nx">getAttribute</span><span class="p">(</span><span class="s1">&#39;xlink:href&#39;</span><span class="p">)</span>
  <span class="nx">expect</span><span class="p">(</span><span class="nx">href</span><span class="p">).</span><span class="nx">to</span><span class="p">.</span><span class="nx">eq</span><span class="p">(</span><span class="s1">&#39;#i-settings&#39;</span><span class="p">)</span>
<span class="p">}</span>
<span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</code></pre></td></tr></table>
</div>
</div><ul>
<li><a href="https://cn.vuejs.org/v2/api/#Vue-extend">扩展为全局的 VueComponent 函数</a></li>
<li><a href="https://cn.vuejs.org/v2/guide/mixins.html#%E9%80%89%E9%A1%B9%E5%90%88%E5%B9%B6">选项合并</a></li>
<li><a href="https://cn.vuejs.org/v2/api/#propsData">propsData</a> 只用于 new 创建的实例中</li>
</ul>
<blockquote>
<p><code>App.vue</code></p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="c1">// 单元测试
</span><span class="c1"></span><span class="kr">import</span> <span class="nx">chai</span> <span class="nx">from</span> <span class="s1">&#39;chai&#39;</span>
<span class="kr">import</span> <span class="nx">spies</span> <span class="nx">from</span> <span class="s1">&#39;chai-spies&#39;</span>

<span class="nx">chai</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">spies</span><span class="p">)</span>
<span class="kr">const</span> <span class="nx">expect</span> <span class="o">=</span> <span class="nx">chai</span><span class="p">.</span><span class="nx">expect</span>

<span class="c1">// 测试按钮含有 icon
</span><span class="c1"></span>  <span class="p">{</span>
    <span class="kr">const</span> <span class="nx">Constructor</span> <span class="o">=</span> <span class="nx">Vue</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nx">VueButton</span><span class="p">)</span>
    <span class="kr">const</span> <span class="nx">button</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Constructor</span><span class="p">({</span>
      <span class="nx">propsData</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">icon</span><span class="o">:</span> <span class="s1">&#39;settings&#39;</span>
      <span class="p">},</span>
    <span class="p">})</span>
    <span class="c1">// button.$mount(&#39;#test&#39;)
</span><span class="c1"></span>    <span class="nx">button</span><span class="p">.</span><span class="nx">$mount</span><span class="p">()</span>
    <span class="c1">// 获取 use 元素
</span><span class="c1"></span>    <span class="kr">const</span> <span class="nx">useElement</span> <span class="o">=</span> <span class="nx">vm</span><span class="p">.</span><span class="nx">$el</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s1">&#39;use&#39;</span><span class="p">)</span>
    <span class="c1">// console.log(userElement)
</span><span class="c1"></span>    <span class="cm">/*
</span><span class="cm">    // Uncaught AssertionError
</span><span class="cm">    // expect(useElement.getAttribute(&#39;xlink:href&#39;)).to.equal(&#39;settings&#39;)
</span><span class="cm">    */</span>
    <span class="c1">// 可以通过的测试用例
</span><span class="c1"></span>    <span class="nx">expect</span><span class="p">(</span><span class="nx">useElement</span><span class="p">.</span><span class="nx">getAttribute</span><span class="p">(</span><span class="s1">&#39;xlink:href&#39;</span><span class="p">)).</span><span class="nx">to</span><span class="p">.</span><span class="nx">equal</span><span class="p">(</span><span class="s1">&#39;#i-settings&#39;</span><span class="p">)</span>
    <span class="kr">const</span> <span class="nx">href</span> <span class="o">=</span> <span class="nx">useElement</span><span class="p">.</span><span class="nx">getAttribute</span><span class="p">(</span><span class="s1">&#39;xlink:href&#39;</span><span class="p">)</span>
    <span class="nx">expect</span><span class="p">(</span><span class="nx">href</span><span class="p">).</span><span class="nx">to</span><span class="p">.</span><span class="nx">eq</span><span class="p">(</span><span class="s1">&#39;#i-settings&#39;</span><span class="p">)</span>
  <span class="p">}</span>

</code></pre></td></tr></table>
</div>
</div><ul>
<li><a href="https://zhuanlan.zhihu.com/p/38076208">Vue 动态创建实例</a></li>
<li>错误断言<code>expect(useElement.getAttribute('xlink:href')).to.equal('settings')</code>，报错<code>Uncaught AssertionError</code></li>
<li>正确断言<code> expect(useElement.getAttribute('xlink:href')).to.eq('#i-settings')</code>，可以通过的测试用例，满足预期</li>
<li>单元测试 <strong>放一个输入，期待一个输出，查看匹配</strong></li>
</ul>
<hr>
<h3 id="如何决定写几个单元测试">如何决定写几个单元测试</h3>
<ul>
<li><code>VueButton</code>中看<code>props</code>有几个<strong>输入参数</strong>，就写几个测试用例：
<ul>
<li><code>icon</code>、<code>isLoading</code>、<code>iconPosition</code></li>
</ul>
</li>
<li>事件也需要测试用例
<ul>
<li><code>@click</code></li>
</ul>
</li>
</ul>
<blockquote>
<p>需要的用例</p>
</blockquote>
<ul>
<li>测试所有<code>props</code>
<ul>
<li>测试 <code>icon</code></li>
<li>测试 <code>isLoading</code></li>
<li>测试 <code>iconPosition</code>，需要测试的是 CSS属性 <code>order</code>
<ul>
<li>测试 <code>order</code> 默认为 1 左边 ；2 右边</li>
<li>测试 <code>order</code> 为 2 右边</li>
</ul>
</li>
</ul>
</li>
<li>测试 事件 按钮触发 <code>click</code></li>
</ul>
<hr>
<h3 id="测试-isloading-属性">测试 <code>isLoading</code> 属性</h3>
<ul>
<li><strong>先写错一个，看报错；再写对，看报错是否消失</strong></li>
<li>属性<code>class</code>同时给<code>icon</code>和<code>loading</code>，预期得到<code>href</code>属性为<code>#i-loading</code></li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="c1">//...
</span><span class="c1">// 测试 isLoading 属性
</span><span class="c1"></span><span class="p">{</span>
  <span class="kr">const</span> <span class="nx">Constructor</span> <span class="o">=</span> <span class="nx">Vue</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nx">VueButton2</span><span class="p">)</span>
  <span class="kr">const</span> <span class="nx">button</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Constructor</span><span class="p">({</span>
    <span class="nx">propsData</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">icon</span><span class="o">:</span> <span class="s1">&#39;settings&#39;</span><span class="p">,</span>
      <span class="nx">isLoading</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="p">},</span>
  <span class="p">})</span>
  <span class="nx">button</span><span class="p">.</span><span class="nx">$mount</span><span class="p">()</span>
  <span class="kr">const</span> <span class="nx">useElement</span> <span class="o">=</span> <span class="nx">button</span><span class="p">.</span><span class="nx">$el</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s1">&#39;use&#39;</span><span class="p">)</span>
  <span class="kr">const</span> <span class="nx">href</span> <span class="o">=</span> <span class="nx">useElement</span><span class="p">.</span><span class="nx">getAttribute</span><span class="p">(</span><span class="s1">&#39;xlink:href&#39;</span><span class="p">)</span>
  <span class="c1">// Uncaught AssertionError
</span><span class="c1"></span>  <span class="c1">// expect(href).to.eq(&#39;#i-settings&#39;)
</span><span class="c1"></span>  <span class="nx">expect</span><span class="p">(</span><span class="nx">href</span><span class="p">).</span><span class="nx">to</span><span class="p">.</span><span class="nx">eq</span><span class="p">(</span><span class="s1">&#39;#i-loading&#39;</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>注意</p>
</blockquote>
<ul>
<li><code>$el</code>取到<code>VueButton.vue</code>中的<code>&lt;button&gt;...&lt;/button&gt;</code></li>
<li><code>button</code>改成<code>vm</code>，表示实例</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span><span class="lnt">80
</span><span class="lnt">81
</span><span class="lnt">82
</span><span class="lnt">83
</span><span class="lnt">84
</span><span class="lnt">85
</span><span class="lnt">86
</span><span class="lnt">87
</span><span class="lnt">88
</span><span class="lnt">89
</span><span class="lnt">90
</span><span class="lnt">91
</span><span class="lnt">92
</span><span class="lnt">93
</span><span class="lnt">94
</span><span class="lnt">95
</span><span class="lnt">96
</span><span class="lnt">97
</span><span class="lnt">98
</span><span class="lnt">99
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="c1">//...
</span><span class="c1">// 单元测试
</span><span class="c1">// import ...
</span><span class="c1"></span>
<span class="c1">// 测试 icon
</span><span class="c1"></span><span class="p">{</span>
  <span class="kr">const</span> <span class="nx">Constructor</span> <span class="o">=</span> <span class="nx">Vue</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nx">VueButton2</span><span class="p">)</span>
  <span class="kr">const</span> <span class="nx">vm</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Constructor</span><span class="p">({</span>
    <span class="nx">propsData</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">icon</span><span class="o">:</span> <span class="s1">&#39;settings&#39;</span>
    <span class="p">},</span>
  <span class="p">})</span>
  <span class="c1">// button.$mount(&#39;#test&#39;)
</span><span class="c1"></span>  <span class="c1">// 页面空挂载
</span><span class="c1"></span>  <span class="nx">vm</span><span class="p">.</span><span class="nx">$mount</span><span class="p">()</span>
  <span class="kr">const</span> <span class="nx">useElement</span> <span class="o">=</span> <span class="nx">vm</span><span class="p">.</span><span class="nx">$el</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s1">&#39;use&#39;</span><span class="p">)</span>
  <span class="c1">// console.log(userElement)
</span><span class="c1"></span>  <span class="cm">/*
</span><span class="cm">  // Uncaught AssertionError
</span><span class="cm">  // expect(useElement.getAttribute(&#39;xlink:href&#39;)).to.equal(&#39;settings&#39;)
</span><span class="cm">  */</span>
  <span class="c1">// 可以通过的测试用例
</span><span class="c1"></span>  <span class="nx">expect</span><span class="p">(</span><span class="nx">useElement</span><span class="p">.</span><span class="nx">getAttribute</span><span class="p">(</span><span class="s1">&#39;xlink:href&#39;</span><span class="p">)).</span><span class="nx">to</span><span class="p">.</span><span class="nx">equal</span><span class="p">(</span><span class="s1">&#39;#i-settings&#39;</span><span class="p">)</span>
  <span class="kr">const</span> <span class="nx">href</span> <span class="o">=</span> <span class="nx">useElement</span><span class="p">.</span><span class="nx">getAttribute</span><span class="p">(</span><span class="s1">&#39;xlink:href&#39;</span><span class="p">)</span>
  <span class="nx">expect</span><span class="p">(</span><span class="nx">href</span><span class="p">).</span><span class="nx">to</span><span class="p">.</span><span class="nx">eq</span><span class="p">(</span><span class="s1">&#39;#i-settings&#39;</span><span class="p">)</span>
  <span class="nx">vm</span><span class="p">.</span><span class="nx">$el</span><span class="p">.</span><span class="nx">remove</span><span class="p">()</span>
  <span class="nx">vm</span><span class="p">.</span><span class="nx">$destroy</span><span class="p">()</span>
<span class="p">}</span>

<span class="c1">// 测试 isLoading
</span><span class="c1"></span><span class="p">{</span>
  <span class="kr">const</span> <span class="nx">Constructor</span> <span class="o">=</span> <span class="nx">Vue</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nx">VueButton2</span><span class="p">)</span>
  <span class="kr">const</span> <span class="nx">vm</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Constructor</span><span class="p">({</span>
    <span class="nx">propsData</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">icon</span><span class="o">:</span> <span class="s1">&#39;settings&#39;</span><span class="p">,</span>
      <span class="nx">isLoading</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="p">},</span>
  <span class="p">})</span>
  <span class="c1">// 页面空挂载
</span><span class="c1"></span>  <span class="nx">vm</span><span class="p">.</span><span class="nx">$mount</span><span class="p">()</span>
  <span class="kr">const</span> <span class="nx">useElement</span> <span class="o">=</span> <span class="nx">vm</span><span class="p">.</span><span class="nx">$el</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s1">&#39;use&#39;</span><span class="p">)</span>
  <span class="kr">const</span> <span class="nx">href</span> <span class="o">=</span> <span class="nx">useElement</span><span class="p">.</span><span class="nx">getAttribute</span><span class="p">(</span><span class="s1">&#39;xlink:href&#39;</span><span class="p">)</span>
  <span class="c1">// Uncaught AssertionError
</span><span class="c1"></span>  <span class="c1">// expect(href).to.eq(&#39;#i-settings&#39;)
</span><span class="c1"></span>  <span class="nx">expect</span><span class="p">(</span><span class="nx">href</span><span class="p">).</span><span class="nx">to</span><span class="p">.</span><span class="nx">eq</span><span class="p">(</span><span class="s1">&#39;#i-loading&#39;</span><span class="p">)</span>
  <span class="nx">vm</span><span class="p">.</span><span class="nx">$el</span><span class="p">.</span><span class="nx">remove</span><span class="p">()</span>
  <span class="nx">vm</span><span class="p">.</span><span class="nx">$destroy</span><span class="p">()</span>
<span class="p">}</span>

<span class="c1">// 测试 iconPosition order 默认为 1 左边 ；2 右边
</span><span class="c1"></span><span class="p">{</span>
  <span class="kr">const</span> <span class="nx">Constructor</span> <span class="o">=</span> <span class="nx">Vue</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nx">VueButton2</span><span class="p">)</span>
  <span class="kr">const</span> <span class="nx">vm</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Constructor</span><span class="p">({</span>
    <span class="nx">propsData</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">icon</span><span class="o">:</span> <span class="s1">&#39;settings&#39;</span><span class="p">,</span>
    <span class="p">},</span>
  <span class="p">})</span>
  <span class="c1">// button 必须被加载 渲染到页面中，CSS加载，才能识别 order，否则 expect(order).to.eq(&#39;&#39;)为空
</span><span class="c1"></span>  <span class="kr">const</span> <span class="nx">div</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">&#39;div&#39;</span><span class="p">)</span>
  <span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">div</span><span class="p">)</span>
  <span class="c1">// 页面挂载到 div 上
</span><span class="c1"></span>  <span class="nx">vm</span><span class="p">.</span><span class="nx">$mount</span><span class="p">(</span><span class="nx">div</span><span class="p">)</span>
  <span class="kr">const</span> <span class="nx">svg</span> <span class="o">=</span> <span class="nx">vm</span><span class="p">.</span><span class="nx">$el</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s1">&#39;svg&#39;</span><span class="p">)</span>
  <span class="c1">// const order = window.getComputedStyle(svg).order
</span><span class="c1"></span>  <span class="c1">// ES6+ 解构赋值
</span><span class="c1"></span>  <span class="kr">const</span> <span class="p">{</span><span class="nx">order</span><span class="p">}</span> <span class="o">=</span> <span class="nb">window</span><span class="p">.</span><span class="nx">getComputedStyle</span><span class="p">(</span><span class="nx">svg</span><span class="p">)</span>
  <span class="c1">// 错误断言
</span><span class="c1"></span>  <span class="c1">// expect(order).to.eq(1)
</span><span class="c1"></span>  <span class="c1">// 正确断言
</span><span class="c1"></span>  <span class="c1">//CSS 所有属性值都是字符串
</span><span class="c1"></span>  <span class="nx">expect</span><span class="p">(</span><span class="nx">order</span><span class="p">).</span><span class="nx">to</span><span class="p">.</span><span class="nx">eq</span><span class="p">(</span><span class="s2">&#34;1&#34;</span><span class="p">)</span>
  <span class="nx">vm</span><span class="p">.</span><span class="nx">$el</span><span class="p">.</span><span class="nx">remove</span><span class="p">()</span>
  <span class="nx">vm</span><span class="p">.</span><span class="nx">$destroy</span><span class="p">()</span>
<span class="p">}</span>

<span class="c1">// 测试 iconPosition order 为 2 右边
</span><span class="c1"></span><span class="p">{</span>
  <span class="kr">const</span> <span class="nx">Constructor</span> <span class="o">=</span> <span class="nx">Vue</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nx">VueButton2</span><span class="p">)</span>
  <span class="kr">const</span> <span class="nx">vm</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Constructor</span><span class="p">({</span>
    <span class="nx">propsData</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">icon</span><span class="o">:</span> <span class="s1">&#39;settings&#39;</span><span class="p">,</span>
      <span class="nx">iconPosition</span><span class="o">:</span> <span class="s1">&#39;right&#39;</span><span class="p">,</span>
    <span class="p">},</span>
  <span class="p">})</span>
  <span class="kr">const</span> <span class="nx">div</span> <span class="o">=</span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">&#39;div&#39;</span><span class="p">)</span>
  <span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">div</span><span class="p">)</span>
  <span class="c1">// 页面挂载到 div 上
</span><span class="c1"></span>  <span class="nx">vm</span><span class="p">.</span><span class="nx">$mount</span><span class="p">(</span><span class="nx">div</span><span class="p">)</span>
  <span class="kr">const</span> <span class="nx">svg</span> <span class="o">=</span> <span class="nx">vm</span><span class="p">.</span><span class="nx">$el</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s1">&#39;svg&#39;</span><span class="p">)</span>
  <span class="c1">// 获得计算样式
</span><span class="c1"></span>  <span class="kr">const</span> <span class="p">{</span><span class="nx">order</span><span class="p">}</span> <span class="o">=</span> <span class="nb">window</span><span class="p">.</span><span class="nx">getComputedStyle</span><span class="p">(</span><span class="nx">svg</span><span class="p">)</span>
  <span class="c1">// 错误断言
</span><span class="c1"></span>  <span class="c1">// expect(order).to.eq(&#34;1&#34;)
</span><span class="c1"></span>  <span class="c1">// 正确断言
</span><span class="c1"></span>  <span class="nx">expect</span><span class="p">(</span><span class="nx">order</span><span class="p">).</span><span class="nx">to</span><span class="p">.</span><span class="nx">eq</span><span class="p">(</span><span class="s2">&#34;2&#34;</span><span class="p">)</span>
  <span class="nx">vm</span><span class="p">.</span><span class="nx">$el</span><span class="p">.</span><span class="nx">remove</span><span class="p">()</span>
  <span class="nx">vm</span><span class="p">.</span><span class="nx">$destroy</span><span class="p">()</span>
<span class="p">}</span>

</code></pre></td></tr></table>
</div>
</div><hr>
<h3 id="加载-button">加载 button</h3>
<blockquote>
<p>button 必须被加载 渲染到页面的一个节点中，加载 CSS，才能识别 order，</p>
<p>否则页面就不渲染元素，CSS就无法加载到元素上，无法获得计算样式</p>
<p>即<code>expect(order).to.eq('')</code>为空</p>
</blockquote>
<ul>
<li>将<code>button</code>挂载到 <code>div</code> 上
<ul>
<li><code>const div = document.createElement('div')</code></li>
<li><code>document.body.appendChild(div)</code></li>
<li><code>vm.$mount(div)</code></li>
</ul>
</li>
</ul>
<blockquote>
<p>注意 CSS所有样式的值都是字符串</p>
</blockquote>
<ul>
<li><code>expect(order).to.eq(1)</code> 错误</li>
<li><code>expect(order).to.eq(&quot;1&quot;)</code> 正确</li>
</ul>
<blockquote>
<p>清除测试代码中的用例</p>
</blockquote>
<ul>
<li>打扫战场<code>.$el.remove()</code> <code>.$destroy()</code>
<ul>
<li><code>vm.$el.remove()</code></li>
<li><code>vm.$destroy()</code></li>
</ul>
</li>
</ul>
<hr>
<h3 id="使用-chaispies-监听函数mock函数测试事件">使用 <code>chai.spies</code> 监听函数，<code>mock</code>函数，测试事件</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="c1">//...
</span><span class="c1"></span><span class="kr">import</span> <span class="nx">spies</span> <span class="nx">from</span> <span class="s1">&#39;chai-spies&#39;</span>
<span class="nx">chai</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">spies</span><span class="p">)</span>
<span class="c1">//...
</span><span class="c1"></span>
  <span class="c1">// 测试 按钮触发 click // mock 使用 chai.spies 监听函数
</span><span class="c1"></span>  <span class="p">{</span>
    <span class="kr">const</span> <span class="nx">Constructor</span> <span class="o">=</span> <span class="nx">Vue</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nx">VueButton</span><span class="p">);</span>
    <span class="kr">const</span> <span class="nx">vm</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Constructor</span><span class="p">({</span>
      <span class="nx">propsData</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">icon</span><span class="o">:</span> <span class="s1">&#39;settings&#39;</span><span class="p">,</span>
      <span class="p">},</span>
    <span class="p">});</span>
    <span class="nx">vm</span><span class="p">.</span><span class="nx">$mount</span><span class="p">();</span>
    <span class="kr">const</span> <span class="nx">spyFn</span> <span class="o">=</span> <span class="nx">chai</span><span class="p">.</span><span class="nx">spy</span><span class="p">(()</span> <span class="p">=&gt;</span> <span class="p">{</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;spy function OK&#39;</span><span class="p">);</span>
    <span class="p">});</span>

    <span class="nx">vm</span><span class="p">.</span><span class="nx">$on</span><span class="p">(</span><span class="s1">&#39;click&#39;</span><span class="p">,</span> <span class="nx">spyFn</span><span class="p">);</span>
    <span class="kr">const</span> <span class="nx">button</span> <span class="o">=</span> <span class="nx">vm</span><span class="p">.</span><span class="nx">$el</span><span class="p">;</span>
    <span class="p">(</span><span class="nx">button</span> <span class="nx">as</span> <span class="nx">HTMLButtonElement</span><span class="p">).</span><span class="nx">click</span><span class="p">();</span>
    <span class="c1">// 期望 函数被执行
</span><span class="c1"></span>    <span class="nx">expect</span><span class="p">(</span><span class="nx">spyFn</span><span class="p">).</span><span class="nx">to</span><span class="p">.</span><span class="nx">have</span><span class="p">.</span><span class="nx">been</span><span class="p">.</span><span class="nx">called</span><span class="p">();</span>
    <span class="nx">vm</span><span class="p">.</span><span class="nx">$el</span><span class="p">.</span><span class="nx">remove</span><span class="p">();</span>
    <span class="nx">vm</span><span class="p">.</span><span class="nx">$destroy</span><span class="p">();</span>
  <span class="p">}</span>
<span class="c1">//...
</span></code></pre></td></tr></table>
</div>
</div><ul>
<li>对于事件监听来说，不需要 CSS ，无需挂载到节点上</li>
</ul>
<blockquote>
<p>期望这个函数被执行</p>
</blockquote>
<h4 id="错误的做法是">错误的做法是</h4>
<ul>
<li><code>vm.$on('click', ()=&gt; {expect(1).to.eq(1)})</code></li>
<li><code>const button = vm.$el</code></li>
<li><code>button.click()</code></li>
</ul>
<h4 id="正确的做法是">正确的做法是</h4>
<ul>
<li>引入<a href="https://github.com/chaijs/chai-spies"><code>Chai Spies</code></a>来<code>mock</code>函数执行
<ul>
<li><code>import chai from 'chai'</code></li>
<li><code>import spies from 'chai-spies'</code></li>
<li><code>chai.use(spies)</code></li>
</ul>
</li>
<li>声明 监听函数
<ul>
<li><code>const spy = chai.spy(()=&gt; {...})</code></li>
</ul>
</li>
<li><code>const button = vm.$el</code> 点击<code>button.click()</code>后，期望
<ul>
<li><code>expect(spy).to.have.been.called()</code></li>
</ul>
</li>
</ul>
<hr>
<h3 id="单元测试小结">单元测试小结</h3>
<ul>
<li>测试的内容
<ul>
<li>外部属性值 是否符合预期</li>
<li>挂载后 CSS 属性值 是否符合预期</li>
<li>事件使用<code>Chai Spies</code> 函数<code>mock</code>执行 是否被执行</li>
</ul>
</li>
<li>代码块包裹的作用是作用域隔离</li>
<li>在之后的 <code>Karma + Mocha</code> 测试文件中使用函数的作用域进行隔离</li>
<li>测试最重要的就是作用域隔离和断言</li>
<li>通过描述把所有功能用测试用例写一遍</li>
<li>单元测试可以通过代码测试代码是否正确</li>
</ul>
<hr>
<blockquote>
<p>警告：<code>npm link</code> 在 <code>Windows</code> 上会抽风</p>
</blockquote>
<ul>
<li>如果你 <code>npm link</code> 之后项目报错，你就不要再用 <code>npm link</code> 了</li>
<li>只需要每次改完代码后 <code>npm publish</code> ，然后再在另一个地方 <code>npm install xxx@0.0.x</code> 即可。</li>
</ul>
<hr>
<blockquote>
<p>打开浏览器&gt;运行测试用例&gt;刷新页面&gt;关闭浏览器 如何一气呵成</p>
</blockquote>
<h2 id="自动化测试">自动化测试</h2>
<ul>
<li>输入一行命令，打包文件</li>
<li>自动打开 <code>Chrome</code>，输入网址，测试用例</li>
<li>自动点刷新</li>
<li>自动使用 <code>Karma</code> 可以做到一行命令测试代码</li>
<li>自动关闭浏览器，并打印返回浏览器输出的结果</li>
<li>这就是持续集成</li>
</ul>
<h3 id="使用-karma--mocha-做单元测试">使用 <code>Karma + Mocha</code> 做单元测试</h3>
<ul>
<li><code>Karma</code>（[ˈkɑrmə] 卡玛）是一个 <strong>测试运行器</strong>，它可以呼起浏览器，加载测试脚本，然后运行测试用例</li>
<li><code>Mocha</code>（[ˈmoʊkə] 摩卡）是一个 <strong>单元测试框架/库</strong>，它可以用来写测试用例</li>
<li><code>Sinon</code>（西农）是一个 <strong><code>spy / stub / mock</code> 库</strong>，用以辅助测试（使用后才能理解）</li>
</ul>
<h3 id="单元测试步骤">单元测试步骤</h3>
<h4 id="1安装各种工具">1.安装各种工具</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh">npm i -D karma karma-chrome-launcher karma-mocha karma-sinon-chai mocha sinon sinon-chai karma-chai karma-chai-spies
</code></pre></td></tr></table>
</div>
</div><ul>
<li>成功安装</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="c1">#...</span>
+ karma-chai@0.1.0
+ karma-chai-spies@0.1.4
+ karma-sinon-chai@2.0.2
+ karma-mocha@2.0.1
+ karma-chrome-launcher@3.1.0
+ sinon-chai@3.5.0
+ sinon@9.2.1
+ mocha@8.2.1
+ karma@5.2.3
added <span class="m">172</span> packages from <span class="m">962</span> contributors, removed <span class="m">43</span> packages and updated <span class="m">43</span> packages in 189.026s
</code></pre></td></tr></table>
</div>
</div><h4 id="2创建-karma-配置">2.创建 <code>karma</code> 配置</h4>
<blockquote>
<p><code>karma.conf.js</code></p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">config</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">config</span><span class="p">.</span><span class="nx">set</span><span class="p">({</span>

    <span class="c1">// base path that will be used to resolve all patterns (eg. files, exclude)
</span><span class="c1"></span>    <span class="nx">basePath</span><span class="o">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
    <span class="c1">// frameworks to use
</span><span class="c1"></span>    <span class="c1">// available frameworks: https://npmjs.org/browse/keyword/karma-adapter
</span><span class="c1"></span>    <span class="nx">frameworks</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;mocha&#39;</span><span class="p">,</span> <span class="s1">&#39;sinon-chai&#39;</span><span class="p">],</span>
    <span class="nx">client</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">chai</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">includeStack</span><span class="o">:</span> <span class="kc">true</span>
      <span class="p">}</span>
    <span class="p">},</span>

    <span class="c1">// list of files / patterns to load in the browser
</span><span class="c1"></span>    <span class="nx">files</span><span class="o">:</span> <span class="p">[</span>
      <span class="s1">&#39;dist/**/*.test.js&#39;</span><span class="p">,</span>
      <span class="s1">&#39;dist/**/*.test.css&#39;</span>
    <span class="p">],</span>

    <span class="c1">// list of files / patterns to exclude
</span><span class="c1"></span>    <span class="nx">exclude</span><span class="o">:</span> <span class="p">[],</span>

    <span class="c1">// preprocess matching files before serving them to the browser
</span><span class="c1"></span>    <span class="c1">// available preprocessors: https://npmjs.org/browse/keyword/karma-preprocessor
</span><span class="c1"></span>    <span class="nx">preprocessors</span><span class="o">:</span> <span class="p">{},</span>

    <span class="c1">// test results reporter to use
</span><span class="c1"></span>    <span class="c1">// possible values: &#39;dots&#39;, &#39;progress&#39;
</span><span class="c1"></span>    <span class="c1">// available reporters: https://npmjs.org/browse/keyword/karma-reporter
</span><span class="c1"></span>    <span class="nx">reporters</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;progress&#39;</span><span class="p">],</span>

    <span class="c1">// web server port
</span><span class="c1"></span>    <span class="nx">port</span><span class="o">:</span> <span class="mi">9876</span><span class="p">,</span>

    <span class="c1">// enable / disable colors in the output (reporters and logs)
</span><span class="c1"></span>    <span class="nx">colors</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>

    <span class="c1">// level of logging
</span><span class="c1"></span>    <span class="c1">// possible values: config.LOG_DISABLE || config.LOG_ERROR || config.LOG_WARN || config.LOG_INFO || config.LOG_DEBUG
</span><span class="c1"></span>    <span class="nx">logLevel</span><span class="o">:</span> <span class="nx">config</span><span class="p">.</span><span class="nx">LOG_INFO</span><span class="p">,</span>

    <span class="c1">// enable / disable watching file and executing tests whenever any file changes
</span><span class="c1"></span>    <span class="nx">autoWatch</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>

    <span class="c1">// start these browsers
</span><span class="c1"></span>    <span class="c1">// available browser launchers: https://npmjs.org/browse/keyword/karma-launcher
</span><span class="c1"></span>    <span class="nx">browsers</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;Chrome&#39;</span><span class="p">],</span>

    <span class="c1">// Continuous Integration mode
</span><span class="c1"></span>    <span class="c1">// if true, Karma captures browsers, runs the tests and exits
</span><span class="c1"></span>    <span class="nx">singleRun</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>

    <span class="c1">// If browser does not capture in given timeout [ms], kill it
</span><span class="c1"></span>    <span class="nx">captureTimeout</span><span class="o">:</span> <span class="mi">60000</span><span class="p">,</span>
    <span class="c1">// Concurrency level
</span><span class="c1"></span>    <span class="c1">// how many browser should be started simultaneous
</span><span class="c1"></span>    <span class="nx">concurrency</span><span class="o">:</span> <span class="kc">Infinity</span>
  <span class="p">})</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>其中</p>
</blockquote>
<ul>
<li><code>files: ['dist/**/*.test.js', 'dist/**/*.test.css'],</code> 配置测试用例的路径
<ul>
<li><code>**</code> 表示任意层级的路径，比如<code>test/a/b/c/d/...</code></li>
<li><code>'dist/**/*.test.css'</code> 如果不配置，就不会加载默认的 CSS（<code>parcel</code>打包会拆分中的 CSS）</li>
</ul>
</li>
<li><code>browsers: ['Chrome'],</code>表示 期望打开的浏览器，不同浏览器需要设置插件，默认为<code>Chrome</code></li>
</ul>
<h4 id="3创建-testbuttontestjs-文件">3.创建 <code>test/button.test.js</code> 文件</h4>
<ul>
<li>注意文件路径是否正确</li>
<li>按照项目的实际路径导入 <code>import Button from '../src/components/vuebutton/VueButton.vue'</code></li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="kr">const</span> <span class="nx">expect</span> <span class="o">=</span> <span class="nx">chai</span><span class="p">.</span><span class="nx">expect</span><span class="p">;</span>
 <span class="kr">import</span> <span class="nx">Vue</span> <span class="nx">from</span> <span class="s1">&#39;vue&#39;</span>
 <span class="kr">import</span> <span class="nx">Button</span> <span class="nx">from</span> <span class="s1">&#39;../src/button&#39;</span> <span class="c1">// import Button from &#39;../src/components/vuebutton/VueButton.vue&#39;
</span><span class="c1"></span>
 <span class="nx">Vue</span><span class="p">.</span><span class="nx">config</span><span class="p">.</span><span class="nx">productionTip</span> <span class="o">=</span> <span class="kc">false</span>
 <span class="nx">Vue</span><span class="p">.</span><span class="nx">config</span><span class="p">.</span><span class="nx">devtools</span> <span class="o">=</span> <span class="kc">false</span>

 <span class="nx">describe</span><span class="p">(</span><span class="s1">&#39;VueButton组件&#39;</span><span class="p">,</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
     <span class="nx">it</span><span class="p">(</span><span class="s1">&#39;存在.&#39;</span><span class="p">,</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
         <span class="nx">expect</span><span class="p">(</span><span class="nx">Button</span><span class="p">).</span><span class="nx">to</span><span class="p">.</span><span class="nx">be</span><span class="p">.</span><span class="nx">ok</span>
     <span class="p">})</span>
     <span class="nx">it</span><span class="p">(</span><span class="s1">&#39;可以设置icon.&#39;</span><span class="p">,</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
         <span class="kr">const</span> <span class="nx">Constructor</span> <span class="o">=</span> <span class="nx">Vue</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nx">Button</span><span class="p">)</span>
         <span class="kr">const</span> <span class="nx">vm</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Constructor</span><span class="p">({</span>
         <span class="nx">propsData</span><span class="o">:</span> <span class="p">{</span>
             <span class="nx">icon</span><span class="o">:</span> <span class="s1">&#39;settings&#39;</span>
         <span class="p">}</span>
         <span class="p">}).</span><span class="nx">$mount</span><span class="p">()</span>
         <span class="kr">const</span> <span class="nx">useElement</span> <span class="o">=</span> <span class="nx">vm</span><span class="p">.</span><span class="nx">$el</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s1">&#39;use&#39;</span><span class="p">)</span>
         <span class="nx">expect</span><span class="p">(</span><span class="nx">useElement</span><span class="p">.</span><span class="nx">getAttribute</span><span class="p">(</span><span class="s1">&#39;xlink:href&#39;</span><span class="p">)).</span><span class="nx">to</span><span class="p">.</span><span class="nx">equal</span><span class="p">(</span><span class="s1">&#39;#i-settings&#39;</span><span class="p">)</span>
         <span class="nx">vm</span><span class="p">.</span><span class="nx">$destroy</span><span class="p">()</span>
     <span class="p">})</span>
     <span class="nx">it</span><span class="p">(</span><span class="s1">&#39;可以设置loading.&#39;</span><span class="p">,</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
         <span class="kr">const</span> <span class="nx">Constructor</span> <span class="o">=</span> <span class="nx">Vue</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nx">Button</span><span class="p">)</span>
         <span class="kr">const</span> <span class="nx">vm</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Constructor</span><span class="p">({</span>
         <span class="nx">propsData</span><span class="o">:</span> <span class="p">{</span>
             <span class="nx">icon</span><span class="o">:</span> <span class="s1">&#39;settings&#39;</span><span class="p">,</span> <span class="c1">// &#39;loading&#39;
</span><span class="c1"></span>             <span class="nx">loading</span><span class="o">:</span> <span class="kc">true</span>
         <span class="p">}</span>
         <span class="p">}).</span><span class="nx">$mount</span><span class="p">()</span>
         <span class="kr">const</span> <span class="nx">useElements</span> <span class="o">=</span> <span class="nx">vm</span><span class="p">.</span><span class="nx">$el</span><span class="p">.</span><span class="nx">querySelectorAll</span><span class="p">(</span><span class="s1">&#39;use&#39;</span><span class="p">)</span>
         <span class="nx">expect</span><span class="p">(</span><span class="nx">useElements</span><span class="p">.</span><span class="nx">length</span><span class="p">).</span><span class="nx">to</span><span class="p">.</span><span class="nx">equal</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
         <span class="nx">expect</span><span class="p">(</span><span class="nx">useElements</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">getAttribute</span><span class="p">(</span><span class="s1">&#39;xlink:href&#39;</span><span class="p">)).</span><span class="nx">to</span><span class="p">.</span><span class="nx">equal</span><span class="p">(</span><span class="s1">&#39;#i-loading&#39;</span><span class="p">)</span>
         <span class="nx">vm</span><span class="p">.</span><span class="nx">$destroy</span><span class="p">()</span>
     <span class="p">})</span>
     <span class="nx">it</span><span class="p">(</span><span class="s1">&#39;icon 默认的 order 是 1&#39;</span><span class="p">,</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
         <span class="kr">const</span> <span class="nx">div</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">&#39;div&#39;</span><span class="p">)</span>
         <span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">div</span><span class="p">)</span>
         <span class="kr">const</span> <span class="nx">Constructor</span> <span class="o">=</span> <span class="nx">Vue</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nx">Button</span><span class="p">)</span>
         <span class="kr">const</span> <span class="nx">vm</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Constructor</span><span class="p">({</span>
         <span class="nx">propsData</span><span class="o">:</span> <span class="p">{</span>
             <span class="nx">icon</span><span class="o">:</span> <span class="s1">&#39;settings&#39;</span><span class="p">,</span>
         <span class="p">}</span>
         <span class="p">}).</span><span class="nx">$mount</span><span class="p">(</span><span class="nx">div</span><span class="p">)</span>
         <span class="kr">const</span> <span class="nx">icon</span> <span class="o">=</span> <span class="nx">vm</span><span class="p">.</span><span class="nx">$el</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s1">&#39;svg&#39;</span><span class="p">)</span>
         <span class="nx">expect</span><span class="p">(</span><span class="nx">getComputedStyle</span><span class="p">(</span><span class="nx">icon</span><span class="p">).</span><span class="nx">order</span><span class="p">).</span><span class="nx">to</span><span class="p">.</span><span class="nx">eq</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">)</span>
         <span class="nx">vm</span><span class="p">.</span><span class="nx">$el</span><span class="p">.</span><span class="nx">remove</span><span class="p">()</span>
         <span class="nx">vm</span><span class="p">.</span><span class="nx">$destroy</span><span class="p">()</span>
     <span class="p">})</span>
     <span class="nx">it</span><span class="p">(</span><span class="s1">&#39;设置 iconPosition 可以改变 order&#39;</span><span class="p">,</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
         <span class="kr">const</span> <span class="nx">div</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">&#39;div&#39;</span><span class="p">)</span>
         <span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">div</span><span class="p">)</span>
         <span class="kr">const</span> <span class="nx">Constructor</span> <span class="o">=</span> <span class="nx">Vue</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nx">Button</span><span class="p">)</span>
         <span class="kr">const</span> <span class="nx">vm</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Constructor</span><span class="p">({</span>
         <span class="nx">propsData</span><span class="o">:</span> <span class="p">{</span>
             <span class="nx">icon</span><span class="o">:</span> <span class="s1">&#39;settings&#39;</span><span class="p">,</span>
             <span class="nx">iconPosition</span><span class="o">:</span> <span class="s1">&#39;right&#39;</span>
         <span class="p">}</span>
         <span class="p">}).</span><span class="nx">$mount</span><span class="p">(</span><span class="nx">div</span><span class="p">)</span>
         <span class="kr">const</span> <span class="nx">icon</span> <span class="o">=</span> <span class="nx">vm</span><span class="p">.</span><span class="nx">$el</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s1">&#39;svg&#39;</span><span class="p">)</span>
         <span class="nx">expect</span><span class="p">(</span><span class="nx">getComputedStyle</span><span class="p">(</span><span class="nx">icon</span><span class="p">).</span><span class="nx">order</span><span class="p">).</span><span class="nx">to</span><span class="p">.</span><span class="nx">eq</span><span class="p">(</span><span class="s1">&#39;2&#39;</span><span class="p">)</span>
         <span class="nx">vm</span><span class="p">.</span><span class="nx">$el</span><span class="p">.</span><span class="nx">remove</span><span class="p">()</span>
         <span class="nx">vm</span><span class="p">.</span><span class="nx">$destroy</span><span class="p">()</span>
     <span class="p">})</span>
     <span class="nx">it</span><span class="p">(</span><span class="s1">&#39;点击 button 触发 click 事件&#39;</span><span class="p">,</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
         <span class="kr">const</span> <span class="nx">Constructor</span> <span class="o">=</span> <span class="nx">Vue</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nx">Button</span><span class="p">)</span>
         <span class="kr">const</span> <span class="nx">vm</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Constructor</span><span class="p">({</span>
         <span class="nx">propsData</span><span class="o">:</span> <span class="p">{</span>
             <span class="nx">icon</span><span class="o">:</span> <span class="s1">&#39;settings&#39;</span><span class="p">,</span>
         <span class="p">}</span>
         <span class="p">}).</span><span class="nx">$mount</span><span class="p">()</span>

         <span class="kr">const</span> <span class="nx">callback</span> <span class="o">=</span> <span class="nx">sinon</span><span class="p">.</span><span class="nx">fake</span><span class="p">();</span>
         <span class="nx">vm</span><span class="p">.</span><span class="nx">$on</span><span class="p">(</span><span class="s1">&#39;click&#39;</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span>
         <span class="nx">vm</span><span class="p">.</span><span class="nx">$el</span><span class="p">.</span><span class="nx">click</span><span class="p">()</span>
         <span class="nx">expect</span><span class="p">(</span><span class="nx">callback</span><span class="p">).</span><span class="nx">to</span><span class="p">.</span><span class="nx">have</span><span class="p">.</span><span class="nx">been</span><span class="p">.</span><span class="nx">called</span>

     <span class="p">})</span>
 <span class="p">})</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="如何写测试用例">如何写测试用例</h4>
<ul>
<li>回顾之前使用代码块隔离，写的六个测试用例
<ul>
<li>使用代码块<code>{}</code>来进行作用域隔离，防止同名变量冲突</li>
<li>需要断言 <code>expect(...)</code></li>
<li>只能通过注释来命名提示以区分</li>
</ul>
</li>
</ul>
<h5 id="对比mocha的测试用例">对比<code>mocha</code>的测试用例</h5>
<ul>
<li><code>describe</code>和<code>it</code>属于<code>Mocha.js</code>的语法</li>
<li>具体的断言<code>expect(...)</code>属于<code>Chai.js</code></li>
<li>每一个<code>it</code>就是一个新的测试用例
<ul>
<li>不同<code>it</code>之间通过 <strong>函数作用域</strong> 进行 <strong>作用域隔离</strong>
<ul>
<li><code>it</code>第一个参数是描述该用例的文字，比用代码块隔离更清晰</li>
<li><code>it</code>第二个参数是执行测试用例的回调函数</li>
</ul>
</li>
</ul>
</li>
</ul>
<h5 id="如何描述行为">如何描述行为</h5>
<ul>
<li>使用<code>describe(&quot;被描述的对象&quot;, ()=&gt; {it(...)})</code>
<ul>
<li>描述对象的一系列行为</li>
<li><code>it</code>描述可以做什么（第一个参数），并怎样实现描述的行为（第二个参数为执行回调函数）</li>
</ul>
</li>
</ul>
<blockquote>
<p>通常被称为<code>BDD</code> <strong>行为驱动测试</strong>，进行行为描述，期待预期结果</p>
</blockquote>
<ul>
<li><code>expect(Button)to.be.ok</code> 描述 Button不是 falsy 值 (null '' undefined 0 &hellip;)，即存在</li>
<li>写法<code>expect(xxx instanceof Array).to.eq(true)</code>
<ul>
<li><code>expect</code>写表达式</li>
<li><code>.eq()</code> 写期待值</li>
</ul>
</li>
</ul>
<blockquote>
<p>无实际意义的属性<code>to</code> <code>be</code>虚词 和 具有实际意义的词<code>not</code> <code>deep</code> <code>eq</code></p>
</blockquote>
<ul>
<li><code>.not</code>用法：<code>expect(Button).to.be.not.ok</code></li>
<li><code>.deep</code>用法：
<ul>
<li><code>expect([1, 2]).to.eq([1, 2])</code> 得到期待值<code>false</code> 浅相等 比较引用地址</li>
<li><code>expect([1, 2]).to.deep.eq([1, 2])</code> 得到期待值<code>true</code>  深相等 比较每一个元素</li>
</ul>
</li>
<li><code>expect(NaN).to.be.NaN</code>得到期待值 <code>true</code></li>
</ul>
<h5 id="使用sinonfake作为spy函数vmelclick触发点击事件后期待回调函数callback被调用">使用<code>sinon.fake()</code>作为<code>spy</code>函数；<code>vm.$el.click()</code>触发点击事件后期待回调函数<code>callback</code>被调用</h5>
<ul>
<li><code>const callback = sinon.fake()</code> 设置回调函数
<ul>
<li>不能使用自定义的函数<code>const fn = function() {...}</code></li>
<li>从技术层面上说，无法单单从<code>fn</code>本身知道函数是否被调用</li>
<li>需要某些标志记录，使用<code>sinon</code>提供的假函数<code>fake()</code></li>
</ul>
</li>
<li><code>vm.$on('click', callback)</code> 绑定监听事件</li>
<li><code>vm.$el.click()</code> 触发事件</li>
<li><code>expect(callback).to.have.been.called</code> 期待回调函数执行</li>
</ul>
<blockquote>
<p><code>AsserationError</code></p>
</blockquote>
<ul>
<li>断言错误</li>
<li>测试不符合预期，则报错</li>
</ul>
<blockquote>
<p>参考</p>
</blockquote>
<ul>
<li><code>Chai.js BDD API</code> <a href="https://www.chaijs.com/api/bdd">官网 https://www.chaijs.com/api/bdd</a></li>
</ul>
<h4 id="4创建测试脚本">4.创建测试脚本</h4>
<blockquote>
<p>在 <code>package.json</code> 里面找到 <code>&quot;scripts&quot;</code> 增加代码</p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="s2">&#34;scripts&#34;</span><span class="err">:</span> <span class="p">{</span>
     <span class="nt">&#34;dev-test&#34;</span><span class="p">:</span> <span class="s2">&#34;parcel watch test/* --no-cache &amp; karma start&#34;</span><span class="p">,</span>
     <span class="nt">&#34;test&#34;</span><span class="p">:</span> <span class="s2">&#34;parcel build test/* --no-minify &amp;&amp; karma start --single-run&#34;</span>
 <span class="p">}</span><span class="err">,</span>

</code></pre></td></tr></table>
</div>
</div><ul>
<li>如果是<code>mac</code>用户，以上脚本配置是OK的</li>
<li><code>Windows</code> 用户运行 <code>npm run dev-test</code> 时会出现 BUG</li>
</ul>
<blockquote>
<p>解决办法</p>
</blockquote>
<ul>
<li>启动两个终端 分开执行命令<code>parcel watch test/* --no-cache</code>和<code>karma start</code></li>
<li>提示找不到命令，加上<code>npx parcel watch test/* --no-cache</code>和<code>npx karma start</code></li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="s2">&#34;scripts&#34;</span><span class="err">:</span> <span class="p">{</span>
     <span class="nt">&#34;dev-watch&#34;</span><span class="p">:</span> <span class="s2">&#34;parcel watch test/* --no-cache&#34;</span><span class="p">,</span>
     <span class="nt">&#34;dev-test&#34;</span><span class="p">:</span> <span class="s2">&#34;karma start --auto-watch&#34;</span><span class="p">,</span>
     <span class="nt">&#34;test&#34;</span><span class="p">:</span> <span class="s2">&#34;parcel build test/* --no-cache --no-minify &amp;&amp; karma start --single-run&#34;</span>
 <span class="p">}</span><span class="err">,</span>

</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>不要缓存 <code>&quot;test&quot;: &quot;rm -rf .cache dist &amp;&amp; parcel build test/* --no-cache --no-minify &amp;&amp; karma start --single-run&quot;,</code></p>
</blockquote>
<ul>
<li><code>parcel build test/* --no-cache --no-minify</code>打包<code>button.test.js</code>成为<code>dist/button.test.js</code>，将所有引用作为源代码拷入</li>
<li><code>karma start --single-run</code>按照<code>karma.conf.js</code>里的配置运行 karma</li>
</ul>
<blockquote>
<p>以下代码告诉 <code>karma</code> 测试用例的路径 <code>karma.conf.js</code></p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="c1">// ...
</span><span class="c1">// list of files / patterns to load in the browser
</span><span class="c1"></span><span class="nx">files</span><span class="o">:</span> <span class="p">[</span>
  <span class="s1">&#39;dist/**/*.test.js&#39;</span><span class="p">,</span> <span class="c1">// /**/* 表示穷尽查找路径所有文件
</span><span class="c1"></span>  <span class="s1">&#39;dist/**/*.test.css&#39;</span>
<span class="p">],</span>
<span class="c1">// ...
</span></code></pre></td></tr></table>
</div>
</div><ul>
<li>加载<code>.test.css</code>是为了加载默认 CSS，实际上加载的时打包后的<code>dist/button.test.css</code>，即原来<code>VueButton.vue</code>里的 CSS</li>
</ul>
<h4 id="5运行测试脚本">5.运行测试脚本</h4>
<h5 id="使用-npm-run-test-一次性运行">使用 <code>npm run test</code> 一次性运行</h5>
<blockquote>
<p>回顾<code>npm run test</code>做了些什么</p>
</blockquote>
<ul>
<li>运行<code>package.json</code>中的<code>&quot;scripts&quot;</code>对应的命令</li>
<li><code>parcel build test/* --no-cache --no-minify</code> 打包<code>test</code>目录下的所有文件
<ul>
<li><code>test/*</code>： 所有文件夹中的一级文件</li>
<li><code>--no-cache</code>： 无缓存</li>
<li><code>--no-minify</code>： 不要压缩代码</li>
</ul>
</li>
<li><code>karma start --single-run</code> 启动<code>Karma</code>，只运行一次</li>
</ul>
<h5 id="使用-npm-run-dev-test-进行-watch-监视运行">使用 <strong><code>npm run dev-test</code></strong> 进行 <strong><code>watch</code> 监视运行</strong></h5>
<ul>
<li>使一改代码就运行一遍测试</li>
<li>打包监视途中不要关闭测试浏览器窗口</li>
<li>不用手动多次输入测试命令</li>
</ul>
<blockquote>
<p>回顾<code>npm dev-test</code>做了些什么</p>
</blockquote>
<ul>
<li>运行<code>package.json</code>中的<code>&quot;scripts&quot;</code>对应的命令</li>
<li><code>parcel watch test/* --no-cache</code> 打包<code>test</code>目录下的所有文件
<ul>
<li><code>test/*</code>： 所有文件夹中的一级文件</li>
<li><code>--no-cache</code>： 无缓存</li>
</ul>
</li>
<li><code> &amp; karma start</code> 启动<code>Karma</code>，一直运行</li>
</ul>
<h5 id="npm-dev-test监视运行的时间差"><code>npm dev-test</code>监视运行的时间差</h5>
<ul>
<li>在第一次打包<code>parcel watch test/* --no-cache</code>时，<code>karma</code>已经启动了</li>
<li><code>karma</code>启动后马上就会先测试一次</li>
<li>等第一次打包完，<code>karma</code>发现文件变更了，再次运行一次测试</li>
<li>所以在终端可以看到两次测试结果</li>
</ul>
<blockquote>
<p><code>parcel</code>监视代码变更，重新打包代码，<code>karma</code>监视编译后的测试文件变更，重新测试</p>
</blockquote>
<h4 id="6-成果">6. 成果</h4>
<ul>
<li>开发的时候新开一个命令行窗口运行 <code>npm run dev-test</code> 就可以实时查看测试结果</li>
<li>只想看一次结果，就只用运行 <code>npm run test</code></li>
<li>在终端显示测试结果</li>
</ul>
<hr>
<blockquote>
<p>怎么每次代码改变自动运行 <code>npm run test</code></p>
</blockquote>
<ul>
<li><code>dev-test</code> 自动测试并监视变化，自动重新运行测试，不停止</li>
</ul>
<blockquote>
<p>总结<code>Karma</code>做了什么</p>
</blockquote>
<ul>
<li>打包 <code>JS</code></li>
<li>打开浏览器</li>
<li>启动服务器，输入<code>url</code>地址</li>
<li>运行测试用例</li>
<li>关闭浏览器</li>
<li>显示浏览器输出信息</li>
</ul>
<hr>
<blockquote>
<p>不用自己运行命令，还能实现自动跑测试</p>
</blockquote>
<ul>
<li>使用第三方的持续集成服务 <code>Tracis CI</code> 或者 <code>Circle CI</code> 或者 <code>GitHub Actions</code></li>
<li>可以查看完整的测试经过和结果报告</li>
<li><a href="http://ruanyifeng.com/blog/2017/12/travis_ci_tutorial.html">持续集成服务 Travis CI 教程 - 阮一峰的网络日志</a></li>
</ul>
<h3 id="在测试用例中使用-typescript">在测试用例中使用 <code>TypeScript</code></h3>
<ul>
<li>所有的<code>TypeScript</code>模块都有其对应的<code>*.d.ts</code>文件，用来告诉我们这个模块是做什么的，提供了什么可以使用</li>
<li>在测试用例编写时，可以通过IDE动态提示来快速的书写断言，而不需要结合着文档去进行“翻译”</li>
</ul>
<blockquote>
<p>使用方式</p>
</blockquote>
<ul>
<li>写过<code>mocha</code>和<code>chai</code>的童鞋，基本上修改文件后缀+安装对应的@types即可</li>
</ul>
<blockquote>
<p>安装依赖</p>
</blockquote>
<ul>
<li><code>TypeScript</code>相关的安装，<code>yarn add -D typescript ts-node</code></li>
<li><code>Mocha、chai</code>相关的安装，<code>yarn add -D mocha chai @types/mocha @types/chai</code></li>
<li><code>sinon、sinon-chai</code>相关的安装，<code>yarn add -D @types/sinon @types/sinon-chai</code></li>
<li>如果需要涉及到一些API的请求，可以额外安装<code>chai-http</code>，<code>yarn add -D chai-http @types/chai-http</code></li>
<li>安装完后，IDE使用清除缓存重启</li>
</ul>
<hr>
<h2 id="持续集成">持续集成</h2>
<blockquote>
<p>为了保证代码的质量和软件的稳定，需要做持续集成</p>
</blockquote>
<h3 id="持续集成的内容">持续集成的内容</h3>
<ul>
<li>持续测试</li>
<li>持续交付</li>
<li>持续部署</li>
</ul>
<hr>
<blockquote>
<p>可以跳过改用免费版<code>GitHub Actions</code>，代替<code>Travis CI</code></p>
</blockquote>
<h3 id="使用travis-ci做持续集成">使用<code>Travis CI</code>做持续集成</h3>
<h4 id="创建travis-ci配置文件">创建<code>Travis CI</code>配置文件</h4>
<blockquote>
<p>项目根目录下创建<code>.travis.yml</code></p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-yml" data-lang="yml"><span class="nt">language</span><span class="p">:</span><span class="w"> </span><span class="l">node_js</span><span class="w">
</span><span class="w"></span><span class="nt">node_js</span><span class="p">:</span><span class="w">
</span><span class="w">  </span>-<span class="s2">&#34;14&#34;</span><span class="w">
</span><span class="w">  </span>-<span class="s2">&#34;12&#34;</span><span class="w">
</span><span class="w">  </span>-<span class="s2">&#34;16&#34;</span><span class="w">
</span><span class="w">  </span><span class="nt">addons</span><span class="p">:</span><span class="w">
</span><span class="w">    </span><span class="nt">chrome</span><span class="p">:</span><span class="w"> </span><span class="l">stable</span><span class="w">
</span><span class="w"></span><span class="nt">sudo</span><span class="p">:</span><span class="w"> </span><span class="l">required</span><span class="w">
</span><span class="w"></span><span class="nt">before_script</span><span class="p">:</span><span class="w">
</span><span class="w">  </span>- <span class="s2">&#34;sudo chown root /opt/google/chrome/chrome-sandbox&#34;</span><span class="w">
</span><span class="w">  </span>- <span class="s2">&#34;sudo chmod 4755 /opt/google/chrome/chrome-sandbox&#34;</span><span class="w">
</span><span class="w">
</span></code></pre></td></tr></table>
</div>
</div><ul>
<li>注意，<code>karma.conf.js</code>中浏览器的配置需要改为无界面浏览器，例如<code>&quot;ChromeHeadless&quot;</code></li>
</ul>
<h4 id="注册travis-ci网站账号">注册<code>Travis CI</code>网站账号</h4>
<blockquote>
<p>使用 github 绑定账号</p>
</blockquote>
<ul>
<li>保证能同步 github 仓库</li>
<li>验证账户</li>
</ul>
<blockquote>
<p>选择代码仓库</p>
</blockquote>
<ul>
<li>点击<code>My Repositories</code>旁 的加号</li>
<li>搜索仓库</li>
<li>将仓库toggle按钮拨亮</li>
<li><code>travis</code>接入完成</li>
</ul>
<blockquote>
<p>只要一<code>push</code>代码，就会自动触发持续测试</p>
</blockquote>
<hr>
<blockquote>
<p><code>Travis CI</code>迁移至<code>GitHub Actions</code></p>
</blockquote>
<h2 id="使用github-actions代替travis-ci">使用<code>GitHub Actions</code>代替<code>Travis CI</code></h2>
<h3 id="github-actions配置文件文件名任意"><code>GitHub Actions</code>配置文件（文件名任意）</h3>
<blockquote>
<p>在 GitHub 上的项目根目录下创建路径 文件<code>/.github/workflows/unit-test-actions.yml</code> （文件名任意，文件类型为<code>.yml</code>）</p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-yml" data-lang="yml"><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">CI</span><span class="w">
</span><span class="w">
</span><span class="w"></span><span class="c"># Controls when the workflow will run</span><span class="w">
</span><span class="w"></span><span class="nt">on</span><span class="p">:</span><span class="w">
</span><span class="w">  </span><span class="c"># Triggers the workflow on push or pull request events but only for the main branch</span><span class="w">
</span><span class="w">  </span><span class="nt">push</span><span class="p">:</span><span class="w">
</span><span class="w">    </span><span class="nt">branches</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="l">main ]</span><span class="w">
</span><span class="w">  </span><span class="nt">pull_request</span><span class="p">:</span><span class="w">
</span><span class="w">    </span><span class="nt">branches</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="l">main ]</span><span class="w">
</span><span class="w">
</span><span class="w">  </span><span class="c"># Allows you to run this workflow manually from the Actions tab</span><span class="w">
</span><span class="w">  </span><span class="nt">workflow_dispatch</span><span class="p">:</span><span class="w">
</span><span class="w">
</span><span class="w"></span><span class="c"># A workflow run is made up of one or more jobs that can run sequentially or in parallel</span><span class="w">
</span><span class="w"></span><span class="nt">jobs</span><span class="p">:</span><span class="w">
</span><span class="w">  </span><span class="c"># This workflow contains a single job called &#34;build&#34;</span><span class="w">
</span><span class="w">  </span><span class="nt">build</span><span class="p">:</span><span class="w">
</span><span class="w">    </span><span class="c"># The type of runner that the job will run on</span><span class="w">
</span><span class="w">    </span><span class="nt">runs-on</span><span class="p">:</span><span class="w"> </span><span class="l">ubuntu-latest</span><span class="w">
</span><span class="w">    </span><span class="nt">strategy</span><span class="p">:</span><span class="w">
</span><span class="w">      </span><span class="nt">matrix</span><span class="p">:</span><span class="w">
</span><span class="w">        </span><span class="nt">node-version</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="m">12.</span><span class="l">x, 14.x, 16.x]</span><span class="w">
</span><span class="w">    </span><span class="c"># Steps represent a sequence of tasks that will be executed as part of the job</span><span class="w">
</span><span class="w">    </span><span class="nt">steps</span><span class="p">:</span><span class="w">
</span><span class="w">      </span><span class="c"># Checks-out your repository under $GITHUB_WORKSPACE, so your job can access it</span><span class="w">
</span><span class="w">      </span>- <span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l">actions/checkout@v2</span><span class="w">
</span><span class="w">      </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">Use Node.js ${{ matrix.node-version }}</span><span class="w">
</span><span class="w">        </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l">actions/setup-node@v1</span><span class="w">
</span><span class="w">        </span><span class="nt">with</span><span class="p">:</span><span class="w">
</span><span class="w">          </span><span class="nt">node-version</span><span class="p">:</span><span class="w"> </span><span class="l">${{ matrix.node-version }}</span><span class="w">
</span><span class="w">      </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">Install dependencies</span><span class="w">
</span><span class="w">        </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="l">yarn</span><span class="w">
</span><span class="w">      </span>- <span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l">browser-actions/setup-chrome@latest</span><span class="w">
</span><span class="w">      </span>- <span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="l">chrome --version</span><span class="w">
</span><span class="w">      </span>- <span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="l">yarn build</span><span class="w">
</span><span class="w">      </span>- <span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="l">yarn test</span><span class="w">
</span><span class="w">
</span></code></pre></td></tr></table>
</div>
</div><ul>
<li>名字 <code>name: CI</code></li>
<li>分支 <code>on:</code>
<ul>
<li><code>push:</code>
<ul>
<li><code>branches: [ main ]</code></li>
</ul>
</li>
<li><code>pull_request:</code>
<ul>
<li><code>branches: [ main ]</code></li>
</ul>
</li>
</ul>
</li>
<li>任务s: <code>jobs:</code>
<ul>
<li>任务名1 <code>build:</code>
<ul>
<li>运行环境 <code>runs-on: ubuntu-latest</code></li>
<li>策略 <code>strategy:</code>
<ul>
<li>矩阵 <code>matrix:</code>
<ul>
<li><code>node-version: [12.x, 14.x, 16.x]</code></li>
</ul>
</li>
</ul>
</li>
<li>步骤s <code>steps:</code>
<ul>
<li>检查仓库分支 <code>- uses: actions/checkout@v2</code></li>
<li>语言名 <code>- name: Use Node.js ${{ matrix.node-version }}</code>
<ul>
<li>语言 <code>uses: actions/setup-node@v1</code>
<ul>
<li>使用 <code>with:</code>
<ul>
<li>版本 <code>node-version: ${{ matrix.node-version }}</code></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>安装依赖 <code>- name: Install dependencies</code>
<ul>
<li>运行 <code>run: yarn</code></li>
</ul>
</li>
<li>使用浏览器 <code>- uses: browser-actions/setup-chrome@latest</code></li>
<li>运行 <code>- run: chrome --version</code></li>
<li>构建 <code>- run: yarn build</code></li>
<li>测试 <code>- run: yarn test</code></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<hr>
<h3 id="邮件通知">邮件通知</h3>
<ul>
<li><code>GitHub Actions</code>默认只在测试失败时发邮件</li>
</ul>
<blockquote>
<p>手动开启运行成功的通知邮件 设置步骤</p>
</blockquote>
<ul>
<li>在 GitHub 任意页面点击右上角自己的头像</li>
<li>单击Settings（设置）</li>
<li>在用户设置侧边栏中，点击Notifications（通知）</li>
<li>取消勾选Send notifications for failed workflows only（仅在工作流程失败时通知）</li>
</ul>
<blockquote>
<p>可以观摩<code>Vue3.x</code>的测试用例</p>
</blockquote>
<ul>
<li><a href="https://app.circleci.com/pipelines/github/vuejs/vue?branch=dev"><code>Circle CI Vue3</code></a></li>
<li><a href="https://app.codecov.io/gh/vuejs/vue/">codecov.io</a></li>
</ul>
<h3 id="小结">小结</h3>
<ul>
<li>设置的浏览器必须是对应无界面的，<code>xxxHeadless</code></li>
</ul>
<hr>
<blockquote>
<p>参考</p>
</blockquote>
<ul>
<li><a href="https://www.ruanyifeng.com/blog/2019/09/getting-started-with-github-actions.html">GitHub Actions 入门教程 阮一峰</a></li>
<li><a href="http://www.ruanyifeng.com/blog/2019/12/github_actions.html">GitHub Actions 教程：定时发送天气邮件 阮一峰</a></li>
<li><a href="https://segmentfault.com/a/1190000021815477">使用 GitHub Actions 自动部署博客教程</a></li>
<li><a href="https://docs.github.com/cn/actions">GitHub Actions Docs</a></li>
</ul>
<hr>
<p><a href="https://www.google.com/search?q=GitHub+Actions+%E9%98%AE%E4%B8%80%E5%B3%B0&amp;source=hp&amp;ei=zk_uYJPPE8W10PEP3bGjsAs&amp;iflsig=AINFCbYAAAAAYO5d3pvoIekwWsHuuLcRqmI2l1q-Pw7b&amp;oq=GitHub+Actions+%E9%98%AE%E4%B8%80%E5%B3%B0&amp;gs_lcp=Cgdnd3Mtd2l6EAMyBAgAEAw6AggAOgUIIRCgAVDaCliHMWDvMmgBcAB4AIAB7AKIAf0QkgEHMC4yLjUuMpgBAKABAqABAaoBB2d3cy13aXqwAQA&amp;sclient=gws-wiz&amp;ved=0ahUKEwiT7vfJxeHxAhXFGjQIHd3YCLYQ4dUDCAc&amp;uact=5">google GitHub Actions 阮一峰</a></p>
<hr>
<p><a href="https://juejin.cn/post/6896013374497226765">https://juejin.cn/post/6896013374497226765</a> | VuePress自动化部署从travis到Github Actions
<a href="https://juejin.cn/post/6847902222966079501">https://juejin.cn/post/6847902222966079501</a> | Github Actions简单部署一个vue/react项目
<a href="https://juejin.cn/post/6942675520022642719">https://juejin.cn/post/6942675520022642719</a> | 前端工程化之travis ci
<a href="https://juejin.cn/post/6931980888267816974">https://juejin.cn/post/6931980888267816974</a> | travis CI工具自动部署自己github项目
<a href="https://juejin.cn/post/6844904022239870984">https://juejin.cn/post/6844904022239870984</a> | 真香！GitHub Action一键部署
<a href="https://juejin.cn/post/6844903957215576078">https://juejin.cn/post/6844903957215576078</a> | 利用Travis CI+GitHub实现持续集成和自动部署
<a href="https://juejin.cn/post/6844904150753361934">https://juejin.cn/post/6844904150753361934</a> | 用 GitHub Action 构建一套 CI/CD 系统
<a href="https://juejin.cn/post/6844904051537100813">https://juejin.cn/post/6844904051537100813</a> | 编写自己的 GitHub Action，体验自动化部署
<a href="https://docs.github.com/cn/actions/learn-github-actions/migrating-from-travis-ci-to-github-actions?query=chrome">https://docs.github.com/cn/actions/learn-github-actions/migrating-from-travis-ci-to-github-actions?query=chrome</a> | 从 Travis CI 迁移到 GitHub Actions - GitHub Docs
<a href="https://github.com/browser-actions/setup-chrome">https://github.com/browser-actions/setup-chrome</a> | browser-actions/setup-chrome: Set up your GitHub Actions workflow with a specific version of chromium
<a href="https://github.com/marketplace/actions/setup-chromedriver">https://github.com/marketplace/actions/setup-chromedriver</a> | setup-chromedriver · Actions · GitHub Marketplace
<a href="https://github.community/t/how-to-install-google-chrome-browser-in-github-actions-workflow/18471">https://github.community/t/how-to-install-google-chrome-browser-in-github-actions-workflow/18471</a> | How to install Google Chrome browser in GitHub Actions workflow? - Code to Cloud / GitHub Actions - GitHub Support Community
<a href="https://github.community/t/how-to-get-latest-stable-release-chrome-browser-in-workflow/18522">https://github.community/t/how-to-get-latest-stable-release-chrome-browser-in-workflow/18522</a> | How to get latest stable release Chrome browser in workflow? - Code to Cloud / GitHub Actions - GitHub Support Community
<a href="https://remarkablemark.org/blog/2020/12/12/headless-test-in-github-actions-workflow/">https://remarkablemark.org/blog/2020/12/12/headless-test-in-github-actions-workflow/</a> | Run headless test with GitHub Actions | remarkablemark
<a href="https://httptoolkit.tech/blog/migrating-javascript-from-travis-to-github-actions/">https://httptoolkit.tech/blog/migrating-javascript-from-travis-to-github-actions/</a> | Migrating a JS project from Travis to GitHub Actions | HTTP Toolkit
<a href="https://docs.github.com/cn/actions/learn-github-actions/migrating-from-travis-ci-to-github-actions?query=chrome#default-environment-variables">https://docs.github.com/cn/actions/learn-github-actions/migrating-from-travis-ci-to-github-actions?query=chrome#default-environment-variables</a> | 从 Travis CI 迁移到 GitHub Actions - GitHub Docs
<a href="https://docs.github.com/cn/actions/quickstart">https://docs.github.com/cn/actions/quickstart</a> | GitHub Actions 快速入门 - GitHub Docs
<a href="https://docs.github.com/cn/actions/learn-github-actions/introduction-to-github-actions#create-an-example-workflow">https://docs.github.com/cn/actions/learn-github-actions/introduction-to-github-actions#create-an-example-workflow</a> | GitHub Actions 简介 - GitHub Docs
<a href="https://docs.github.com/cn/actions/guides/publishing-nodejs-packages">https://docs.github.com/cn/actions/guides/publishing-nodejs-packages</a> | 发布 Node.js 包 - GitHub Docs
<a href="https://docs.github.com/cn/actions/reference/workflow-syntax-for-github-actions#jobsjob_idruns-on">https://docs.github.com/cn/actions/reference/workflow-syntax-for-github-actions#jobsjob_idruns-on</a> | GitHub Actions 的工作流程语法 - GitHub Docs
<a href="https://github.com/xmasuhai/vueel-demo">https://github.com/xmasuhai/vueel-demo</a> | xmasuhai/vueel-demo
<a href="https://hateonion.me/posts/20feb22/">https://hateonion.me/posts/20feb22/</a> | 持续部署新法宝 - Github Actions | OnionTalk
<a href="http://www.cxyzjd.com/article/hanziyuan08/102389235">http://www.cxyzjd.com/article/hanziyuan08/102389235</a> | 抛弃Travis，Github Actions和Codecov整合教程_Bpazy的博客-程序员宅基地 - 程序员宅基地
<a href="https://copyfuture.com/blogs-details/20210118120350405p">https://copyfuture.com/blogs-details/20210118120350405p</a> | CI/CD 平台迁移实践：从 Travis-CI 转移到 Github Action - 复制未来
<a href="https://wuxinhua.com/2019/11/30/Migrating-from-travis-to-GitHub-Actions/">https://wuxinhua.com/2019/11/30/Migrating-from-travis-to-GitHub-Actions/</a> | 译文：从 Travis 迁移至 GitHub Actions | Kevin&rsquo;s Notes
<a href="https://segmentfault.com/a/1190000039001552">https://segmentfault.com/a/1190000039001552</a> | CI/CD 平台迁移实践：从 Travis-CI 转移到 Github Action - SegmentFault 思否
<a href="https://www.lihuanyu.com/%E5%B7%A5%E7%A8%8B%E5%8C%96/%E4%BB%8ETravis%E8%BF%81%E7%A7%BB%E5%88%B0GitHub-Actions/">https://www.lihuanyu.com/%E5%B7%A5%E7%A8%8B%E5%8C%96/%E4%BB%8ETravis%E8%BF%81%E7%A7%BB%E5%88%B0GitHub-Actions/</a> | 从Travis迁移到GitHub-Actions | 牧宇的Blog
<a href="https://linux.cn/article-13022-1.html">https://linux.cn/article-13022-1.html</a> | 技术|CI/CD 平台迁移实践：从 Travis-CI 转移到 Github Action
<a href="https://chengxuyuanwenku.tumblr.com/post/640482389551988736/cicd-%E5%B9%B3%E5%8F%B0%E8%BF%81%E7%A7%BB%E5%AE%9E%E8%B7%B5%E4%BB%8E-travis-ci-%E8%BD%AC%E7%A7%BB%E5%88%B0-github-action">https://chengxuyuanwenku.tumblr.com/post/640482389551988736/cicd-%E5%B9%B3%E5%8F%B0%E8%BF%81%E7%A7%BB%E5%AE%9E%E8%B7%B5%E4%BB%8E-travis-ci-%E8%BD%AC%E7%A7%BB%E5%88%B0-github-action</a> | 程序员文库 · CI/CD 平台迁移实践：从 Travis-CI 转移到 Github Action
<a href="https://www.shangmayuan.com/a/07fd658682cf47d0b4d427af.html">https://www.shangmayuan.com/a/07fd658682cf47d0b4d427af.html</a> | CI/CD 平台迁移实践：从 Travis-CI 转移到 Github Action - 尚码园
<a href="http://pinkyjie.com/2016/02/27/continuous-integration-with-travis-ci/">http://pinkyjie.com/2016/02/27/continuous-integration-with-travis-ci/</a> | 用 TravisCI 来做持续集成 | 进击的马斯特
<a href="https://segmentfault.com/a/1190000020592707">https://segmentfault.com/a/1190000020592707</a> | 利用Travis CI+GitHub实现持续集成和自动部署 - SegmentFault 思否
<a href="https://www.git2get.com/av/88740507.html">https://www.git2get.com/av/88740507.html</a> | 【分享】Mocha + Karma框架测试用例接入travis CI，chrome无法启动的三种解决方式 | 1024toyou.com
<a href="https://blog.forecho.com/github-action-vs-travis-ci.html">https://blog.forecho.com/github-action-vs-travis-ci.html</a> | GitHub Action 和 Travis CI 对比 - forecho&rsquo;s Blog
<a href="https://www.cnblogs.com/champyin/p/11621898.html">https://www.cnblogs.com/champyin/p/11621898.html</a> | 利用Travis CI+GitHub实现持续集成和自动部署 - champyin - 博客园
<a href="https://www.cnpython.com/qa/192099">https://www.cnpython.com/qa/192099</a> | Travisci构建失败，但测试在本地通过 - 问答 - Python中文网
<a href="https://docs.github.com/cn/actions/learn-github-actions/migrating-from-travis-ci-to-github-actions">https://docs.github.com/cn/actions/learn-github-actions/migrating-from-travis-ci-to-github-actions</a> | 从 Travis CI 迁移到 GitHub Actions - GitHub Docs
<a href="https://blog.csdn.net/DreamLi1314/article/details/109352648">https://blog.csdn.net/DreamLi1314/article/details/109352648</a> | GitHub Actions CI/CD 解放码农双手_Jack Li 的博客-CSDN博客</p>
<hr>
<h2 id="发布npm包">发布<code>npm</code>包</h2>
<h3 id="1-确保代码测试通过了">1 确保代码测试通过了</h3>
<blockquote>
<p><code>npm run test</code> 全部是绿色（原谅色）才行。</p>
</blockquote>
<h3 id="2-上传代码到-npmjsorg">2 上传代码到 <code>npmjs.org</code></h3>
<blockquote>
<p>步骤</p>
</blockquote>
<ul>
<li>0 更新 <code>package.json</code>
<ul>
<li>在 <code>package.json</code> 里将版本号改为 <code>0.0.1</code>，等做完各组件后再改成 <code>1.0.0</code></li>
<li>根目录下创建入口文件 <code>index.js</code></li>
<li>在 <code>index.js</code> 里将想要导出的内容全部导出</li>
</ul>
</li>
<li>1 去 <code>https://www.npmjs.com/</code> 注册一个账户</li>
<li>2 确认一下邮箱（必须）</li>
<li>3 在项目根目录运行 <code>npm adduser</code>
<ul>
<li>按提示输入用户名 密码 邮箱，注意登录名为用户名，不是邮箱</li>
<li>如果错误提示里面含有 <code>https://registry.npm.taobao.org</code></li>
<li>则说明 <code>npm</code> 源目前为<strong>淘宝源</strong>，需要更换为 <code>npm</code> 官方源
<ul>
<li><code>npm config list</code>查看npm路径</li>
<li>找到<code>registry=https://registry.npm.taobao.org/</code></li>
<li>注释掉<code>//registry=https://registry.npm.taobao.org/</code></li>
<li>或者改掉<code>registry=https://registry.npm.org/</code></li>
<li>或者设置<code>npm config set registry http://registry.npm.taobao.org/</code></li>
<li>查看<code>npm config get registry</code></li>
</ul>
</li>
<li>显示<code>Logged in as xxx on https://registry.npmjs.org/.</code>则说明登陆成功</li>
<li>再次确认<code>package.json</code>中<code>name</code>，即为npm包的名字</li>
</ul>
</li>
<li>4 运行 <code>npm publish</code></li>
<li>发布成功后显示<code>+ xxx@0.0.1</code></li>
</ul>
<blockquote>
<p><code>./index.js</code></p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="kr">import</span> <span class="nx">Button</span> <span class="nx">from</span> <span class="s1">&#39;./src/components/vuebutton/VueButton.vue&#39;</span>
<span class="kr">import</span> <span class="nx">ButtonGroup</span> <span class="nx">from</span> <span class="s1">&#39;./src/components/ButtonGroup/ButtonGroup.vue&#39;</span>
<span class="kr">import</span> <span class="nx">icon</span> <span class="nx">from</span> <span class="s1">&#39;./src/components/icon/VueIcon.vue&#39;</span>

<span class="kr">export</span> <span class="p">{</span><span class="nx">Button</span><span class="p">,</span> <span class="nx">ButtonGroup</span><span class="p">,</span> <span class="nx">icon</span><span class="p">}</span>

</code></pre></td></tr></table>
</div>
</div><h3 id="3-试用自己的包">3 试用自己的包</h3>
<h4 id="试用步骤">试用步骤</h4>
<ul>
<li>使用<code>vue-cli</code> 创建一个用于测试包的项目</li>
<li>使用<code>yarn add xxx</code> 安装包</li>
<li>使用<code>yarn serve</code> 启动服务</li>
<li>在入口文件引入自己的包<code>import {Button, ButtonGroup, Icon} from 'vueel-demo'</code></li>
<li>控制台打印<code>console.log('Button: ', Button)</code>，查看是否正常输出</li>
</ul>
<h4 id="如果当前版本的node不支持import需要用bable转译">如果当前版本的<code>node</code>不支持<code>import</code>，需要用<code>bable</code>转译</h4>
<ul>
<li>进入包的目录</li>
<li>使用<code>parcel build index.ts --no-cache --no-minify</code>转译单个文件：入口文件<code>index.ts</code></li>
<li>会在根目录下生成<code>dist</code>，其中含有三个文件，<code>index.js</code> <code>index.css</code> <code>index.map</code></li>
<li>在包项目的<code>package.json</code>中设置<code>main</code>字段改为<code>&quot;dist/index.js&quot;</code></li>
<li>升及下版本号<code>&quot;version&quot;: &quot;0.0.2&quot;,</code></li>
<li>提交代码到github</li>
<li>切换淘宝源<code>npm config set registry https://registry.npm.org/</code></li>
<li>再发布npm <code>npm publish</code></li>
<li>切换淘宝源<code>npm config set registry https://registry.npm.taobao.org/</code></li>
<li>虽然项目中忽略了<code>dist</code>目录，但不影响npm发布</li>
</ul>
<h4 id="使用包时未加载完全">使用包时，未加载完全</h4>
<ul>
<li>注意转译时是否加了<code>--no-minify</code></li>
<li><code>parcel build index.js --no-cache --no-minify</code></li>
</ul>
<h4 id="未加载样式">未加载样式</h4>
<ul>
<li>手动引入 <code>xxx/dist/index.css</code></li>
</ul>
<h4 id="切换淘宝源">切换淘宝源</h4>
<ul>
<li>或者设置<code>npm config set registry https://registry.npm.taobao.org/</code></li>
<li>查看<code>npm config get registry</code></li>
<li>不要用<code>cnpm</code>，基本不维护了</li>
</ul>
<h4 id="npm-publish-遇到-403"><code>npm publish</code> 遇到 <code>403</code></h4>
<p><img src="https://static.xiedaimala.com/xdml/image/3ac7c224-c23d-491f-84b5-4fabfbeab9b8/2018-8-23-0-11-31.png" alt="npm publish 遇到 403"></p>
<blockquote>
<p>首先看log里面有没有 taobao 字样（截图中有）</p>
</blockquote>
<ul>
<li>如果有 这说明你没有切换到 npm 原始源，那么你只需要用 <code>npm config delete registry</code> 删除淘宝源</li>
<li>然后再 publish</li>
<li>publish 成功之后再切换回淘宝源 <code>npm config set registry https://registry.npm.taobao.org</code></li>
<li>如果嫌切换不方便，可以安装 <a href="https://github.com/Pana/nrm">nrm</a> 来快速切换源</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh">yarn global add nrm
<span class="c1"># 查看</span>
nrm ls
<span class="c1"># 切换 淘宝源</span>
nrm use taobao
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>没有 taobao，看 log 里面有没有「spam detection」字样</p>
</blockquote>
<p><img src="https://static.xiedaimala.com/xdml/image/3ac7c224-c23d-491f-84b5-4fabfbeab9b8/2018-8-23-0-23-48.png" alt="spam detection"></p>
<ul>
<li>如果有
<ul>
<li>这说明 package name 看起来像是 spam（垃圾邮件）</li>
<li>需要换一个更正常的名字。比如 china-number-one-haha</li>
</ul>
</li>
<li>如果没有
<ul>
<li>可能是你的 pacakge name 已经被人注册了，换个 name 试试</li>
</ul>
</li>
</ul>
<hr>
<blockquote>
<p>如何不用每次一改代码就得上传到npm，更新包，才能查看实际使用效果</p>
</blockquote>
<h3 id="使用本地注册-npm-link">使用本地注册 <code>npm link</code></h3>
<ul>
<li>不用上传npm 就可引用包</li>
<li><code>yarn link</code> 也可</li>
<li>本地调试，在项目目录使用 <code>npm link</code></li>
<li>然后在使用之处运行 <code>npm link xxx</code>，就是引用最新的</li>
</ul>
<hr>
<ul>
<li>1 预测其他使用包的人会怎么使用
<ul>
<li>使用 <code>vue-cli</code></li>
<li>使用 <code>webpack</code></li>
<li>使用 <code>parcel</code></li>
</ul>
</li>
<li>2 分别使用这些方式来试用自己的包（只以 <code>vue-cli</code> 为例）
<ul>
<li>使用过程中若发现报错说 <code>import</code> 语法有问题</li>
<li>因为 <code>node</code> 目前不支持 <code>import</code>，需要用 <code>babel</code> 转译 <code>import</code></li>
<li>可以要求使用者自己用 <code>babel</code> 来转译</li>
<li>也可以转义好了再给别人用
<ul>
<li><code>npx parcel build index.js --no-minify</code></li>
<li>本来不应该加 <code>--no-minify</code> 的，奈何不加会有 bug，HTML 压缩把 <code>&lt;slot/&gt;</code> 标签全删了</li>
<li>将 <code>package.json</code> 的 main 改为 <code>dist/index.js</code></li>
</ul>
</li>
</ul>
</li>
<li>3 使用 <code>npm link</code> 或者 <code>yarn link</code> 来加速调试
<ul>
<li>每次修改源码之后，有两条路让别人得到最新效果
<ul>
<li>更新 <code>package.json</code> 里的 <code>version</code>，然后 <code>npm publish</code></li>
<li>别人通过 <code>npm update xxx</code> 来更新</li>
<li>如果只是为了本地调试，可以在项目目录使用 <code>npm link</code></li>
<li>然后在使用之处运行 <code>npm link xxx</code>，就是最新了</li>
</ul>
</li>
</ul>
</li>
</ul>
<blockquote>
<p>警告：npm link 在 Windows 上会抽风</p>
</blockquote>
<ul>
<li>如果 npm link 之后项目报错，就不要再用 npm link 了</li>
<li>只需要每次改完代码后 npm publish ，然后再在另一个地方 npm install <a href="mailto:xxx@0.0.x">xxx@0.0.x</a> 即可</li>
</ul>
<hr>
<blockquote>
<p>将远程的SVG <code>&lt;script src=&quot;//at.alicdn.com/t/font_2138557_rt8obmx2qyd.js&quot;&gt;&lt;/script&gt;</code>，拷贝为本地<code>svg.js</code></p>
</blockquote>
<ul>
<li>新建<code>svg.js</code></li>
<li>从<code>//at.alicdn.com/t/font_2138557_rt8obmx2qyd.js</code>拷贝所有内容到<code>svg.js</code></li>
<li>在<code>VueIcon.vue</code>中引入: <code>import './svg.js'</code></li>
<li>去掉<code>index.html</code>中对应的<code>&lt;script&gt;</code>标签</li>
</ul>
<hr>
<h3 id="记录一个node入口文件名字的bug">记录一个<code>node</code>入口文件名字的bug</h3>
<ul>
<li>当根目录下的入口文件名为<code>index.js</code>时</li>
</ul>
<blockquote>
<p>过程</p>
</blockquote>
<ul>
<li>根目录入口文件为<code>index.js</code></li>
<li>根目录下使用<code>npx parcel --no-cache</code>或<code>parcel --no-cache</code></li>
<li>打开<code>http://localhost:1234</code></li>
<li>浏览器找不到页面</li>
</ul>
<blockquote>
<p>排查</p>
</blockquote>
<ul>
<li>排查之前，先确保提交代码<code>git commite -m 'xxx'</code></li>
<li><code>git log</code>查看所有提交版本记录</li>
<li>找到最后一次功能可行的提交和最近一次功能失败的提交</li>
<li>不断地使用<strong>二分法</strong>找出两次提交之间的<code>commit</code>哈希，缩小范围</li>
<li>复制整个哈希或前8位</li>
<li>使用 <em><strong><code>git reset --hard xx34xx78</code></strong></em>
<ul>
<li>注意<code>git reset --hard</code>会将<em><strong>磁盘上未提交的变更全部删除</strong></em></li>
<li>确保已经提交代码<code>git commite -m 'xxx'</code></li>
</ul>
</li>
<li>重装依赖<code>yarn install</code></li>
<li>找到后，使用 <strong><code>git show</code></strong> 查看此次<strong>提交变更了什么</strong></li>
<li>原因是增加了入口文件<code>index.js</code>
<ul>
<li><code>Node.js</code> 的作者曾使用<code>index.js</code>作为默认入口文件名</li>
<li>当运行<code>npm parcel --no-cache</code>时，会默认先去找<code>index.js</code>文件</li>
<li>而转译实际上需要的是<code>index.html</code>文件</li>
</ul>
</li>
<li>使用<code>git reflog</code>列出所有提交记录</li>
<li><code>git reset --hard xxxxxxx</code>返回最近一次运行失败的<code>commit</code></li>
<li>运行<code>npx parcel --no-cache index.html</code>，可显示页面</li>
<li>小结下就是<code>Node.js</code>留了个坑，而<code>parcel</code>并未提示</li>
</ul>
<blockquote>
<p>防止忘记写，将命令写到<code>package.json</code>的<code>&quot;scripts&quot;</code>字段中</p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="s2">&#34;scripts&#34;</span><span class="err">:</span> <span class="p">{</span>
    <span class="nt">&#34;start&#34;</span><span class="p">:</span> <span class="s2">&#34;parcel index.html --no-cache&#34;</span><span class="p">,</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><hr>
<p><a href="https://note.youdao.com/web/#/file/recent/markdown/WEBcb5b2fa714bedf8bb94872dd26e9dce1/">https://note.youdao.com/web/#/file/recent/markdown/WEBcb5b2fa714bedf8bb94872dd26e9dce1/</a> | 有道云笔记
<a href="https://www.cnblogs.com/zuojiayi/p/6893330.html">https://www.cnblogs.com/zuojiayi/p/6893330.html</a> | npm发布包&ndash;所遇到的问题 - 缃言的Blog - 博客园
<a href="https://www.cnblogs.com/zhoudaozhang/p/4730070.html">https://www.cnblogs.com/zhoudaozhang/p/4730070.html</a> | npm ERR publish 403,nodejs发布包流程 - 周道长 - 博客园
<a href="https://blog.csdn.net/gamesdev/article/details/49018629">https://blog.csdn.net/gamesdev/article/details/49018629</a> | npm发布注意事项_开发游戏，辉煌全中国-CSDN博客
<a href="https://www.cnblogs.com/songqingbo/articles/5611588.html">https://www.cnblogs.com/songqingbo/articles/5611588.html</a> | 快速切换npm源的开源工具&ndash;nrm - 南非波波 - 博客园
<a href="https://www.jianshu.com/p/6ffa934da70c">https://www.jianshu.com/p/6ffa934da70c</a> | 发布npm包时遇到的问题及解决方法 - 简书
<a href="https://blog.csdn.net/Aria_Miazzy/article/details/111473961">https://blog.csdn.net/Aria_Miazzy/article/details/111473961</a> | 发布npm包时遇到的问题及解决方法_YunWisdom-CSDN博客
<a href="https://cloud.tencent.com/developer/article/1454387">https://cloud.tencent.com/developer/article/1454387</a> | 发布自己的npm包及报错解决办法 - 云+社区 - 腾讯云
<a href="https://zhuanlan.zhihu.com/p/374903490">https://zhuanlan.zhihu.com/p/374903490</a> | npm是什么、npm的常用命令及如何解决npm被墙的问题 - 知乎
<a href="https://www.shuzhiduo.com/A/gAJGY3nndZ/">https://www.shuzhiduo.com/A/gAJGY3nndZ/</a> | 解决NPM无法安装任何包的解决方案（npm ERR! code MODULE_NOT_FOUND）</p>
<hr>
<h2 id="完成-readmemd">完成 <code>README.md</code></h2>
<h3 id="添加badge">添加<code>badge</code></h3>
<h4 id="添加测试badge">添加测试<code>badge</code></h4>
<p><img src="https://github.com/xmasuhai/vueel-demo/actions/workflows/unit-test-actions.yml/badge.svg" alt="github actions badge"></p>
<ul>
<li>使用工作流程文件的名称来引用工作流程 <code>https://github.com/&lt;OWNER&gt;/&lt;REPOSITORY&gt;/actions/workflows/&lt;WORKFLOW_FILE&gt;/badge.svg</code></li>
<li>Markdown 示例 <code>![example workflow](https://github.com/github/docs/actions/workflows/main.yml/badge.svg)</code></li>
</ul>
<h4 id="添加npm-badge">添加<code>npm badge</code></h4>
<p><img src="https://img.shields.io/github/package-json/v/xmasuhai/vueel-demo" alt="GitHub package.json version"></p>
<ul>
<li>在<a href="https://shields.io/">shields.io</a>上搜<code>npm</code></li>
<li><code>![GitHub package.json version](https://img.shields.io/github/package-json/v/USER/REPO)</code></li>
<li>添加<code>codecov badge</code>代码覆盖率<code>Code Coverage</code></li>
<li>添加<code>npm badge</code></li>
</ul>
<hr>
<blockquote>
<p>参考</p>
</blockquote>
<ul>
<li><a href="https://github.com/vuejs/vue#readme"><code>Vue.js</code>的<code>README.md</code>文档</a></li>
<li><a href="https://docs.github.com/cn/actions/managing-workflow-runs/adding-a-workflow-status-badge">GitHub Actions添加工作流程状态徽章</a></li>
<li><a href="https://shields.io/"><code>shields.io</code>生成各种<code>badge</code></a></li>
</ul>
<hr>
<h4 id="使用命令行git-open打开仓库">使用命令行<code>git open</code>打开仓库</h4>
<ul>
<li>安装 <code>yarn global add git-open</code></li>
<li>项目根目录下打开 <code>git open</code></li>
</ul>
<h4 id="caniuse查看浏览器支持样式的版本"><code>caniuse</code>查看浏览器支持样式的版本</h4>
<ul>
<li><a href="https://caniuse.com/"><code>caniuse.com</code></a></li>
</ul>
<h4 id="删除appvue中的测试代码块">删除<code>App.vue</code>中的测试代码块</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="c1">// 单元测试
</span><span class="c1"></span><span class="kr">import</span> <span class="nx">chai</span> <span class="kr">from</span> <span class="s1">&#39;chai&#39;</span><span class="p">;</span>
<span class="kr">import</span> <span class="nx">spies</span> <span class="kr">from</span> <span class="s1">&#39;chai-spies&#39;</span><span class="p">;</span>

<span class="nx">chai</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">spies</span><span class="p">);</span>
<span class="kr">const</span> <span class="nx">expect</span> <span class="o">=</span> <span class="nx">chai</span><span class="p">.</span><span class="nx">expect</span><span class="p">;</span>
<span class="k">try</span> <span class="p">{</span>
  <span class="c1">// 测试按钮含有 icon
</span><span class="c1"></span>  <span class="p">{</span>
    <span class="kr">const</span> <span class="nx">Constructor</span> <span class="o">=</span> <span class="nx">Vue</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nx">VueButton</span><span class="p">);</span>
    <span class="kr">const</span> <span class="nx">vm</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Constructor</span><span class="p">({</span>
      <span class="nx">propsData</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">icon</span><span class="o">:</span> <span class="s1">&#39;settings&#39;</span>
      <span class="p">},</span>
    <span class="p">});</span>
    <span class="c1">// button.$mount(&#39;#test&#39;)
</span><span class="c1"></span>    <span class="nx">vm</span><span class="p">.</span><span class="nx">$mount</span><span class="p">();</span>
    <span class="kr">const</span> <span class="nx">useElement</span> <span class="o">=</span> <span class="nx">vm</span><span class="p">.</span><span class="nx">$el</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s1">&#39;use&#39;</span><span class="p">);</span>
    <span class="c1">// console.log(userElement)
</span><span class="c1"></span>    <span class="cm">/*
</span><span class="cm">    // Uncaught AssertionError
</span><span class="cm">    // expect(useElement.getAttribute(&#39;xlink:href&#39;)).to.equal(&#39;settings&#39;)
</span><span class="cm">    */</span>
    <span class="c1">// 可以通过的测试用例
</span><span class="c1"></span>    <span class="k">if</span> <span class="p">(</span><span class="nx">useElement</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">expect</span><span class="p">(</span><span class="nx">useElement</span><span class="p">.</span><span class="nx">getAttribute</span><span class="p">(</span><span class="s1">&#39;xlink:href&#39;</span><span class="p">)).</span><span class="nx">to</span><span class="p">.</span><span class="nx">equal</span><span class="p">(</span><span class="s1">&#39;#i-settings&#39;</span><span class="p">);</span>
      <span class="kr">const</span> <span class="nx">href</span> <span class="o">=</span> <span class="nx">useElement</span><span class="p">.</span><span class="nx">getAttribute</span><span class="p">(</span><span class="s1">&#39;xlink:href&#39;</span><span class="p">);</span>
      <span class="nx">expect</span><span class="p">(</span><span class="nx">href</span><span class="p">).</span><span class="nx">to</span><span class="p">.</span><span class="nx">eq</span><span class="p">(</span><span class="s1">&#39;#i-settings&#39;</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="nx">vm</span><span class="p">.</span><span class="nx">$el</span><span class="p">.</span><span class="nx">remove</span><span class="p">();</span>
    <span class="nx">vm</span><span class="p">.</span><span class="nx">$destroy</span><span class="p">();</span>
  <span class="p">}</span>

  <span class="c1">// 测试 isLoading属性 是否显示#i-loading的图标
</span><span class="c1"></span>  <span class="p">{</span>
    <span class="kr">const</span> <span class="nx">Constructor</span> <span class="o">=</span> <span class="nx">Vue</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nx">VueButton</span><span class="p">);</span>
    <span class="kr">const</span> <span class="nx">vm</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Constructor</span><span class="p">({</span>
      <span class="nx">propsData</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">icon</span><span class="o">:</span> <span class="s1">&#39;settings&#39;</span><span class="p">,</span>
        <span class="nx">isLoading</span>: <span class="kt">true</span><span class="p">,</span>
      <span class="p">},</span>
    <span class="p">});</span>
    <span class="nx">vm</span><span class="p">.</span><span class="nx">$mount</span><span class="p">();</span>
    <span class="kr">const</span> <span class="nx">useElement</span> <span class="o">=</span> <span class="nx">vm</span><span class="p">.</span><span class="nx">$el</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s1">&#39;use&#39;</span><span class="p">);</span>
    <span class="kr">const</span> <span class="nx">href</span> <span class="o">=</span> <span class="nx">useElement</span><span class="o">?</span><span class="p">.</span><span class="nx">getAttribute</span><span class="p">(</span><span class="s1">&#39;xlink:href&#39;</span><span class="p">);</span>
    <span class="c1">// Uncaught AssertionError
</span><span class="c1"></span>    <span class="c1">// expect(href).to.eq(&#39;#i-settings&#39;)
</span><span class="c1"></span>    <span class="nx">expect</span><span class="p">(</span><span class="nx">href</span><span class="p">).</span><span class="nx">to</span><span class="p">.</span><span class="nx">eq</span><span class="p">(</span><span class="s1">&#39;#i-loading&#39;</span><span class="p">);</span>
    <span class="nx">vm</span><span class="p">.</span><span class="nx">$el</span><span class="p">.</span><span class="nx">remove</span><span class="p">();</span>
    <span class="nx">vm</span><span class="p">.</span><span class="nx">$destroy</span><span class="p">();</span>
  <span class="p">}</span>

  <span class="c1">// 测试 iconPosition order 默认为 1 左边 ；2 右边
</span><span class="c1"></span>  <span class="p">{</span>
    <span class="kr">const</span> <span class="nx">Constructor</span> <span class="o">=</span> <span class="nx">Vue</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nx">VueButton</span><span class="p">);</span>
    <span class="kr">const</span> <span class="nx">vm</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Constructor</span><span class="p">({</span>
      <span class="nx">propsData</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">icon</span><span class="o">:</span> <span class="s1">&#39;settings&#39;</span><span class="p">,</span>
      <span class="p">},</span>
    <span class="p">});</span>
    <span class="c1">// button 必须被加载 渲染到页面中，CSS加载，才能识别 order
</span><span class="c1"></span>    <span class="c1">// 否则 expect(order).to.eq(&#39;&#39;)为空
</span><span class="c1"></span>    <span class="kr">const</span> <span class="nx">div</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">&#39;div&#39;</span><span class="p">);</span>
    <span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">div</span><span class="p">);</span>
    <span class="nx">vm</span><span class="p">.</span><span class="nx">$mount</span><span class="p">(</span><span class="nx">div</span><span class="p">);</span>
    <span class="kr">const</span> <span class="nx">svg</span> <span class="o">=</span> <span class="nx">vm</span><span class="p">.</span><span class="nx">$el</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s1">&#39;svg&#39;</span><span class="p">);</span>
    <span class="kr">const</span> <span class="p">{</span><span class="nx">order</span><span class="p">}</span> <span class="o">=</span> <span class="nb">window</span><span class="p">.</span><span class="nx">getComputedStyle</span><span class="p">(</span><span class="nx">svg</span> <span class="kr">as</span> <span class="nx">SVGSVGElement</span><span class="p">);</span>
    <span class="c1">// 错误断言
</span><span class="c1"></span>    <span class="c1">// expect(order).to.eq(1)
</span><span class="c1"></span>    <span class="c1">// 正确断言
</span><span class="c1"></span>    <span class="c1">//CSS 所有属性值都是字符串
</span><span class="c1"></span>    <span class="nx">expect</span><span class="p">(</span><span class="nx">order</span><span class="p">).</span><span class="nx">to</span><span class="p">.</span><span class="nx">eq</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">);</span>
    <span class="nx">vm</span><span class="p">.</span><span class="nx">$el</span><span class="p">.</span><span class="nx">remove</span><span class="p">();</span>
    <span class="nx">vm</span><span class="p">.</span><span class="nx">$destroy</span><span class="p">();</span>
  <span class="p">}</span>

  <span class="c1">// 测试 iconPosition order 为 2 右边
</span><span class="c1"></span>  <span class="p">{</span>
    <span class="kr">const</span> <span class="nx">Constructor</span> <span class="o">=</span> <span class="nx">Vue</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nx">VueButton</span><span class="p">);</span>
    <span class="kr">const</span> <span class="nx">vm</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Constructor</span><span class="p">({</span>
      <span class="nx">propsData</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">icon</span><span class="o">:</span> <span class="s1">&#39;settings&#39;</span><span class="p">,</span>
        <span class="nx">iconPosition</span><span class="o">:</span> <span class="s1">&#39;right&#39;</span><span class="p">,</span>
      <span class="p">},</span>
    <span class="p">});</span>
    <span class="kr">const</span> <span class="nx">div</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">&#39;div&#39;</span><span class="p">);</span>
    <span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">div</span><span class="p">);</span>
    <span class="nx">vm</span><span class="p">.</span><span class="nx">$mount</span><span class="p">(</span><span class="nx">div</span><span class="p">);</span>
    <span class="kr">const</span> <span class="nx">svg</span> <span class="o">=</span> <span class="nx">vm</span><span class="p">.</span><span class="nx">$el</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s1">&#39;svg&#39;</span><span class="p">);</span>
    <span class="kr">const</span> <span class="p">{</span><span class="nx">order</span><span class="p">}</span> <span class="o">=</span> <span class="nb">window</span><span class="p">.</span><span class="nx">getComputedStyle</span><span class="p">(</span><span class="nx">svg</span> <span class="kr">as</span> <span class="nx">SVGSVGElement</span><span class="p">);</span>
    <span class="nx">expect</span><span class="p">(</span><span class="nx">order</span><span class="p">).</span><span class="nx">to</span><span class="p">.</span><span class="nx">eq</span><span class="p">(</span><span class="s1">&#39;2&#39;</span><span class="p">);</span>
    <span class="nx">vm</span><span class="p">.</span><span class="nx">$el</span><span class="p">.</span><span class="nx">remove</span><span class="p">();</span>
    <span class="nx">vm</span><span class="p">.</span><span class="nx">$destroy</span><span class="p">();</span>
  <span class="p">}</span>

  <span class="c1">// 测试 按钮触发 click // mock 使用 chai.spies 监听函数
</span><span class="c1"></span>  <span class="p">{</span>
    <span class="kr">const</span> <span class="nx">Constructor</span> <span class="o">=</span> <span class="nx">Vue</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nx">VueButton</span><span class="p">);</span>
    <span class="kr">const</span> <span class="nx">vm</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Constructor</span><span class="p">({</span>
      <span class="nx">propsData</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">icon</span><span class="o">:</span> <span class="s1">&#39;settings&#39;</span><span class="p">,</span>
      <span class="p">},</span>
    <span class="p">});</span>
    <span class="nx">vm</span><span class="p">.</span><span class="nx">$mount</span><span class="p">();</span>
    <span class="kr">const</span> <span class="nx">spyFn</span> <span class="o">=</span> <span class="nx">chai</span><span class="p">.</span><span class="nx">spy</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;spy function OK&#39;</span><span class="p">);</span>
    <span class="p">});</span>

    <span class="nx">vm</span><span class="p">.</span><span class="nx">$on</span><span class="p">(</span><span class="s1">&#39;click&#39;</span><span class="p">,</span> <span class="nx">spyFn</span><span class="p">);</span>
    <span class="kr">const</span> <span class="nx">button</span> <span class="o">=</span> <span class="nx">vm</span><span class="p">.</span><span class="nx">$el</span><span class="p">;</span>
    <span class="p">(</span><span class="nx">button</span> <span class="kr">as</span> <span class="nx">HTMLButtonElement</span><span class="p">).</span><span class="nx">click</span><span class="p">();</span>
    <span class="c1">// 期望 函数被执行
</span><span class="c1"></span>    <span class="nx">expect</span><span class="p">(</span><span class="nx">spyFn</span><span class="p">).</span><span class="nx">to</span><span class="p">.</span><span class="nx">have</span><span class="p">.</span><span class="nx">been</span><span class="p">.</span><span class="nx">called</span><span class="p">();</span>
    <span class="nx">vm</span><span class="p">.</span><span class="nx">$el</span><span class="p">.</span><span class="nx">remove</span><span class="p">();</span>
    <span class="nx">vm</span><span class="p">.</span><span class="nx">$destroy</span><span class="p">();</span>
  <span class="p">}</span>

<span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// window.errors = [error];
</span><span class="c1"></span>  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;error: &#39;</span><span class="p">,</span> <span class="nx">error</span><span class="p">);</span>
<span class="p">}</span> <span class="k">finally</span> <span class="p">{</span>
  <span class="c1">// window.errors 存在 打印所有错误信息
</span><span class="c1"></span>  <span class="cm">/*
</span><span class="cm">  window.errors &amp;&amp; window.errors.forEach((error: Error) =&gt; {
</span><span class="cm">    console.error(error.message);
</span><span class="cm">  });
</span><span class="cm">  */</span>
<span class="p">}</span>

</code></pre></td></tr></table>
</div>
</div><hr>
<h2 id="总结">总结</h2>
<ul>
<li>使用<code>Vue</code>单文件组件</li>
<li>打包工具<code>Parcel</code></li>
<li>单元测试 <code>{...} {...}</code></li>
<li>自动测试 <code>Karma</code> BDD风格的<code>Mocha</code> 断言库<code>Chai</code> expect</li>
<li>持续集成 <code>GitHub Actions</code></li>
<li><code>package.json</code> 发布 <code>npm publish</code></li>
<li><code>yarn link</code> 本地试用包，加快测试效率</li>
</ul>
<hr>
<ul>
<li>查看<a href="https://github.com/FrankFang/gulu/commits/master?after=36fbd6867d0a223184ad67e3d2bc3569e88847e0+104">源代码提交记录</a></li>
<li>查看<a href="https://github.com/FrankFang/gulu">gulu源代码</a></li>
</ul>
<p>在 GitHub 上有一个远程仓库
仓库中有一个 package.json
仓库中有一个 LICENSE 文件
仓库中有一个 README.md 文件
仓库中有一个 index.html 文件</p>
<hr>
<blockquote>
<p>参考文章</p>
</blockquote>
<ul>
<li><a href="https://routinepanic.com/questions/javascript-unit-test-tools-for-tdd">用于 TDD 的 JavaScript 单元测试工具</a></li>
<li><a href="https://www.jianshu.com/p/79bcac6fc94d">自动化单元测试</a></li>
<li><a href="https://juejin.cn/post/6844903942023823367">TypeScript + Jest 开源项目的自动化测试</a></li>
<li><a href="https://juejin.cn/post/6844903888512876558">前端单元测试框架-Jest入门配置(测试TypeScript)</a></li>
<li><a href="https://juejin.cn/post/6844903896360419341">使用 Vue Cli3 + TypeScript + Vuex + Jest 构建 todoList</a></li>
<li><a href="https://juejin.cn/post/6953961160223752205">前端抢饭碗系列之Vue项目中如何做单元测试</a></li>
<li><a href="https://juejin.cn/post/6844903589488361486">[译] JavaScript 单元测试框架：Jasmine, Mocha, AVA, Tape 和 Jest 的比较</a></li>
</ul>
<blockquote>
<p>Mocha Chai Chai-spies Karma 单元测试</p>
</blockquote>
<ul>
<li><a href="https://juejin.cn/post/6844904015453487117">Mocha和单元测试</a></li>
<li><a href="https://juejin.cn/post/6844904051839090702">【vue系列】vue2.x 项目配置 Mocha 单元测试</a></li>
<li><a href="https://juejin.cn/post/6844903609394708487">搭建 vue2 单元测试环境(karma+mocha+webpack3)</a></li>
<li><a href="https://www.jianshu.com/p/073d25a3bba0">Vue.js学习系列六 —— Vue单元测试Karma+Mocha学习笔记</a></li>
<li><a href="https://juejin.cn/post/6844903816551202830">vue单元测试Mocha + Chai + Vue-Test-Utils</a></li>
</ul>
<hr>
<p><a href="https://juejin.cn/post/6903690374158974989">https://juejin.cn/post/6903690374158974989</a> | 马上就2021年了，你还不懂怎么在vue做单元测试？
<a href="https://juejin.cn/post/6844903982922465293">https://juejin.cn/post/6844903982922465293</a> | Vue-Test-Utils + Jest 单元测试入门与实践
<a href="https://juejin.cn/post/6844904018129453070">https://juejin.cn/post/6844904018129453070</a> | 单元测试从零开始，包含 Vue 及 React 项目中该如何单测
<a href="https://juejin.cn/post/6844903624833761294">https://juejin.cn/post/6844903624833761294</a> | Vue单元测试探索
<a href="https://juejin.cn/post/6844903597528842248">https://juejin.cn/post/6844903597528842248</a> | 从零开始做Vue前端架构（6）单元测试 &amp; 代码覆盖率
<a href="https://juejin.cn/post/6885953990345883661">https://juejin.cn/post/6885953990345883661</a> | 顺藤摸瓜🍉：用单元测试读懂 vue3 中的 defineComponent
<a href="https://juejin.cn/post/6844903911539621896">https://juejin.cn/post/6844903911539621896</a> | 使用 Jest 进行 Vue 单元测试
<a href="https://juejin.cn/post/6844903794765987854">https://juejin.cn/post/6844903794765987854</a> | 【译】Vue 的小奇技（第九篇）：快照测试的威力
<a href="https://juejin.cn/post/6844903812885381133">https://juejin.cn/post/6844903812885381133</a> | vue单元测试vue test utils使用初探
<a href="https://juejin.cn/post/6844904021778497549">https://juejin.cn/post/6844904021778497549</a> | Vue使用Jest单元测试（学习笔记）
<a href="https://juejin.cn/post/6844903974512885767">https://juejin.cn/post/6844903974512885767</a> | 尝鲜Vue3之四：如何运行Jest单元测试
<a href="https://juejin.cn/post/6844904012827852814">https://juejin.cn/post/6844904012827852814</a> | vue单元测试第一篇：单元测试介绍和基本使用
<a href="https://juejin.cn/post/6975686914267414565">https://juejin.cn/post/6975686914267414565</a> | 基于Vue 的单元测试
<a href="https://juejin.cn/post/6844903742119084040">https://juejin.cn/post/6844903742119084040</a> | 为vue的项目添加单元测试
<a href="https://juejin.cn/post/6844903966879268878">https://juejin.cn/post/6844903966879268878</a> | Vue单元测试
<a href="https://juejin.cn/post/6844903886331838472">https://juejin.cn/post/6844903886331838472</a> | Vue组件库工程探索与实践之单元测试
<a href="https://juejin.cn/post/6856649733290377224">https://juejin.cn/post/6856649733290377224</a> | 试着为vue项目添加单元测试（一）
<a href="https://juejin.cn/post/6856730547969622024">https://juejin.cn/post/6856730547969622024</a> | Vue单元测试代码大全( jest + vue-test-utils)
<a href="https://juejin.cn/post/6844903970008203277">https://juejin.cn/post/6844903970008203277</a> | Vue使用jest单元测试详解
<a href="https://zhuanlan.zhihu.com/p/26752090">https://zhuanlan.zhihu.com/p/26752090</a> | Vue 的单元测试探索（一） - 知乎
<a href="https://juejin.cn/post/6978831511164289055">https://juejin.cn/post/6978831511164289055</a> | Vue业务系统落地单元测试
<a href="https://juejin.cn/post/6844903550057709582">https://juejin.cn/post/6844903550057709582</a> | VUE+jtest的组件单元测试
<a href="https://www.jianshu.com/p/45e8c2b26309">https://www.jianshu.com/p/45e8c2b26309</a> | Vue单元测试case写法 - 简书
<a href="https://zhuanlan.zhihu.com/p/26796206">https://zhuanlan.zhihu.com/p/26796206</a> | Vue 的单元测试探索（二） - 知乎
<a href="https://juejin.cn/post/6844904082516377607">https://juejin.cn/post/6844904082516377607</a> | vue项目搭建jest单元测试及采坑
<a href="https://juejin.cn/post/6844904038916423688">https://juejin.cn/post/6844904038916423688</a> | vue单元测试
<a href="https://juejin.cn/post/6845166890994647054">https://juejin.cn/post/6845166890994647054</a> | vue 项目增加 Jest 单元测试
<a href="https://mp.weixin.qq.com/s/FZhcKXpikOgjKXQwFvbB5A">https://mp.weixin.qq.com/s/FZhcKXpikOgjKXQwFvbB5A</a> | [译] Vuex 之单元测试
<a href="https://juejin.cn/post/6950903896621613069">https://juejin.cn/post/6950903896621613069</a> | Vue单元测试初探
<a href="https://juejin.cn/post/6916677772962168845">https://juejin.cn/post/6916677772962168845</a> | VUE单元测试&ndash;进阶之路
<a href="https://juejin.cn/post/6951195118728642574">https://juejin.cn/post/6951195118728642574</a> | Vue中的单元测试实践
<a href="https://juejin.cn/post/6892003555818143752">https://juejin.cn/post/6892003555818143752</a> | 手把手带你入门前端工程化——超详细教程
<a href="https://juejin.cn/post/6921869301934882823">https://juejin.cn/post/6921869301934882823</a> | VUE单元测试&ndash;终点
<a href="https://juejin.cn/post/6906295144505409549">https://juejin.cn/post/6906295144505409549</a> | VUE单元测试&ndash;开启测试之旅
<a href="https://juejin.cn/post/6844903941650513934">https://juejin.cn/post/6844903941650513934</a> | vue的自动化测试详解
<a href="https://juejin.cn/post/6844903966795366407">https://juejin.cn/post/6844903966795366407</a> | UI组件库从1到N开发心得-单元测试篇
<a href="https://juejin.cn/post/6844904084106018823">https://juejin.cn/post/6844904084106018823</a> | Vue - 单元测试
<a href="https://juejin.cn/post/6844903936038551565">https://juejin.cn/post/6844903936038551565</a> | 使用Jest对Vue进行单元测试
<a href="https://juejin.cn/post/6865477717220851720">https://juejin.cn/post/6865477717220851720</a> | 学习Vue应用测试，让你的项目更加健壮和稳定
<a href="https://juejin.cn/post/6844904015436709902">https://juejin.cn/post/6844904015436709902</a> | [译] Vue 3 Composition API 之单元测试
<a href="https://juejin.cn/post/6844903701778268168">https://juejin.cn/post/6844903701778268168</a> | 基于VUE移动端UI好用框架
<a href="https://juejin.cn/post/6844903878077464590">https://juejin.cn/post/6844903878077464590</a> | 单元测试框架Jest
<a href="https://juejin.cn/post/6854573221744738312">https://juejin.cn/post/6854573221744738312</a> | 使用Jest实现Vue自动化测试
<a href="https://juejin.cn/post/6844904057094537229">https://juejin.cn/post/6844904057094537229</a> | Vue 组件单元测试究竟测试什么？
<a href="https://juejin.cn/post/6844903494042779662">https://juejin.cn/post/6844903494042779662</a> | 前端每周清单第 29 期：Web 现状分析与优化策略、Vue 单元测试、Headless Chrome 爬虫
<a href="https://juejin.cn/post/6844904160136003592">https://juejin.cn/post/6844904160136003592</a> | 使用 Karma + Mocha做单元测试
<a href="https://juejin.cn/post/6844904053340635143">https://juejin.cn/post/6844904053340635143</a> | toast组件单元测试
<a href="https://juejin.cn/post/6844904202062299144">https://juejin.cn/post/6844904202062299144</a> | 基于Vue2.6搭建UI组件库+VuePress搭建文档
<a href="https://juejin.cn/post/6844903844401381390">https://juejin.cn/post/6844903844401381390</a> | 单元测试规范
<a href="https://zhuanlan.zhihu.com/p/48365663">https://zhuanlan.zhihu.com/p/48365663</a> | Vue 应用单元测试的策略与实践 04 - Vuex 单元测试 - 知乎
<a href="https://juejin.cn/post/6844903698431213582">https://juejin.cn/post/6844903698431213582</a> | 实例入门 Vue.js 单元测试</p>
<hr>
<p><a href="https://juejin.cn/post/6844903885652377614">https://juejin.cn/post/6844903885652377614</a> | 有赞前端质量保障体系
<a href="https://juejin.cn/post/6920154021911396359">https://juejin.cn/post/6920154021911396359</a> | 测试工具比较：选Jest，不选Mocha
<a href="https://juejin.cn/post/6983672477977149448">https://juejin.cn/post/6983672477977149448</a> | jest.useFakeTimers 后，setTimeout 还是宏任务么？
<a href="https://juejin.cn/post/6974673792748486693">https://juejin.cn/post/6974673792748486693</a> | 前端自动化测试-Jest 快速入门
<a href="https://juejin.cn/post/6940890530481963022">https://juejin.cn/post/6940890530481963022</a> | 手摸手带你走入前端单元测试
<a href="https://juejin.cn/post/6931301450316251150">https://juejin.cn/post/6931301450316251150</a> | Jest 前端自动化测试基础 (二)异步代码测试
<a href="https://juejin.cn/post/6844903630177320973">https://juejin.cn/post/6844903630177320973</a> | 浅谈前端测试
<a href="https://juejin.cn/post/6844903831659085837">https://juejin.cn/post/6844903831659085837</a> | 一次学会使用 mocha &amp; jest 编写单元测试
<a href="https://juejin.cn/post/6844904009887645709">https://juejin.cn/post/6844904009887645709</a> | JS测试框架Jest/Mocha/Ava的简单比较
<a href="https://juejin.cn/post/6844904114753634317">https://juejin.cn/post/6844904114753634317</a> | Jest前端自动化测试入门
<a href="https://juejin.cn/post/6844903489030586376">https://juejin.cn/post/6844903489030586376</a> | 前端测试框架 Jest
<a href="https://juejin.cn/post/6844904194600599560">https://juejin.cn/post/6844904194600599560</a> | 试试前端自动化测试！（基础篇）
<a href="https://juejin.cn/post/6844903565345980429">https://juejin.cn/post/6844903565345980429</a> | 使用Jest对原生TypeScript 项目进行UI测试
<a href="https://juejin.cn/post/6981360058156187661">https://juejin.cn/post/6981360058156187661</a> | 如何使用Jest做单元测试
<a href="https://juejin.cn/post/6844903934906089480">https://juejin.cn/post/6844903934906089480</a> | Mocha js官方文档翻译 —— 简单、灵活、有趣
<a href="https://juejin.cn/post/6844904127147802632">https://juejin.cn/post/6844904127147802632</a> | 前端单元测试-mocha
<a href="https://juejin.cn/post/6935246645323890724">https://juejin.cn/post/6935246645323890724</a> | 前端单元测试技术方案总结
<a href="https://juejin.cn/post/6844903847874265101">https://juejin.cn/post/6844903847874265101</a> | 面试官(6): 写过『通用前端组件』吗?
<a href="https://juejin.cn/post/6844904020910276616">https://juejin.cn/post/6844904020910276616</a> | 使用 mocha 进行前端单元测试
<a href="https://juejin.cn/post/6844903705712525320">https://juejin.cn/post/6844903705712525320</a> | 前端单元测试之Jest</p>
<hr>
<hr>

    </div>

    
    
<div class="post-copyright">
  <p class="copyright-item">
    <span class="item-title">文章作者</span>
    <span class="item-content">Joel Xu</span>
  </p>
  <p class="copyright-item">
    <span class="item-title">上次更新</span>
    <span class="item-content">
      2022-09-03
      
        
        
      
    </span>
  </p>
  
  <p class="copyright-item">
    <span class="item-title">许可协议</span>
    <span class="item-content"><a rel="license noopener" href="https://creativecommons.org/licenses/by-nc-nd/4.0/" target="_blank">CC BY-NC-ND 4.0</a></span>
  </p>
</div>


    
    

    <footer class="post-footer">
      <div class="post-tags">
          <a href="http://xmasuhai.xyz/tags/frontend/">FrontEnd</a>
          <a href="http://xmasuhai.xyz/tags/project/">Project</a>
          <a href="http://xmasuhai.xyz/tags/vueel/">vueel</a>
          <a href="http://xmasuhai.xyz/tags/vue2/">vue2</a>
          
        </div>

      
      <nav class="post-nav">
        
          <a class="prev" href="/post/project/money/%E9%A1%B9%E7%9B%AE-%E5%96%B5%E5%86%85%E8%AE%B0%E8%B4%A6-meoney-08%E5%8A%9F%E8%83%BD%E6%89%A9%E5%B1%95%E5%8C%85-dlc-sessionstorage-%E9%A1%B5%E9%9D%A2%E4%BC%9A%E8%AF%9D%E4%BF%9D%E5%AD%98&#43;%E8%B7%AF%E7%94%B1%E5%AE%88%E5%8D%AB/">
            
            <i class="iconfont">
              <svg  class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="18" height="18">
  <path d="M691.908486 949.511495l75.369571-89.491197c10.963703-12.998035 10.285251-32.864502-1.499144-44.378743L479.499795 515.267417 757.434875 204.940602c11.338233-12.190647 11.035334-32.285311-0.638543-44.850487l-80.46666-86.564541c-11.680017-12.583596-30.356378-12.893658-41.662889-0.716314L257.233596 494.235404c-11.332093 12.183484-11.041474 32.266891 0.657986 44.844348l80.46666 86.564541c1.772366 1.910513 3.706415 3.533476 5.750981 4.877077l306.620399 321.703933C662.505829 963.726242 680.945807 962.528973 691.908486 949.511495z"></path>
</svg>

            </i>
            <span class="prev-text nav-default">【项目 喵内记账 Meoney 08】功能扩展包 DLC SessionStorage 页面会话保存&#43;路由守卫</span>
            <span class="prev-text nav-mobile">上一篇</span>
          </a>
        
          <a class="next" href="/post/project/money/%E9%A1%B9%E7%9B%AE-%E5%96%B5%E5%86%85%E8%AE%B0%E8%B4%A6-meoney-07%E5%8A%9F%E8%83%BD%E6%89%A9%E5%B1%95%E5%8C%85-dlc-%E4%BD%BF%E7%94%A8%E7%BB%9F%E8%AE%A1%E5%9B%BE%E8%A1%A8-echarts/">
            <span class="next-text nav-default">【项目 喵内记账 Meoney 07】功能扩展包 DLC-使用统计图表 echarts</span>
            <span class="prev-text nav-mobile">下一篇</span>
            
            <i class="iconfont">
              <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="18" height="18">
  <path d="M332.091514 74.487481l-75.369571 89.491197c-10.963703 12.998035-10.285251 32.864502 1.499144 44.378743l286.278095 300.375162L266.565125 819.058374c-11.338233 12.190647-11.035334 32.285311 0.638543 44.850487l80.46666 86.564541c11.680017 12.583596 30.356378 12.893658 41.662889 0.716314l377.434212-421.426145c11.332093-12.183484 11.041474-32.266891-0.657986-44.844348l-80.46666-86.564541c-1.772366-1.910513-3.706415-3.533476-5.750981-4.877077L373.270379 71.774697C361.493148 60.273758 343.054193 61.470003 332.091514 74.487481z"></path>
</svg>

            </i>
          </a>
      </nav>
    </footer>
  </article>

  
  
  
  

  
  

  

  
  

  

  

  

    

  

        </div>
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="icon-links">
  
  
    <a href="mailto:xmasuhai@163.com" rel="me noopener" class="iconfont"
      title="email" >
      <svg class="icon" viewBox="0 0 1451 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="36" height="36">
  <path d="M664.781909 681.472759 0 97.881301C0 3.997201 71.046997 0 71.046997 0L474.477909 0 961.649408 0 1361.641813 0C1361.641813 0 1432.688811 3.997201 1432.688811 97.881301L771.345323 681.472759C771.345323 681.472759 764.482731 685.154773 753.594283 688.65053L753.594283 688.664858C741.602731 693.493018 729.424896 695.068979 718.077952 694.839748 706.731093 695.068979 694.553173 693.493018 682.561621 688.664858L682.561621 688.65053C671.644501 685.140446 664.781909 681.472759 664.781909 681.472759L664.781909 681.472759ZM718.063616 811.603883C693.779541 811.016482 658.879232 802.205449 619.10784 767.734955 542.989056 701.759633 0 212.052267 0 212.052267L0 942.809523C0 942.809523 0 1024 83.726336 1024L682.532949 1024 753.579947 1024 1348.948139 1024C1432.688811 1024 1432.688811 942.809523 1432.688811 942.809523L1432.688811 212.052267C1432.688811 212.052267 893.138176 701.759633 817.019477 767.734955 777.248 802.205449 742.347691 811.03081 718.063616 811.603883L718.063616 811.603883Z"></path>
</svg>

    </a>
  
    <a href="https://github.com/xmasuhai" rel="me noopener" class="iconfont"
      title="github"  target="_blank"
      >
      <svg class="icon" style="" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="36" height="36">
  <path d="M512 12.672c-282.88 0-512 229.248-512 512 0 226.261333 146.688 418.133333 350.08 485.76 25.6 4.821333 34.986667-11.008 34.986667-24.618667 0-12.16-0.426667-44.373333-0.64-87.04-142.421333 30.890667-172.458667-68.693333-172.458667-68.693333C188.672 770.986667 155.008 755.2 155.008 755.2c-46.378667-31.744 3.584-31.104 3.584-31.104 51.413333 3.584 78.421333 52.736 78.421333 52.736 45.653333 78.293333 119.850667 55.68 149.12 42.581333 4.608-33.109333 17.792-55.68 32.426667-68.48-113.706667-12.8-233.216-56.832-233.216-253.013333 0-55.893333 19.84-101.546667 52.693333-137.386667-5.76-12.928-23.04-64.981333 4.48-135.509333 0 0 42.88-13.738667 140.8 52.48 40.96-11.392 84.48-17.024 128-17.28 43.52 0.256 87.04 5.888 128 17.28 97.28-66.218667 140.16-52.48 140.16-52.48 27.52 70.528 10.24 122.581333 5.12 135.509333 32.64 35.84 52.48 81.493333 52.48 137.386667 0 196.693333-119.68 240-233.6 252.586667 17.92 15.36 34.56 46.762667 34.56 94.72 0 68.522667-0.64 123.562667-0.64 140.202666 0 13.44 8.96 29.44 35.2 24.32C877.44 942.592 1024 750.592 1024 524.672c0-282.752-229.248-512-512-512"></path>
</svg>

    </a>
  
    <a href="https://www.zhihu.com/people/xue-shou-41/posts" rel="me noopener" class="iconfont"
      title="zhihu"  target="_blank"
      >
      <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="36" height="36">
  <path d="M351.791182 562.469462l192.945407 0c0-45.367257-21.3871-71.939449-21.3871-71.939449L355.897709 490.530013c3.977591-82.182744 7.541767-187.659007 8.816806-226.835262l159.282726 0c0 0-0.86367-67.402109-18.578124-67.402109s-279.979646 0-279.979646 0 16.850783-88.141456 39.318494-127.053698c0 0-83.60514-4.510734-112.121614 106.962104S81.344656 355.077018 76.80834 367.390461c-4.536316 12.313443 24.62791 5.832845 36.941354 0 12.313443-5.832845 68.050885-25.924439 84.252893-103.69571l86.570681 0c1.165546 49.28652 4.596691 200.335724 3.515057 226.835262L109.86113 490.530013c-25.275663 18.147312-33.701566 71.939449-33.701566 71.939449L279.868105 562.469462c-8.497535 56.255235-23.417339 128.763642-44.275389 167.210279-33.05279 60.921511-50.55235 116.65793-169.802314 212.576513 0 0-19.442818 14.257725 40.829917 9.073656 60.273758-5.185093 117.305683-20.739347 156.840094-99.807147 20.553105-41.107233 41.805128-93.250824 58.386782-146.138358l-0.055259 0.185218 167.855986 193.263655c0 0 22.035876-51.847855 5.832845-108.880803L371.045711 650.610918l-42.1244 31.157627-0.045025 0.151449c11.69946-41.020252 20.11206-81.5749 22.726607-116.858498C351.665315 564.212152 351.72876 563.345412 351.791182 562.469462z"></path>
  <path d="M584.918753 182.033893l0 668.840094 70.318532 0 28.807093 80.512708 121.875768-80.512708 153.600307 0L959.520453 182.033893 584.918753 182.033893zM887.150192 778.934538l-79.837326 0-99.578949 65.782216-23.537066-65.782216-24.855084 0L659.341766 256.673847l227.807403 0L887.149169 778.934538z"></path>
</svg>

    </a>


<a href="http://xmasuhai.xyz/index.xml" rel="noopener alternate" type="application/rss&#43;xml"
    class="iconfont" title="rss" target="_blank">
    <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="30" height="30">
  <path d="M819.157333 1024C819.157333 574.592 449.408 204.8 0 204.8V0c561.706667 0 1024 462.293333 1024 1024h-204.842667zM140.416 743.04a140.8 140.8 0 0 1 140.501333 140.586667A140.928 140.928 0 0 1 140.074667 1024C62.72 1024 0 961.109333 0 883.626667s62.933333-140.544 140.416-140.586667zM678.784 1024h-199.04c0-263.210667-216.533333-479.786667-479.744-479.786667V345.173333c372.352 0 678.784 306.517333 678.784 678.826667z"></path>
</svg>

  </a>
   
</div>

<div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://gohugo.io">Hugo</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Theme - <a class="theme-link" href="https://github.com/xianmin/hugo-theme-jane">Jane</a>
  </span>

  <span class="copyright-year">
    &copy;
    
      2019 -
    2022
    <span class="heart">
      
      <i class="iconfont">
        <svg class="icon" viewBox="0 0 1025 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="14" height="14">
  <path d="M1000.1 247.9c-15.5-37.3-37.6-70.6-65.7-98.9-54.4-54.8-125.8-85-201-85-85.7 0-166 39-221.4 107.4C456.6 103 376.3 64 290.6 64c-75.1 0-146.5 30.4-201.1 85.6-28.2 28.5-50.4 61.9-65.8 99.3-16 38.8-24 79.9-23.6 122.2 0.7 91.7 40.1 177.2 108.1 234.8 3.1 2.6 6 5.1 8.9 7.8 14.9 13.4 58 52.8 112.6 102.7 93.5 85.5 209.9 191.9 257.5 234.2 7 6.1 15.8 9.5 24.9 9.5 9.2 0 18.1-3.4 24.9-9.5 34.5-30.7 105.8-95.9 181.4-165 74.2-67.8 150.9-138 195.8-178.2 69.5-57.9 109.6-144.4 109.9-237.3 0.1-42.5-8-83.6-24-122.2z"
   fill="#8a8a8a"></path>
</svg>

      </i>
    </span><span class="author">
        Joel Xu
        
      </span></span>

  
  

  
</div>

    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont">
        
        <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="35" height="35">
  <path d="M510.866688 227.694839 95.449397 629.218702l235.761562 0-2.057869 328.796468 362.40389 0L691.55698 628.188232l241.942331-3.089361L510.866688 227.694839zM63.840492 63.962777l894.052392 0 0 131.813095L63.840492 195.775872 63.840492 63.962777 63.840492 63.962777zM63.840492 63.962777"></path>
</svg>

      </i>
    </div>
  </div>
  
<script type="text/javascript" src="/lib/jquery/jquery-3.2.1.min.js"></script>
  <script type="text/javascript" src="/lib/slideout/slideout-1.0.1.min.js"></script>




<script type="text/javascript" src="/js/main.638251f4230630f0335d8c6748e53a96f94b72670920b60c09a56fdc8bece214.js" integrity="sha256-Y4JR9CMGMPAzXYxnSOU6lvlLcmcJILYMCaVv3Ivs4hQ=" crossorigin="anonymous"></script>












  
    <script type="text/javascript" src="/js/load-photoswipe.js"></script>
    <script type="text/javascript" src="/lib/photoswipe/photoswipe.min.js"></script>
    <script type="text/javascript" src="/lib/photoswipe/photoswipe-ui-default.min.js"></script>
  















</body>
</html>
