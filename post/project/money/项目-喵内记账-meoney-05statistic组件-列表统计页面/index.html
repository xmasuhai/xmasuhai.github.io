<!DOCTYPE html>
<html lang="zh-cn" itemscope itemtype="http://schema.org/WebPage">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>【项目 喵内记账 Meoney 05】Statistic组件 列表统计页面 - Joel in The House</title>
  

<meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=yes"/>

<meta name="MobileOptimized" content="width"/>
<meta name="HandheldFriendly" content="true"/>


<meta name="applicable-device" content="pc,mobile">

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">

<meta name="mobile-web-app-capable" content="yes">

<meta name="author" content="Joel Xu" />
  <meta name="description" content="【项目-喵内记账-meoney-05】Statistic.vue 组件 列表统计页面 -标记问题 大纲链接§ [toc] 知识概要 封装 Tabs，使用 deep 语法 用 JS 配" />

  <meta name="keywords" content="Hugo, theme, jane" />






<meta name="generator" content="Hugo 0.91.2" />


<link rel="canonical" href="http://xmasuhai.xyz/post/project/money/%E9%A1%B9%E7%9B%AE-%E5%96%B5%E5%86%85%E8%AE%B0%E8%B4%A6-meoney-05statistic%E7%BB%84%E4%BB%B6-%E5%88%97%E8%A1%A8%E7%BB%9F%E8%AE%A1%E9%A1%B5%E9%9D%A2/" />





<link rel="icon" href="/favicon.ico" />











<link rel="stylesheet" href="/sass/jane.min.af20b78e95c84de86b00a0242a4a77bd2601700e1b250edf27537d957ac0041d.css" integrity="sha256-ryC3jpXITehrAKAkKkp3vSYBcA4bJQ7fJ1N9lXrABB0=" media="screen" crossorigin="anonymous">





<meta property="og:title" content="【项目 喵内记账 Meoney 05】Statistic组件 列表统计页面" />
<meta property="og:description" content="【项目-喵内记账-meoney-05】Statistic.vue 组件 列表统计页面 -标记问题 大纲链接§ [toc] 知识概要 封装 Tabs，使用 deep 语法 用 JS 配" />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://xmasuhai.xyz/post/project/money/%E9%A1%B9%E7%9B%AE-%E5%96%B5%E5%86%85%E8%AE%B0%E8%B4%A6-meoney-05statistic%E7%BB%84%E4%BB%B6-%E5%88%97%E8%A1%A8%E7%BB%9F%E8%AE%A1%E9%A1%B5%E9%9D%A2/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2021-11-27T12:09:26+08:00" />
<meta property="article:modified_time" content="2021-11-27T12:11:59+08:00" />

<meta itemprop="name" content="【项目 喵内记账 Meoney 05】Statistic组件 列表统计页面">
<meta itemprop="description" content="【项目-喵内记账-meoney-05】Statistic.vue 组件 列表统计页面 -标记问题 大纲链接§ [toc] 知识概要 封装 Tabs，使用 deep 语法 用 JS 配"><meta itemprop="datePublished" content="2021-11-27T12:09:26+08:00" />
<meta itemprop="dateModified" content="2021-11-27T12:11:59+08:00" />
<meta itemprop="wordCount" content="15265">
<meta itemprop="keywords" content="FrontEnd,Project,money," /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="【项目 喵内记账 Meoney 05】Statistic组件 列表统计页面"/>
<meta name="twitter:description" content="【项目-喵内记账-meoney-05】Statistic.vue 组件 列表统计页面 -标记问题 大纲链接§ [toc] 知识概要 封装 Tabs，使用 deep 语法 用 JS 配"/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->




</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">Joel in The House</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="http://xmasuhai.xyz/">主页</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="http://xmasuhai.xyz/post/">文档</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="http://xmasuhai.xyz/tags/">标签</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="http://xmasuhai.xyz/categories/">目录</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="http://xmasuhai.xyz/about/">关于我</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          <div class="mobile-menu-parent">
            <span class="mobile-submenu-open"></span>
            <a href="http://xmasuhai.xyz/">
              docs
            </a>
          </div>
          <ul class="mobile-submenu-list">
            
              <li>
                <a href="http://xmasuhai.xyz/post/test/syntax-highlighting/">Syntax Highlighting</a>
              </li>
            
              <li>
                <a href="http://xmasuhai.xyz/post/test/mytest/">my Syntax Highlighting &amp; ShortCode Test</a>
              </li>
            
          </ul>
        
      </li>
    

    
  </ul>
</nav>


  
    






  <link rel="stylesheet" href="/lib/photoswipe/photoswipe.min.css" />
  <link rel="stylesheet" href="/lib/photoswipe/default-skin/default-skin.min.css" />




<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

<div class="pswp__bg"></div>

<div class="pswp__scroll-wrap">
    
    <div class="pswp__container">
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
    </div>
    
    <div class="pswp__ui pswp__ui--hidden">
    <div class="pswp__top-bar">
      
      <div class="pswp__counter"></div>
      <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
      <button class="pswp__button pswp__button--share" title="Share"></button>
      <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
      <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
      
      
      <div class="pswp__preloader">
        <div class="pswp__preloader__icn">
          <div class="pswp__preloader__cut">
            <div class="pswp__preloader__donut"></div>
          </div>
        </div>
      </div>
    </div>
    <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
      <div class="pswp__share-tooltip"></div>
    </div>
    <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
    </button>
    <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
    </button>
    <div class="pswp__caption">
      <div class="pswp__caption__center"></div>
    </div>
    </div>
    </div>
</div>

  

  

  

  <header id="header" class="header container">
    <div class="logo-wrapper">
  <a href="/" class="logo">
    
      Joel in The House
    
  </a>
</div>

<nav class="site-navbar">
  <ul id="menu" class="menu">
    
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="http://xmasuhai.xyz/">主页</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="http://xmasuhai.xyz/post/">文档</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="http://xmasuhai.xyz/tags/">标签</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="http://xmasuhai.xyz/categories/">目录</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="http://xmasuhai.xyz/about/">关于我</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          <a class="menu-item-link menu-parent" href="http://xmasuhai.xyz/">docs</a>
          <ul class="submenu">
            
              <li>
                <a href="http://xmasuhai.xyz/post/test/syntax-highlighting/">Syntax Highlighting</a>
              </li>
            
              <li>
                <a href="http://xmasuhai.xyz/post/test/mytest/">my Syntax Highlighting &amp; ShortCode Test</a>
              </li>
            
          </ul>

        

      </li>
    

    
    

    
  </ul>
</nav>

  </header>

  <div id="mobile-panel">
    <main id="main" class="main bg-llight">
      <div class="content-wrapper">
        <div id="content" class="content container">
          <article class="post bg-white">
    
    <header class="post-header">
      <h1 class="post-title">【项目 喵内记账 Meoney 05】Statistic组件 列表统计页面</h1>
      
      <div class="post-meta">
        <time datetime="2021-11-27" class="post-time">
          2021-11-27
        </time>
        <div class="post-category">
            <a href="http://xmasuhai.xyz/categories/frontend/"> FrontEnd </a>
            <a href="http://xmasuhai.xyz/categories/project/"> Project </a>
            <a href="http://xmasuhai.xyz/categories/money/"> money </a>
            
          </div>
        <span class="more-meta"> 约 15265 字 </span>
          <span class="more-meta"> 预计阅读 31 分钟 </span>

        
        

        
        
      </div>
    </header>

    
    
<div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">文章目录</h2>
  <div class="post-toc-content">
    <nav id="TableOfContents">
  <ul>
    <li><a href="#封装-tabsvue">封装 <code>Tabs.vue</code></a>
      <ul>
        <li><a href="#重构typesvue-样式使用-深度作用选择器-deep-语法">重构<code>Types.vue</code> 样式，使用 <em><strong>深度作用选择器 <code>deep</code></strong></em> 语法</a></li>
        <li><a href="#最佳实践精准控制组件内部结构的样式">最佳实践：精准控制组件内部结构的样式</a></li>
        <li><a href="#抽离typesvue为tabsvue组件">抽离<code>Types.vue</code>为<code>Tabs.vue</code>组件</a></li>
      </ul>
    </li>
    <li><a href="#用-ts-配置组件默认-height">用 TS 配置组件默认 height</a></li>
    <li><a href="#用列表展示数据">用列表展示数据</a>
      <ul>
        <li><a href="#结构">结构</a></li>
        <li><a href="#步骤">步骤</a></li>
        <li><a href="#隐藏的bug">隐藏的bug</a></li>
        <li><a href="#使用计算属性computed操作展示数据">使用计算属性<code>computed</code>操作展示数据</a></li>
        <li><a href="#循环渲染">循环渲染</a></li>
      </ul>
    </li>
    <li><a href="#完善并添加statisticvue-scss">完善并添加<code>Statistic.vue</code> SCSS</a></li>
    <li><a href="#iso8601-和-dayjs"><code>ISO8601</code> 和 <code>dayjs</code></a></li>
    <li><a href="#模块化状态管理">模块化状态管理</a></li>
    <li><a href="#数据排序计数排序的变形">数据排序（计数排序的变形）</a></li>
    <li><a href="#数据排序后分组">数据排序后分组</a></li>
    <li><a href="#完成统计页面">完成统计页面</a>
      <ul>
        <li><a href="#区分-支出和收入">区分 支出和收入</a></li>
        <li><a href="#显示总额">显示总额</a></li>
      </ul>
    </li>
    <li><a href="#一些-bug">一些 bug</a></li>
    <li><a href="#createdat-of-undefined-的解决办法">createdAt of undefined 的解决办法</a></li>
  </ul>
</nav>
  </div>
</div>

    
    <div class="post-content">
      <h1 id="项目-喵内记账-meoney-05statisticvue-组件-列表统计页面--标记问题">【项目-喵内记账-meoney-05】Statistic.vue 组件 列表统计页面 -标记问题</h1>
<blockquote>
<p>大纲链接<!-- raw HTML omitted --> § <!-- raw HTML omitted --></p>
</blockquote>
<p>[toc]</p>
<hr>
<blockquote>
<p>知识概要</p>
</blockquote>
<ul>
<li>封装 Tabs，使用 deep 语法</li>
<li>用 JS 配置 height</li>
<li>用列表展示数据</li>
<li>添加 <code>Statistic.vue</code> SCSS</li>
<li><code>ISO8601</code> 和 <code>dayjs</code></li>
<li>数据排序</li>
<li>数据排序后分组</li>
<li>完成统计页面</li>
<li><code>createdAt of undefined</code> 的解决办法</li>
</ul>
<hr>
<h2 id="封装-tabsvue">封装 <code>Tabs.vue</code></h2>
<h3 id="重构typesvue-样式使用-深度作用选择器-deep-语法">重构<code>Types.vue</code> 样式，使用 <em><strong>深度作用选择器 <code>deep</code></strong></em> 语法</h3>
<blockquote>
<p>查看<a href="https://www.figma.com/file/tmhv8PGGhSlcgkGrKYGgeL/%E7%8C%AB%E5%86%85%E8%AE%B0%E8%B4%A6-%E6%9C%AC%E5%9C%B0%E7%89%88-Copy?node-id=0%3A1"><code>Statistic.vue</code>结构</a>， 可复用<code>Types.vue</code>组件</p>
</blockquote>
<ul>
<li>注意样式加了<code>scoped</code>属性，只影响当前组件的标签，不会深入组件标签继续影响内部结构
<ul>
<li>组件<code>&lt;Type class=&quot;x&quot;/&gt;</code>d的样式只是加在表层的<code>&lt;div&gt;</code>上</li>
<li>即使写了<code>.x li {...;}</code>的样式，不对内部<code>&lt;li&gt;</code>有任何影响</li>
</ul>
</li>
<li>可以在不污染其他组件样式的同时，使用<code>/deep/</code>或<code>::v-deep</code>（SCSS）可以深入影响内部结构的样式</li>
<li>搜索<code>site: vuejs.org deep</code>: <a href="https://vue-loader.vuejs.org/zh/guide/scoped-css.html"><code>Scoped CSS 深度作用选择器 deep</code> 语法</a></li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-vue" data-lang="vue"><span class="p">&lt;</span><span class="nt">style</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;css&#34;</span> <span class="na">scoped</span><span class="p">&gt;</span>
<span class="p">.</span><span class="nx">x</span> <span class="o">/</span><span class="nx">deep</span><span class="o">/</span> <span class="nx">li</span> <span class="p">{</span>
  <span class="nx">border</span><span class="o">:</span> <span class="mi">1</span><span class="nx">px</span> <span class="nx">solid</span> <span class="nx">red</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">&lt;/</span><span class="nt">style</span><span class="p">&gt;</span>

<span class="p">&lt;</span><span class="nt">style</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;scss&#34;</span> <span class="na">scoped</span><span class="p">&gt;</span>
<span class="p">.</span><span class="nx">x</span> <span class="o">::</span><span class="nx">v</span><span class="o">-</span><span class="nx">deep</span> <span class="nx">li</span> <span class="p">{</span>
  <span class="nx">border</span><span class="o">:</span> <span class="mi">1</span><span class="nx">px</span> <span class="nx">solid</span> <span class="nx">red</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">&lt;/</span><span class="nt">style</span><span class="p">&gt;</span>

</code></pre></td></tr></table>
</div>
</div><blockquote>
<p><code>Statistic.vue</code>中，在<code>&lt;Type/&gt;</code>上，对<code>Types.vue</code>组件传入绑定属性<code>:type.sync=&quot;yyy&quot;</code></p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-vue" data-lang="vue"><span class="p">&lt;</span><span class="nt">template</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">Layout</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">Types</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;x&#34;</span> <span class="nt">:type.sync</span><span class="s">=&#34;yyy&#34;</span><span class="p">/&gt;</span>
  <span class="p">&lt;/</span><span class="nt">Layout</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">template</span><span class="p">&gt;</span>

<span class="p">&lt;</span><span class="nt">script</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;ts&#34;</span><span class="p">&gt;</span>
<span class="kr">import</span> <span class="nx">Vue</span> <span class="nx">from</span> <span class="s1">&#39;vue&#39;</span><span class="p">;</span>
<span class="kr">import</span> <span class="p">{</span><span class="nx">Component</span><span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;vue-property-decorator&#39;</span><span class="p">;</span>
<span class="kr">import</span> <span class="nx">Types</span> <span class="nx">from</span> <span class="s1">&#39;@/components/Money/Types.vue&#39;</span><span class="p">;</span>

<span class="err">@</span><span class="nx">Component</span><span class="p">({</span>
  <span class="nx">components</span><span class="o">:</span> <span class="p">{</span><span class="nx">Types</span><span class="p">}</span>
<span class="p">})</span>
<span class="kr">export</span> <span class="k">default</span> <span class="kr">class</span> <span class="nx">Statistics</span> <span class="kr">extends</span> <span class="nx">Vue</span> <span class="p">{</span>
  <span class="nx">yyy</span> <span class="o">=</span> <span class="s1">&#39;-&#39;</span><span class="p">;</span>
<span class="p">}</span>
<span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>

</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>深度作用选择器 选中的样式<code>&amp;.selected {}</code></p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-vue" data-lang="vue"><span class="p">&lt;</span><span class="nt">style</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;scss&#34;</span> <span class="na">scoped</span><span class="p">&gt;</span>
<span class="p">.</span><span class="nx">x</span> <span class="o">::</span><span class="nx">v</span><span class="o">-</span><span class="nx">deep</span> <span class="nx">li</span> <span class="p">{</span>
  <span class="nx">background</span><span class="o">:</span> <span class="err">#</span><span class="nx">fff</span><span class="p">;</span>
  <span class="o">&amp;</span><span class="p">.</span><span class="nx">selected</span> <span class="p">{</span>
    <span class="nx">background</span><span class="o">:</span> <span class="err">#</span><span class="nx">c4c4c4</span><span class="p">;</span>
    <span class="o">&amp;::</span><span class="nx">after</span> <span class="p">{</span>
      <span class="nx">display</span><span class="o">:</span> <span class="nx">none</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">&lt;/</span><span class="nt">style</span><span class="p">&gt;</span>

</code></pre></td></tr></table>
</div>
</div><hr>
<blockquote>
<p>还有一个缺点，就是如果多层嵌套，无法通过类选择器精确/动态控制样式</p>
</blockquote>
<h3 id="最佳实践精准控制组件内部结构的样式">最佳实践：精准控制组件内部结构的样式</h3>
<blockquote>
<p>使用 <strong>对象控制绑定的样式（表驱动）</strong> 和 <strong>动态前缀</strong> 来控制组件内部标签的样式</p>
</blockquote>
<ul>
<li><a href="https://cn.vuejs.org/v2/guide/class-and-style.html">Class 与 Style 绑定</a></li>
<li>从父组件传一个前缀字符串到子组件，由各不同子组件去拼接，就可实现精确/动态控制样式</li>
<li>在<code>Types.vue</code>添加外部数据：属性前缀<code>class-prefix</code>
<ul>
<li>注意写清外部数据类型：<code>@Prop(String) readonly classPrefix?: string;</code></li>
<li>注意数据由于是外部传来的，无法指定初始化类型，强行指定类型<code>!:</code>或者可选<code>?:</code></li>
</ul>
</li>
<li>用对象的形式赋值给绑定的类属性<code>:class=&quot;{selectorA: true, selectorB: false, selectorC: expressions, active: isActive}&quot;</code>
<ul>
<li>当对象的属性值（一般是表达式）为<code>true</code>时，属性（键）对应的类选择器生效</li>
<li>官方解释：<code>active</code> 这个 <code>class</code> 存在与否将取决于数据 <code>property</code> <code>isActive</code> 的 <code>truthiness</code></li>
<li>可绑定多个选择器</li>
<li>可以与普通的 class attribute 共存：<code>&lt;div class=&quot;static active&quot;&gt;&lt;/div&gt;</code></li>
<li>动态地切换 <code>class</code>：当 <code>isActive</code> 变化时，class 列表将相应地更新
<ul>
<li>当<code>isActive: true</code>，class 列表将变为 <code>class=&quot;static active&quot;</code></li>
</ul>
</li>
</ul>
</li>
<li>动态属性前缀<code>&lt;li :class=&quot;{[classPrefix + '-item']: classPrefix, selected: value==='-'}&quot;&gt;</code>
<ul>
<li>如果<code>key</code>里有变量，使用ES6对象动态属性 <code>{[xxx]: 'yyy'}</code></li>
<li>使用（表达式）作为对象的属性名，即把表达式放在方括号内</li>
<li>还可以拼接字符串：<code>{[classPrefix + '-item']: classPrefix}</code></li>
</ul>
</li>
<li>表驱动：将所有类名以表的形式给出</li>
</ul>
<blockquote>
<p><code>Statistic.vue</code></p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-vue" data-lang="vue"><span class="p">&lt;</span><span class="nt">template</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">Layout</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;statistics&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">Types</span> <span class="na">class</span><span class="nt">-prefix</span><span class="err">=&#34;</span><span class="na">zzz</span><span class="err">&#34;</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;x&#34;</span> <span class="nt">:type.sync</span><span class="s">=&#34;yyy&#34;</span><span class="p">/&gt;</span>
  <span class="p">&lt;/</span><span class="nt">Layout</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">template</span><span class="p">&gt;</span>

<span class="p">&lt;</span><span class="nt">script</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;ts&#34;</span><span class="p">&gt;</span>
<span class="kr">import</span> <span class="nx">Vue</span> <span class="nx">from</span> <span class="s1">&#39;vue&#39;</span><span class="p">;</span>
<span class="kr">import</span> <span class="p">{</span><span class="nx">Component</span><span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;vue-property-decorator&#39;</span><span class="p">;</span>
<span class="kr">import</span> <span class="nx">Types</span> <span class="nx">from</span> <span class="s1">&#39;@/components/Money/Types.vue&#39;</span><span class="p">;</span>

<span class="err">@</span><span class="nx">Component</span><span class="p">({</span>
  <span class="nx">components</span><span class="o">:</span> <span class="p">{</span><span class="nx">Types</span><span class="p">}</span>
<span class="p">})</span>
<span class="kr">export</span> <span class="k">default</span> <span class="kr">class</span> <span class="nx">Statistics</span> <span class="kr">extends</span> <span class="nx">Vue</span> <span class="p">{</span>
  <span class="nx">yyy</span> <span class="o">=</span> <span class="s1">&#39;-&#39;</span><span class="p">;</span>
<span class="p">}</span>
<span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>

<span class="p">&lt;</span><span class="nt">style</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;scss&#34;</span> <span class="na">scoped</span><span class="p">&gt;</span>
<span class="p">.</span><span class="nx">statistics</span><span class="p">{</span>
  <span class="o">::</span><span class="nx">v</span><span class="o">-</span><span class="nx">deep</span> <span class="p">.</span><span class="nx">zzz</span><span class="o">-</span><span class="nx">item</span> <span class="p">{</span>
    <span class="nx">background</span><span class="o">:</span> <span class="err">#</span><span class="nx">fff</span><span class="p">;</span>
    <span class="o">&amp;</span><span class="p">.</span><span class="nx">selected</span> <span class="p">{</span>
      <span class="nx">background</span><span class="o">:</span> <span class="err">#</span><span class="nx">c4c4c4</span><span class="p">;</span>
      <span class="nx">border</span><span class="o">:</span> <span class="mi">1</span><span class="nx">px</span> <span class="nx">solid</span> <span class="nx">green</span><span class="p">;</span>
      <span class="o">&amp;::</span><span class="nx">after</span> <span class="p">{</span>
        <span class="nx">display</span><span class="o">:</span> <span class="nx">none</span><span class="p">;</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">&lt;/</span><span class="nt">style</span><span class="p">&gt;</span>

</code></pre></td></tr></table>
</div>
</div><blockquote>
<p><code>Type.vue</code></p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-vue" data-lang="vue"><span class="p">&lt;</span><span class="nt">template</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;div_types&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">ul</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;types&#34;</span><span class="p">&gt;</span>
      <span class="p">&lt;</span><span class="nt">li</span> <span class="o">:</span><span class="na">class</span><span class="o">=</span><span class="s">&#34;{selected: type===&#39;-&#39;, [classPrefix + &#39;-item&#39;]: classPrefix}&#34;</span> <span class="nt">@click</span><span class="s">=&#34;selectType(&#39;-&#39;)&#34;</span><span class="p">&gt;</span><span class="na">支出</span><span class="p">&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
      <span class="p">&lt;</span><span class="nt">li</span> <span class="o">:</span><span class="na">class</span><span class="o">=</span><span class="s">&#34;{selected: type===&#39;+&#39;, [classPrefix + &#39;-item&#39;]: classPrefix}&#34;</span> <span class="nt">@click</span><span class="s">=&#34;selectType(&#39;+&#39;)&#34;</span><span class="p">&gt;</span><span class="na">收入</span><span class="p">&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
    <span class="p">&lt;/</span><span class="nt">ul</span><span class="p">&gt;</span>
  <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">template</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">script</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;ts&#34;</span><span class="p">&gt;</span>
<span class="kr">import</span> <span class="nx">Vue</span> <span class="nx">from</span> <span class="s1">&#39;vue&#39;</span><span class="p">;</span>
<span class="kr">import</span> <span class="p">{</span><span class="nx">Component</span><span class="p">,</span> <span class="nx">Prop</span><span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;vue-property-decorator&#39;</span><span class="p">;</span>

<span class="err">@</span><span class="nx">Component</span>
<span class="kr">export</span> <span class="k">default</span> <span class="kr">class</span> <span class="nx">Types</span> <span class="kr">extends</span> <span class="nx">Vue</span> <span class="p">{</span>
  <span class="err">@</span><span class="nx">Prop</span><span class="p">(</span><span class="nb">String</span><span class="p">)</span> <span class="nx">readonly</span> <span class="nx">type</span><span class="o">!:</span> <span class="nx">string</span><span class="p">;</span>
  <span class="err">@</span><span class="nx">Prop</span><span class="p">(</span><span class="nb">String</span><span class="p">)</span> <span class="nx">readonly</span> <span class="nx">classPrefix</span><span class="o">?:</span> <span class="nx">string</span><span class="p">;</span>

  <span class="nx">selectType</span><span class="p">(</span><span class="nx">type</span><span class="o">:</span> <span class="nx">string</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">type</span> <span class="o">!==</span> <span class="s1">&#39;-&#39;</span> <span class="o">&amp;&amp;</span> <span class="nx">type</span> <span class="o">!==</span> <span class="s1">&#39;+&#39;</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s1">&#39;type is unknown&#39;</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">$emit</span><span class="p">(</span><span class="s1">&#39;update:type&#39;</span><span class="p">,</span> <span class="nx">type</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
<span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">style</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;scss&#34;</span> <span class="na">scoped</span><span class="p">&gt;</span>
<span class="err">@</span><span class="kr">import</span> <span class="s2">&#34;~@/assets/style/global.scss&#34;</span><span class="p">;</span>
<span class="p">.</span><span class="nx">types</span> <span class="p">{</span>
  <span class="nx">background</span><span class="o">:</span> <span class="err">#</span><span class="nx">c4c4c4</span><span class="p">;</span>
  <span class="nx">display</span><span class="o">:</span> <span class="nx">flex</span><span class="p">;</span>
  <span class="nx">text</span><span class="o">-</span><span class="nx">align</span><span class="o">:</span> <span class="nx">center</span><span class="p">;</span>
  <span class="o">&gt;</span> <span class="nx">li</span> <span class="p">{</span>
    <span class="nx">font</span><span class="o">-</span><span class="nx">size</span><span class="o">:</span> <span class="mi">24</span><span class="nx">px</span><span class="p">;</span>
    <span class="nx">width</span><span class="o">:</span> <span class="mi">50</span><span class="o">%</span><span class="p">;</span>
    <span class="nx">height</span><span class="o">:</span> <span class="mi">64</span><span class="nx">px</span><span class="p">;</span>
    <span class="nx">display</span><span class="o">:</span> <span class="nx">flex</span><span class="p">;</span>
    <span class="nx">justify</span><span class="o">-</span><span class="nx">content</span><span class="o">:</span> <span class="nx">center</span><span class="p">;</span>
    <span class="nx">align</span><span class="o">-</span><span class="nx">items</span><span class="o">:</span> <span class="nx">center</span><span class="p">;</span>
    <span class="nx">position</span><span class="o">:</span> <span class="nx">relative</span><span class="p">;</span>
    <span class="o">&amp;</span><span class="p">.</span><span class="nx">selected</span> <span class="p">{</span>
      <span class="nx">background</span><span class="o">:</span> <span class="err">#</span><span class="nx">c4c4c4</span><span class="p">;</span>
      <span class="o">&amp;::</span><span class="nx">after</span> <span class="p">{</span>
        <span class="nx">content</span><span class="o">:</span> <span class="s2">&#34;&#34;</span><span class="p">;</span>
        <span class="nx">display</span><span class="o">:</span> <span class="nx">block</span><span class="p">;</span>
        <span class="nx">position</span><span class="o">:</span> <span class="nx">absolute</span><span class="p">;</span>
        <span class="nx">bottom</span><span class="o">:</span> <span class="mi">0</span><span class="p">;</span>
        <span class="nx">left</span><span class="o">:</span> <span class="mi">0</span><span class="p">;</span>
        <span class="nx">width</span><span class="o">:</span> <span class="mi">100</span><span class="o">%</span><span class="p">;</span>
        <span class="nx">height</span><span class="o">:</span> <span class="mi">4</span><span class="nx">px</span><span class="p">;</span>
        <span class="nx">background</span><span class="o">:</span> <span class="err">#</span><span class="mi">333</span><span class="p">;</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">&lt;/</span><span class="nt">style</span><span class="p">&gt;</span>

</code></pre></td></tr></table>
</div>
</div><ul>
<li>可以用前缀精确地获取类名<code>zzz-item</code>，控制内部的元素</li>
<li>可以直接用深度作用选择器作为最外部选择器，但会造成被子组件原来的样式干扰</li>
<li>传入不同的前缀实现样式互相隔绝</li>
<li>注意<code>CSS</code>权重计算，子组件比父组件后加载</li>
</ul>
<blockquote>
<p>可以声明一个变量，传对象，将该对象作为<code>:class=&quot;&quot;</code>的绑定值</p>
</blockquote>
<hr>
<h3 id="抽离typesvue为tabsvue组件">抽离<code>Types.vue</code>为<code>Tabs.vue</code>组件</h3>
<blockquote>
<p>可现实多项内容<code>Tabs</code>切换</p>
</blockquote>
<ul>
<li>需要外部传参：对象数组包含显示文字和类型字符<code>+/-</code>、前缀字符</li>
<li>内容为父组件传入<code>@Prop({required: true, type: Array}) dataSource!: { text: string; type: string }[];</code></li>
<li>声明类型<code>type DataSource = { text: string; type: string }</code></li>
<li><code>dataSource</code>改为<code>@Prop({required: true, type: Array}) dataSource!: DataSource[];</code></li>
<li><code>type</code>类型字符串<code>@Prop(String) readonly type!: string;</code></li>
<li><code>classPrefix</code>前缀字符串<code>@Prop(String) readonly classPrefix?: string;</code></li>
</ul>
<blockquote>
<p><code>Tabs.vue</code></p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-vue" data-lang="vue"><span class="p">&lt;</span><span class="nt">template</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">ul</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;tabs&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">li</span> <span class="nt">v-for</span><span class="s">=&#34;item in dataSource&#34; :key=&#34;item.type&#34; :class=&#34;{selected: item.type === type}&#34;
</span><span class="s">    @click=&#34;select(item)&#34;&gt;
</span><span class="s">        {{ item.text }}
</span><span class="s">    &lt;/li&gt;
</span><span class="s">  &lt;/ul&gt;
</span><span class="s">&lt;/template&gt;
</span><span class="s">
</span><span class="s">&lt;script lang=&#34;ts&#34;</span><span class="p">&gt;</span>
<span class="na">import</span> <span class="na">Vue</span> <span class="na">from</span> <span class="err">&#39;</span><span class="na">vue</span><span class="err">&#39;;</span>
<span class="na">import</span> <span class="p">{</span><span class="na">Component</span><span class="err">,</span> <span class="na">Prop</span><span class="p">}</span> <span class="na">from</span> <span class="err">&#39;</span><span class="na">vue</span><span class="nt">-property-decorator</span><span class="err">&#39;;</span>

<span class="na">type</span> <span class="na">DataSource </span><span class="o">=</span> <span class="p">{</span> <span class="nx">text</span><span class="o">:</span> <span class="nx">string</span><span class="p">;</span> <span class="nx">type</span><span class="o">:</span> <span class="nx">string</span> <span class="p">}</span>
<span class="err">@</span><span class="na">Component</span>
<span class="na">export</span> <span class="na">default</span> <span class="na">class</span> <span class="na">Tabs</span> <span class="na">extends</span> <span class="na">Vue</span> <span class="p">{</span>
  <span class="err">@</span><span class="na">Prop</span><span class="err">(</span><span class="p">{</span><span class="na">required</span><span class="o">:</span> <span class="na">true</span><span class="err">,</span> <span class="na">type</span><span class="o">:</span> <span class="na">Array</span><span class="p">}</span><span class="err">)</span> <span class="na">dataSource</span><span class="err">!</span><span class="o">:</span> <span class="na">DataSource</span><span class="err">[];</span>
  <span class="err">@</span><span class="na">Prop</span><span class="err">(</span><span class="na">String</span><span class="err">)</span> <span class="na">readonly</span> <span class="na">type</span><span class="err">!</span><span class="o">:</span> <span class="na">string</span><span class="err">;</span>
  <span class="err">@</span><span class="na">Prop</span><span class="err">(</span><span class="na">String</span><span class="err">)</span> <span class="na">readonly</span> <span class="na">classPrefix</span><span class="err">?</span><span class="o">:</span> <span class="na">string</span><span class="err">;</span>

  <span class="na">select</span><span class="err">(</span><span class="na">item</span><span class="o">:</span> <span class="na">DataSource</span><span class="err">)</span> <span class="p">{</span>
    <span class="na">this.</span><span class="err">$</span><span class="na">emit</span><span class="err">(&#39;</span><span class="na">update</span><span class="o">:</span><span class="na">type</span><span class="err">&#39;,</span> <span class="na">item.type</span><span class="err">);</span>
  <span class="p">}</span>
<span class="p">}</span>
<span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>

<span class="p">&lt;</span><span class="nt">style</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;scss&#34;</span> <span class="na">scoped</span><span class="p">&gt;</span>
<span class="p">.</span><span class="nx">tabs</span> <span class="p">{</span>
  <span class="nx">background</span><span class="o">:</span> <span class="err">#</span><span class="nx">c4c4c4</span><span class="p">;</span>
  <span class="nx">display</span><span class="o">:</span> <span class="nx">flex</span><span class="p">;</span>
  <span class="nx">text</span><span class="o">-</span><span class="nx">align</span><span class="o">:</span> <span class="nx">center</span><span class="p">;</span>
  <span class="o">&gt;</span> <span class="nx">li</span> <span class="p">{</span>
    <span class="nx">font</span><span class="o">-</span><span class="nx">size</span><span class="o">:</span> <span class="mi">24</span><span class="nx">px</span><span class="p">;</span>
    <span class="nx">width</span><span class="o">:</span> <span class="mi">50</span><span class="o">%</span><span class="p">;</span>
    <span class="nx">height</span><span class="o">:</span> <span class="mi">64</span><span class="nx">px</span><span class="p">;</span>
    <span class="nx">display</span><span class="o">:</span> <span class="nx">flex</span><span class="p">;</span>
    <span class="nx">justify</span><span class="o">-</span><span class="nx">content</span><span class="o">:</span> <span class="nx">center</span><span class="p">;</span>
    <span class="nx">align</span><span class="o">-</span><span class="nx">items</span><span class="o">:</span> <span class="nx">center</span><span class="p">;</span>
    <span class="nx">position</span><span class="o">:</span> <span class="nx">relative</span><span class="p">;</span>
    <span class="o">&amp;</span><span class="p">.</span><span class="nx">selected</span> <span class="p">{</span>
      <span class="nx">background</span><span class="o">:</span> <span class="err">#</span><span class="nx">c4c4c4</span><span class="p">;</span>
      <span class="o">&amp;::</span><span class="nx">after</span> <span class="p">{</span>
        <span class="nx">content</span><span class="o">:</span> <span class="s2">&#34;&#34;</span><span class="p">;</span>
        <span class="nx">display</span><span class="o">:</span> <span class="nx">block</span><span class="p">;</span>
        <span class="nx">position</span><span class="o">:</span> <span class="nx">absolute</span><span class="p">;</span>
        <span class="nx">bottom</span><span class="o">:</span> <span class="mi">0</span><span class="p">;</span>
        <span class="nx">left</span><span class="o">:</span> <span class="mi">0</span><span class="p">;</span>
        <span class="nx">width</span><span class="o">:</span> <span class="mi">100</span><span class="o">%</span><span class="p">;</span>
        <span class="nx">height</span><span class="o">:</span> <span class="mi">4</span><span class="nx">px</span><span class="p">;</span>
        <span class="nx">background</span><span class="o">:</span> <span class="err">#</span><span class="mi">333</span><span class="p">;</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">&lt;/</span><span class="nt">style</span><span class="p">&gt;</span>

</code></pre></td></tr></table>
</div>
</div><blockquote>
<p><code>Statistic.vue </code></p>
</blockquote>
<ul>
<li><code>&lt;Tabs class-prefix=&quot;interval&quot; :data-source=&quot;typeList&quot; :type.sync=&quot;type&quot;/&gt;</code>
<ul>
<li>样式前缀：<code>class-prefix=&quot;interval&quot;</code>，子组件默认样式</li>
<li>传<code>dataSource</code>为<code>intervalList</code></li>
<li>声明<code>intervalList = [{text: '按天', type: 'day'}, {text: '按周', type: 'week'}, {text: '按月', type: 'month'}];</code></li>
<li>传初始绑定的同步数据<code>:type.sync=&quot;interval&quot;</code>为<code>interval = 'day';</code>（按天）</li>
</ul>
</li>
<li>用<code>Tabs.vue</code>改造<code>Types.vue</code>: <code>&lt;Tabs class-prefix=&quot;type&quot; :data-source=&quot;typeList&quot; :type.sync=&quot;type&quot;/&gt;</code>
<ul>
<li>样式前缀：<code>class-prefix=&quot;type&quot;</code>： <code>::v-deep .type-item {...}</code></li>
<li>声明数据源<code>typeList = [{text: '支出', type: '-'}, {text: '收入', type: '+'}]</code></li>
<li>传初始绑定的同步数据<code>:type.sync=&quot;type&quot;</code>为<code>type = '-';</code>（支出）</li>
</ul>
</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-vue" data-lang="vue"><span class="p">&lt;</span><span class="nt">template</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">Layout</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;statistics&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">Tabs</span> <span class="na">class</span><span class="nt">-prefix</span><span class="err">=&#34;</span><span class="na">type</span><span class="err">&#34;</span> <span class="nt">:data-source</span><span class="s">=&#34;typeList&#34;</span> <span class="nt">:type.sync</span><span class="s">=&#34;type&#34;</span><span class="p">/&gt;</span>
    <span class="p">&lt;</span><span class="nt">Tabs</span> <span class="na">class</span><span class="nt">-prefix</span><span class="err">=&#34;</span><span class="na">interval</span><span class="err">&#34;</span> <span class="nt">:data-source</span><span class="s">=&#34;intervalList&#34;</span> <span class="nt">:type.sync</span><span class="s">=&#34;interval&#34;</span><span class="p">/&gt;</span>
  <span class="p">&lt;/</span><span class="nt">Layout</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">template</span><span class="p">&gt;</span>

<span class="p">&lt;</span><span class="nt">script</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;ts&#34;</span><span class="p">&gt;</span>
<span class="kr">import</span> <span class="nx">Vue</span> <span class="nx">from</span> <span class="s1">&#39;vue&#39;</span><span class="p">;</span>
<span class="kr">import</span> <span class="p">{</span><span class="nx">Component</span><span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;vue-property-decorator&#39;</span><span class="p">;</span>
<span class="kr">import</span> <span class="nx">Types</span> <span class="nx">from</span> <span class="s1">&#39;@/components/Money/Types.vue&#39;</span><span class="p">;</span>
<span class="kr">import</span> <span class="nx">Tabs</span> <span class="nx">from</span> <span class="s1">&#39;@/components/Tabs.vue&#39;</span><span class="p">;</span>

<span class="err">@</span><span class="nx">Component</span><span class="p">({</span>
  <span class="nx">components</span><span class="o">:</span> <span class="p">{</span><span class="nx">Tabs</span><span class="p">,</span> <span class="nx">Types</span><span class="p">}</span>
<span class="p">})</span>
<span class="kr">export</span> <span class="k">default</span> <span class="kr">class</span> <span class="nx">Statistics</span> <span class="kr">extends</span> <span class="nx">Vue</span> <span class="p">{</span>
  <span class="nx">type</span> <span class="o">=</span> <span class="s1">&#39;-&#39;</span><span class="p">;</span>
  <span class="nx">interval</span> <span class="o">=</span> <span class="s1">&#39;day&#39;</span><span class="p">;</span>

  <span class="nx">intervalList</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">{</span><span class="nx">text</span><span class="o">:</span> <span class="s1">&#39;按天&#39;</span><span class="p">,</span> <span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;day&#39;</span><span class="p">},</span>
    <span class="p">{</span><span class="nx">text</span><span class="o">:</span> <span class="s1">&#39;按周&#39;</span><span class="p">,</span> <span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;week&#39;</span><span class="p">},</span>
    <span class="p">{</span><span class="nx">text</span><span class="o">:</span> <span class="s1">&#39;按月&#39;</span><span class="p">,</span> <span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;month&#39;</span><span class="p">}</span>
  <span class="p">];</span>

  <span class="nx">typeList</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">{</span><span class="nx">text</span><span class="o">:</span> <span class="s1">&#39;支出&#39;</span><span class="p">,</span> <span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;-&#39;</span><span class="p">},</span>
    <span class="p">{</span><span class="nx">text</span><span class="o">:</span> <span class="s1">&#39;收入&#39;</span><span class="p">,</span> <span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;+&#39;</span><span class="p">}</span>
  <span class="p">]</span>
<span class="p">}</span>
<span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>

<span class="p">&lt;</span><span class="nt">style</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;scss&#34;</span> <span class="na">scoped</span><span class="p">&gt;</span>
<span class="p">.</span><span class="nx">statistics</span> <span class="p">{</span>
  <span class="o">::</span><span class="nx">v</span><span class="o">-</span><span class="nx">deep</span> <span class="p">.</span><span class="nx">type</span><span class="o">-</span><span class="nx">tabs</span><span class="o">-</span><span class="nx">item</span> <span class="p">{</span>
    <span class="nx">background</span><span class="o">:</span> <span class="err">#</span><span class="nx">fff</span><span class="p">;</span>
    <span class="nx">position</span><span class="o">:</span> <span class="nx">relative</span><span class="p">;</span>
    <span class="o">&amp;</span><span class="p">.</span><span class="nx">selected</span> <span class="p">{</span>
      <span class="nx">background</span><span class="o">:</span> <span class="err">#</span><span class="nx">c4c4c4</span><span class="p">;</span>
      <span class="o">&amp;::</span><span class="nx">after</span> <span class="p">{</span>
        <span class="nx">display</span><span class="o">:</span> <span class="nx">none</span><span class="p">;</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">&lt;/</span><span class="nt">style</span><span class="p">&gt;</span>

</code></pre></td></tr></table>
</div>
</div><blockquote>
<p><code>Tabs.vue</code></p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-vue" data-lang="vue"><span class="p">&lt;</span><span class="nt">template</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">ul</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;tabs&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">li</span> <span class="nt">v-for</span><span class="s">=&#34;item in dataSource&#34;
</span><span class="s">        :key=&#34;item.type&#34;
</span><span class="s">        :class=&#34;liClass(item)&#34;
</span><span class="s">        @click=&#34;select(item)&#34;&gt;{{ item.text }}
</span><span class="s">    &lt;/li&gt;
</span><span class="s">  &lt;/ul&gt;
</span><span class="s">&lt;/template&gt;
</span><span class="s">
</span><span class="s">&lt;script lang=&#34;ts&#34;</span><span class="p">&gt;</span>
<span class="na">import</span> <span class="na">Vue</span> <span class="na">from</span> <span class="err">&#39;</span><span class="na">vue</span><span class="err">&#39;;</span>
<span class="na">import</span> <span class="p">{</span><span class="na">Component</span><span class="err">,</span> <span class="na">Prop</span><span class="p">}</span> <span class="na">from</span> <span class="err">&#39;</span><span class="na">vue</span><span class="nt">-property-decorator</span><span class="err">&#39;;</span>

<span class="na">type</span> <span class="na">DataSource </span><span class="o">=</span> <span class="p">{</span> <span class="nx">text</span><span class="o">:</span> <span class="nx">string</span><span class="p">;</span> <span class="nx">type</span><span class="o">:</span> <span class="nx">string</span> <span class="p">}</span>
<span class="err">@</span><span class="na">Component</span>
<span class="na">export</span> <span class="na">default</span> <span class="na">class</span> <span class="na">Tabs</span> <span class="na">extends</span> <span class="na">Vue</span> <span class="p">{</span>
  <span class="err">@</span><span class="na">Prop</span><span class="err">(</span><span class="p">{</span><span class="na">required</span><span class="o">:</span> <span class="na">true</span><span class="err">,</span> <span class="na">type</span><span class="o">:</span> <span class="na">Array</span><span class="p">}</span><span class="err">)</span> <span class="na">dataSource</span><span class="err">!</span><span class="o">:</span> <span class="na">DataSource</span><span class="err">[];</span>
  <span class="err">@</span><span class="na">Prop</span><span class="err">(</span><span class="na">String</span><span class="err">)</span> <span class="na">readonly</span> <span class="na">type</span><span class="err">!</span><span class="o">:</span> <span class="na">string</span><span class="err">;</span>
  <span class="err">@</span><span class="na">Prop</span><span class="err">(</span><span class="na">String</span><span class="err">)</span> <span class="na">classPrefix</span><span class="err">?</span><span class="o">:</span> <span class="na">string</span><span class="err">;</span>

  <span class="na">liClass</span><span class="err">(</span><span class="na">item</span><span class="o">:</span> <span class="na">DataSource</span><span class="err">)</span> <span class="p">{</span>
    <span class="na">return</span> <span class="p">{</span>
      <span class="err">[</span><span class="na">this.classPrefix</span> <span class="err">+&#39;</span><span class="nt">-tabs-item</span><span class="err">&#39;]</span><span class="o">:</span> <span class="na">this.classPrefix</span><span class="err">,</span>
      <span class="na">selected</span><span class="o">:</span> <span class="na">item.type</span> <span class="err">===</span> <span class="na">this.type</span>
    <span class="p">}</span><span class="err">;</span>
  <span class="p">}</span>

  <span class="na">select</span><span class="err">(</span><span class="na">item</span><span class="o">:</span> <span class="na">DataSource</span><span class="err">)</span> <span class="p">{</span>
    <span class="na">this.</span><span class="err">$</span><span class="na">emit</span><span class="err">(&#39;</span><span class="na">update</span><span class="o">:</span><span class="na">type</span><span class="err">&#39;,</span> <span class="na">item.type</span><span class="err">);</span>
  <span class="p">}</span>
<span class="p">}</span>
<span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
<span class="na">..</span>
</code></pre></td></tr></table>
</div>
</div><ul>
<li>遍历数据<code>dataSource</code>，绑定<code>:key=&quot;item.type&quot;</code>，插值<code>{{ item.text }}</code>
<ul>
<li><code>&lt;li v-for=&quot;item in dataSource&quot; :key=&quot;item.type&quot;&gt;{{ item.text }}&lt;/li&gt;</code></li>
</ul>
</li>
<li>注册事件<code>@click=&quot;select(item)&quot;</code>
<ul>
<li><code>&lt;li v-for=&quot;item in dataSource&quot; :key=&quot;item.type&quot; @click=&quot;select(item)&quot;&gt;{{ item.text }}&lt;/li&gt;</code></li>
</ul>
</li>
<li><code>class</code>绑定：<code>:class=&quot;{[this.classPrefix +'-tabs-item']: this.classPrefix, selected: item.type === type}&quot;</code>太长
<ul>
<li>封装样式对象返回变量的函数，接受<code>&lt;template&gt;</code>中的数据传参<code>item</code></li>
<li><code>&lt;li v-for=&quot;item in dataSource&quot; :key=&quot;item.type&quot; :class=&quot;liClass(item)&quot;  @click=&quot;select(item)&quot;&gt;{{ item.text }}&lt;/li&gt;</code></li>
<li>缩写为<code>:class=&quot;liClass(item)&quot;</code></li>
<li>函数实现<code>liClass(item: DataSource) {return {[this.classPrefix +'-tabs-item']: this.classPrefix, selected: item.type === this.type};}</code></li>
<li>不可使用箭头函数，避免<code>this</code>指向</li>
</ul>
</li>
<li>发布事件
<ul>
<li><code>select(item: DataSource) {this.$emit('update:type', item.type);}</code></li>
<li>注意类型声明<code>DataSource</code></li>
</ul>
</li>
</ul>
<hr>
<blockquote>
<p><code>Statistic.vue</code> 显示插值是否正确</p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-vue" data-lang="vue"><span class="p">&lt;</span><span class="nt">template</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">Layout</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;statistics&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">Tabs</span> <span class="na">class</span><span class="nt">-prefix</span><span class="err">=&#34;</span><span class="na">type</span><span class="err">&#34;</span> <span class="nt">:data-source</span><span class="s">=&#34;typeList&#34;</span> <span class="nt">:type.sync</span><span class="s">=&#34;type&#34;</span><span class="p">/&gt;</span>
    <span class="p">&lt;</span><span class="nt">Tabs</span> <span class="na">class</span><span class="nt">-prefix</span><span class="err">=&#34;</span><span class="na">interval</span><span class="err">&#34;</span> <span class="nt">:data-source</span><span class="s">=&#34;intervalList&#34;</span> <span class="nt">:type.sync</span><span class="s">=&#34;interval&#34;</span><span class="p">/&gt;</span>
    <span class="nx">type</span><span class="o">:</span> <span class="p">{{</span> <span class="nx">type</span> <span class="p">}}</span>
    <span class="p">&lt;</span><span class="nt">br</span><span class="p">&gt;</span>
    <span class="nx">interval</span><span class="o">:</span> <span class="p">{{</span> <span class="nx">interval</span> <span class="p">}}</span>
  <span class="p">&lt;/</span><span class="nt">Layout</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">template</span><span class="p">&gt;</span>

</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>模块化常量数据<code>src/constants/intervalList.ts</code></p>
</blockquote>
<ul>
<li>使数据不可使用栈方法，<code>Object.freeze()</code></li>
<li>禁止改变原对象，成为真正的常量</li>
</ul>
<blockquote>
<p><code>intervalList.ts</code></p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-TypeScript" data-lang="TypeScript"><span class="cm">/*
</span><span class="cm">const intervalList = Object.freeze([
</span><span class="cm">  {text: &#39;按天&#39;, type: &#39;day&#39;},
</span><span class="cm">  {text: &#39;按周&#39;, type: &#39;week&#39;},
</span><span class="cm">  {text: &#39;按月&#39;, type: &#39;month&#39;}
</span><span class="cm">]);
</span><span class="cm">
</span><span class="cm">export default intervalList;
</span><span class="cm">*/</span>

<span class="kr">export</span> <span class="k">default</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">freeze</span><span class="p">([</span>
  <span class="p">{</span><span class="nx">text</span><span class="o">:</span> <span class="s1">&#39;按天&#39;</span><span class="p">,</span> <span class="kr">type</span><span class="o">:</span> <span class="s1">&#39;day&#39;</span><span class="p">},</span>
  <span class="p">{</span><span class="nx">text</span><span class="o">:</span> <span class="s1">&#39;按周&#39;</span><span class="p">,</span> <span class="kr">type</span><span class="o">:</span> <span class="s1">&#39;week&#39;</span><span class="p">},</span>
  <span class="p">{</span><span class="nx">text</span><span class="o">:</span> <span class="s1">&#39;按月&#39;</span><span class="p">,</span> <span class="kr">type</span><span class="o">:</span> <span class="s1">&#39;month&#39;</span><span class="p">}</span>
<span class="p">]);</span>

</code></pre></td></tr></table>
</div>
</div><blockquote>
<p><code>recordTypeList.ts</code></p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-TypeScript" data-lang="TypeScript"><span class="cm">/*
</span><span class="cm">const recordTypeList = Object.freeze([
</span><span class="cm">  {text: &#39;支出&#39;, type: &#39;-&#39;},
</span><span class="cm">  {text: &#39;收入&#39;, type: &#39;+&#39;}
</span><span class="cm">]);
</span><span class="cm">
</span><span class="cm">export default recordTypeList;
</span><span class="cm">*/</span>

<span class="kr">export</span> <span class="k">default</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">freeze</span><span class="p">([</span>
  <span class="p">{</span><span class="nx">text</span><span class="o">:</span> <span class="s1">&#39;支出&#39;</span><span class="p">,</span> <span class="kr">type</span><span class="o">:</span> <span class="s1">&#39;-&#39;</span><span class="p">},</span>
  <span class="p">{</span><span class="nx">text</span><span class="o">:</span> <span class="s1">&#39;收入&#39;</span><span class="p">,</span> <span class="kr">type</span><span class="o">:</span> <span class="s1">&#39;+&#39;</span><span class="p">}</span>
<span class="p">]);</span>

</code></pre></td></tr></table>
</div>
</div><blockquote>
<p><code>Statistic.vue</code></p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-vue" data-lang="vue"><span class="p">...</span>
<span class="p">&lt;</span><span class="nt">script</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;ts&#34;</span><span class="p">&gt;</span>
<span class="kr">import</span> <span class="nx">Vue</span> <span class="nx">from</span> <span class="s1">&#39;vue&#39;</span><span class="p">;</span>
<span class="kr">import</span> <span class="p">{</span><span class="nx">Component</span><span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;vue-property-decorator&#39;</span><span class="p">;</span>
<span class="kr">import</span> <span class="nx">Types</span> <span class="nx">from</span> <span class="s1">&#39;@/components/Money/Types.vue&#39;</span><span class="p">;</span>
<span class="kr">import</span> <span class="nx">Tabs</span> <span class="nx">from</span> <span class="s1">&#39;@/components/Tabs.vue&#39;</span><span class="p">;</span>
<span class="kr">import</span> <span class="nx">recordTypeList</span> <span class="nx">from</span> <span class="s1">&#39;@/constants/recordTypeList&#39;</span><span class="p">;</span>
<span class="kr">import</span> <span class="nx">intervalList</span> <span class="nx">from</span> <span class="s1">&#39;@/constants/intervalList&#39;</span><span class="p">;</span>

<span class="err">@</span><span class="nx">Component</span><span class="p">({</span>
  <span class="nx">components</span><span class="o">:</span> <span class="p">{</span><span class="nx">Tabs</span><span class="p">,</span> <span class="nx">Types</span><span class="p">}</span>
<span class="p">})</span>
<span class="kr">export</span> <span class="k">default</span> <span class="kr">class</span> <span class="nx">Statistics</span> <span class="kr">extends</span> <span class="nx">Vue</span> <span class="p">{</span>
  <span class="nx">type</span> <span class="o">=</span> <span class="s1">&#39;-&#39;</span><span class="p">;</span>
  <span class="nx">interval</span> <span class="o">=</span> <span class="s1">&#39;day&#39;</span><span class="p">;</span>
  <span class="nx">intervalList</span> <span class="o">=</span> <span class="nx">intervalList</span><span class="p">;</span>
  <span class="nx">recordTypeList</span> <span class="o">=</span> <span class="nx">recordTypeList</span><span class="p">;</span>
<span class="p">}</span>
<span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
<span class="p">...</span>
</code></pre></td></tr></table>
</div>
</div><ul>
<li>重构<code>typeList</code>为<code>recordTypeList</code></li>
</ul>
<blockquote>
<p>重构<code>Money.vue</code> 使用<code>Tabs.vue</code>，并删除 <code>Types.vue</code></p>
</blockquote>
<blockquote>
<p><code>Money.vue</code></p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-vue" data-lang="vue"><span class="p">&lt;</span><span class="nt">template</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">Layout</span> <span class="na">class</span><span class="nt">-prefix</span><span class="err">=&#34;</span><span class="na">layout</span><span class="err">&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">Tags</span> <span class="nt">@update:selectedTags</span><span class="s">=&#34;pickTags&#34;</span><span class="p">/&gt;</span>
    <span class="p">&lt;</span><span class="nt">FormItem</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;form-item&#34;</span> <span class="na">field</span><span class="nt">-name</span><span class="err">=&#34;</span><span class="na">备注</span><span class="err">&#34;</span> <span class="na">placeholder</span><span class="o">=</span><span class="s">&#34;在这里输入备注&#34;</span>
              <span class="nt">@update:inputValue</span><span class="s">=&#34;onUpdateTips&#34;</span><span class="p">/&gt;</span>
    <span class="p">&lt;</span><span class="nt">Tabs</span> <span class="nt">:data-source</span><span class="s">=&#34;recordTypeList&#34;</span> <span class="nt">:type.sync</span><span class="s">=&#34;record.type&#34;</span><span class="p">/&gt;</span>
    <span class="p">&lt;</span><span class="nt">Numpad</span> <span class="nt">:value.sync</span><span class="s">=&#34;record.amount&#34;</span>
            <span class="nt">@submit</span><span class="s">=&#34;saveRecord&#34;</span><span class="p">/&gt;</span>
  <span class="p">&lt;/</span><span class="nt">Layout</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">template</span><span class="p">&gt;</span>

<span class="p">&lt;</span><span class="nt">script</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;ts&#34;</span><span class="p">&gt;</span>
<span class="kr">import</span> <span class="nx">Vue</span> <span class="nx">from</span> <span class="s1">&#39;vue&#39;</span><span class="p">;</span>
<span class="kr">import</span> <span class="nx">Tags</span> <span class="nx">from</span> <span class="s1">&#39;@/components/Money/Tags.vue&#39;</span><span class="p">;</span>
<span class="kr">import</span> <span class="nx">FormItem</span> <span class="nx">from</span> <span class="s1">&#39;@/components/Money/FormItem.vue&#39;</span><span class="p">;</span>
<span class="kr">import</span> <span class="nx">Types</span> <span class="nx">from</span> <span class="s1">&#39;@/components/Money/Types.vue&#39;</span><span class="p">;</span>
<span class="kr">import</span> <span class="nx">Numpad</span> <span class="nx">from</span> <span class="s1">&#39;@/components/Money/Numpad.vue&#39;</span><span class="p">;</span>
<span class="kr">import</span> <span class="p">{</span><span class="nx">Component</span><span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;vue-property-decorator&#39;</span><span class="p">;</span>
<span class="kr">import</span> <span class="nx">recordTypeList</span> <span class="nx">from</span> <span class="s1">&#39;@/constants/recordTypeList.ts&#39;</span><span class="p">;</span>
<span class="kr">import</span> <span class="nx">Tabs</span> <span class="nx">from</span> <span class="s1">&#39;@/components/Tabs.vue&#39;</span><span class="p">;</span>

<span class="err">@</span><span class="nx">Component</span><span class="p">({</span>
  <span class="nx">components</span><span class="o">:</span> <span class="p">{</span><span class="nx">Tabs</span><span class="p">,</span> <span class="nx">Numpad</span><span class="p">,</span> <span class="nx">Types</span><span class="p">,</span> <span class="nx">FormItem</span><span class="p">,</span> <span class="nx">Tags</span><span class="p">}</span>
<span class="p">})</span>
<span class="kr">export</span> <span class="k">default</span> <span class="kr">class</span> <span class="nx">Money</span> <span class="kr">extends</span> <span class="nx">Vue</span> <span class="p">{</span>
  <span class="nx">get</span> <span class="nx">recordList</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">$store</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">recordList</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="nx">record</span><span class="o">:</span> <span class="nx">RecordItem</span> <span class="o">=</span> <span class="p">{</span>
    <span class="nx">tags</span><span class="o">:</span> <span class="p">[],</span>
    <span class="nx">tips</span><span class="o">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
    <span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span>
    <span class="nx">amount</span><span class="o">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="nx">createdAt</span><span class="o">:</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">(),</span>
  <span class="p">};</span>
  <span class="nx">recordTypeList</span> <span class="o">=</span> <span class="nx">recordTypeList</span><span class="p">;</span>

  <span class="nx">created</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">$store</span><span class="p">.</span><span class="nx">commit</span><span class="p">(</span><span class="s1">&#39;fetchRecords&#39;</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="nx">onUpdateTips</span><span class="p">(</span><span class="nx">value</span><span class="o">:</span> <span class="nx">string</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">record</span><span class="p">.</span><span class="nx">tips</span> <span class="o">=</span> <span class="nx">value</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="nx">pickTags</span><span class="p">(</span><span class="nx">selectedTags</span><span class="o">:</span> <span class="nx">string</span><span class="p">[])</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">record</span><span class="p">.</span><span class="nx">tags</span> <span class="o">=</span> <span class="nx">selectedTags</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="nx">saveRecord</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">$store</span><span class="p">.</span><span class="nx">commit</span><span class="p">(</span><span class="s1">&#39;createRecord&#39;</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">record</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
<span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
<span class="p">...</span>

</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>调整高度样式，更改优先级</p>
</blockquote>
<ul>
<li>注意<code>CSS</code>权重计算
<ul>
<li>子组件比父组件后加载</li>
<li>更多使用具体的<code>class</code>选择器，精确控制样式</li>
<li>特别是使用深度作用选择器时，尽量<strong>不使用标签选择器</strong>，里层的标签未知</li>
<li>解决样式被覆盖的方法：减少/增加 嵌套的选择器
<ul>
<li>减少嵌套：去除后代/子选择器 <code>&gt; li</code>，改用<code>class</code>选择器增加权重</li>
</ul>
</li>
</ul>
</li>
</ul>
<blockquote>
<p><code>Tabs.vue</code></p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-vue" data-lang="vue"><span class="p">&lt;</span><span class="nt">template</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">ul</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;tabs&#34;</span> <span class="o">:</span><span class="na">class</span><span class="o">=</span><span class="s">&#34;{[classPrefix + &#39;-tabs&#39;]: classPrefix}&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">li</span> <span class="nt">v-for</span><span class="s">=&#34;item in dataSource&#34;
</span><span class="s">        :key=&#34;item.type&#34;
</span><span class="s">        :class=&#34;liClass(item)&#34;
</span><span class="s">        @click=&#34;select(item)&#34;
</span><span class="s">        class=&#34;tabs-item&#34;</span><span class="p">&gt;</span>
      <span class="p">{{</span> <span class="na">item.text</span> <span class="p">}}</span>
    <span class="p">&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
  <span class="p">&lt;/</span><span class="nt">ul</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">template</span><span class="p">&gt;</span>
<span class="na">...</span>
<span class="p">&lt;</span><span class="nt">style</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;scss&#34;</span> <span class="na">scoped</span><span class="p">&gt;</span>
<span class="p">.</span><span class="nx">tabs</span> <span class="p">{</span>
  <span class="nx">background</span><span class="o">:</span> <span class="err">#</span><span class="nx">c4c4c4</span><span class="p">;</span>
  <span class="nx">display</span><span class="o">:</span> <span class="nx">flex</span><span class="p">;</span>
  <span class="nx">text</span><span class="o">-</span><span class="nx">align</span><span class="o">:</span> <span class="nx">center</span><span class="p">;</span>
  <span class="o">&amp;-</span><span class="nx">item</span> <span class="p">{</span>
    <span class="nx">font</span><span class="o">-</span><span class="nx">size</span><span class="o">:</span> <span class="mi">24</span><span class="nx">px</span><span class="p">;</span>
    <span class="nx">width</span><span class="o">:</span> <span class="mi">50</span><span class="o">%</span><span class="p">;</span>
    <span class="nx">height</span><span class="o">:</span> <span class="mi">64</span><span class="nx">px</span><span class="p">;</span>
    <span class="nx">display</span><span class="o">:</span> <span class="nx">flex</span><span class="p">;</span>
    <span class="nx">justify</span><span class="o">-</span><span class="nx">content</span><span class="o">:</span> <span class="nx">center</span><span class="p">;</span>
    <span class="nx">align</span><span class="o">-</span><span class="nx">items</span><span class="o">:</span> <span class="nx">center</span><span class="p">;</span>
    <span class="nx">position</span><span class="o">:</span> <span class="nx">relative</span><span class="p">;</span>
    <span class="o">&amp;</span><span class="p">.</span><span class="nx">selected</span> <span class="p">{</span>
      <span class="nx">background</span><span class="o">:</span> <span class="err">#</span><span class="nx">c4c4c4</span><span class="p">;</span>
      <span class="o">&amp;::</span><span class="nx">after</span> <span class="p">{</span>
        <span class="nx">content</span><span class="o">:</span> <span class="s2">&#34;&#34;</span><span class="p">;</span>
        <span class="nx">display</span><span class="o">:</span> <span class="nx">block</span><span class="p">;</span>
        <span class="nx">position</span><span class="o">:</span> <span class="nx">absolute</span><span class="p">;</span>
        <span class="nx">bottom</span><span class="o">:</span> <span class="mi">0</span><span class="p">;</span>
        <span class="nx">left</span><span class="o">:</span> <span class="mi">0</span><span class="p">;</span>
        <span class="nx">width</span><span class="o">:</span> <span class="mi">100</span><span class="o">%</span><span class="p">;</span>
        <span class="nx">height</span><span class="o">:</span> <span class="mi">4</span><span class="nx">px</span><span class="p">;</span>
        <span class="nx">background</span><span class="o">:</span> <span class="err">#</span><span class="mi">333</span><span class="p">;</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">&lt;/</span><span class="nt">style</span><span class="p">&gt;</span>

</code></pre></td></tr></table>
</div>
</div><blockquote>
<p><code>Statistic.vue</code></p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-vue" data-lang="vue"><span class="p">&lt;</span><span class="nt">template</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">Layout</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;statistics&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">Tabs</span> <span class="na">class</span><span class="nt">-prefix</span><span class="err">=&#34;</span><span class="na">type</span><span class="err">&#34;</span> <span class="nt">:data-source</span><span class="s">=&#34;recordTypeList&#34;</span> <span class="nt">:type.sync</span><span class="s">=&#34;type&#34;</span><span class="p">/&gt;</span>
    <span class="p">&lt;</span><span class="nt">Tabs</span> <span class="na">class</span><span class="nt">-prefix</span><span class="err">=&#34;</span><span class="na">interval</span><span class="err">&#34;</span> <span class="nt">:data-source</span><span class="s">=&#34;intervalList&#34;</span> <span class="nt">:type.sync</span><span class="s">=&#34;interval&#34;</span><span class="p">/&gt;</span>
    <span class="nx">type</span><span class="o">:</span> <span class="p">{{</span> <span class="nx">type</span> <span class="p">}}</span>
    <span class="p">&lt;</span><span class="nt">br</span><span class="p">&gt;</span>
    <span class="nx">interval</span><span class="o">:</span> <span class="p">{{</span> <span class="nx">interval</span> <span class="p">}}</span>
  <span class="p">&lt;/</span><span class="nt">Layout</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">template</span><span class="p">&gt;</span>
<span class="p">...</span>
<span class="p">&lt;</span><span class="nt">style</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;scss&#34;</span> <span class="na">scoped</span><span class="p">&gt;</span>
<span class="p">.</span><span class="nx">statistics</span> <span class="p">{</span>
  <span class="o">::</span><span class="nx">v</span><span class="o">-</span><span class="nx">deep</span> <span class="p">{</span>
    <span class="p">.</span><span class="nx">type</span><span class="o">-</span><span class="nx">tabs</span><span class="o">-</span><span class="nx">item</span> <span class="p">{</span>
      <span class="nx">background</span><span class="o">:</span> <span class="err">#</span><span class="nx">fff</span><span class="p">;</span>
      <span class="nx">position</span><span class="o">:</span> <span class="nx">relative</span><span class="p">;</span>
      <span class="o">&amp;</span><span class="p">.</span><span class="nx">selected</span> <span class="p">{</span>
        <span class="nx">background</span><span class="o">:</span> <span class="err">#</span><span class="nx">c4c4c4</span><span class="p">;</span>
        <span class="o">&amp;::</span><span class="nx">after</span> <span class="p">{</span>
          <span class="nx">display</span><span class="o">:</span> <span class="nx">none</span><span class="p">;</span>
          <span class="p">}</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">.</span><span class="nx">interval</span><span class="o">-</span><span class="nx">tabs</span><span class="o">-</span><span class="nx">item</span> <span class="p">{</span>
      <span class="nx">height</span><span class="o">:</span> <span class="mi">48</span><span class="nx">px</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">&lt;/</span><span class="nt">style</span><span class="p">&gt;</span>

</code></pre></td></tr></table>
</div>
</div><hr>
<h2 id="用-ts-配置组件默认-height">用 TS 配置组件默认 height</h2>
<ul>
<li>使用外部数据传入高度属性值</li>
<li>注意高度属性值类型是字符串，不是数字</li>
<li>外部数据无需初始化，加上强制类型断言<code>!: string</code></li>
<li>注意内联样式<code>style</code>属性的权重</li>
</ul>
<blockquote>
<p><code>Tabs.vue</code></p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-vue" data-lang="vue"><span class="p">&lt;</span><span class="nt">template</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">ul</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;tabs&#34;</span> <span class="o">:</span><span class="na">class</span><span class="o">=</span><span class="s">&#34;{[classPrefix + &#39;-tabs&#39;]: classPrefix}&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">li</span> <span class="nt">v-for</span><span class="s">=&#34;item in dataSource&#34;
</span><span class="s">        :key=&#34;item.type&#34;
</span><span class="s">        :class=&#34;liClass(item)&#34;
</span><span class="s">        @click=&#34;select(item)&#34;
</span><span class="s">        class=&#34;tabs-item&#34;
</span><span class="s">        :style=&#34;{height: tabsHeight}&#34;&gt;
</span><span class="s">      {{ item.text }}
</span><span class="s">    &lt;/li&gt;
</span><span class="s">  &lt;/ul&gt;
</span><span class="s">&lt;/template&gt;
</span><span class="s">
</span><span class="s">&lt;script lang=&#34;ts&#34;</span><span class="p">&gt;</span>
<span class="na">...</span>
  <span class="err">@</span><span class="na">Prop</span><span class="err">(</span><span class="p">{</span><span class="na">type</span><span class="o">:</span> <span class="na">String</span><span class="err">,</span> <span class="na">default</span><span class="o">:</span> <span class="err">&#39;</span><span class="na">64px</span><span class="err">&#39;</span><span class="p">}</span><span class="err">)</span> <span class="na">tabsHeight</span><span class="err">!</span><span class="o">:</span> <span class="na">string</span><span class="err">;</span>
<span class="na">...</span>
<span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>

<span class="p">&lt;</span><span class="nt">style</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;scss&#34;</span> <span class="na">scoped</span><span class="p">&gt;</span>
<span class="p">.</span><span class="nx">tabs</span> <span class="p">{</span>
  <span class="nx">background</span><span class="o">:</span> <span class="err">#</span><span class="nx">c4c4c4</span><span class="p">;</span>
  <span class="nx">display</span><span class="o">:</span> <span class="nx">flex</span><span class="p">;</span>
  <span class="nx">text</span><span class="o">-</span><span class="nx">align</span><span class="o">:</span> <span class="nx">center</span><span class="p">;</span>
  <span class="o">&amp;-</span><span class="nx">item</span> <span class="p">{</span>
    <span class="nx">font</span><span class="o">-</span><span class="nx">size</span><span class="o">:</span> <span class="mi">24</span><span class="nx">px</span><span class="p">;</span>
    <span class="nx">width</span><span class="o">:</span> <span class="mi">50</span><span class="o">%</span><span class="p">;</span>
    <span class="c1">// height: 64px;
</span><span class="c1"></span>    <span class="nx">display</span><span class="o">:</span> <span class="nx">flex</span><span class="p">;</span>
    <span class="nx">justify</span><span class="o">-</span><span class="nx">content</span><span class="o">:</span> <span class="nx">center</span><span class="p">;</span>
    <span class="nx">align</span><span class="o">-</span><span class="nx">items</span><span class="o">:</span> <span class="nx">center</span><span class="p">;</span>
    <span class="nx">position</span><span class="o">:</span> <span class="nx">relative</span><span class="p">;</span>
    <span class="o">&amp;</span><span class="p">.</span><span class="nx">selected</span> <span class="p">{</span>
      <span class="nx">background</span><span class="o">:</span> <span class="err">#</span><span class="nx">c4c4c4</span><span class="p">;</span>
      <span class="o">&amp;::</span><span class="nx">after</span> <span class="p">{</span>
        <span class="nx">content</span><span class="o">:</span> <span class="s2">&#34;&#34;</span><span class="p">;</span>
        <span class="nx">display</span><span class="o">:</span> <span class="nx">block</span><span class="p">;</span>
        <span class="nx">position</span><span class="o">:</span> <span class="nx">absolute</span><span class="p">;</span>
        <span class="nx">bottom</span><span class="o">:</span> <span class="mi">0</span><span class="p">;</span>
        <span class="nx">left</span><span class="o">:</span> <span class="mi">0</span><span class="p">;</span>
        <span class="nx">width</span><span class="o">:</span> <span class="mi">100</span><span class="o">%</span><span class="p">;</span>
        <span class="nx">height</span><span class="o">:</span> <span class="mi">4</span><span class="nx">px</span><span class="p">;</span>
        <span class="nx">background</span><span class="o">:</span> <span class="err">#</span><span class="mi">333</span><span class="p">;</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">&lt;/</span><span class="nt">style</span><span class="p">&gt;</span>

</code></pre></td></tr></table>
</div>
</div><blockquote>
<p><code>Statistic.vue</code></p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-vue" data-lang="vue"><span class="p">&lt;</span><span class="nt">template</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">Layout</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;statistics&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">Tabs</span> <span class="na">class</span><span class="nt">-prefix</span><span class="err">=&#34;</span><span class="na">type</span><span class="err">&#34;</span> <span class="nt">:data-source</span><span class="s">=&#34;recordTypeList&#34;</span> <span class="nt">:type.sync</span><span class="s">=&#34;type&#34;</span><span class="p">/&gt;</span>
    <span class="p">&lt;</span><span class="nt">Tabs</span> <span class="na">class</span><span class="nt">-prefix</span><span class="err">=&#34;</span><span class="na">interval</span><span class="err">&#34;</span> <span class="nt">:data-source</span><span class="s">=&#34;intervalList&#34;</span> <span class="nt">:type.sync</span><span class="s">=&#34;interval&#34;</span> <span class="na">tabs</span><span class="nt">-height</span><span class="err">=&#34;</span><span class="na">48px</span><span class="err">&#34;</span><span class="p">/&gt;</span>
    <span class="nx">type</span><span class="o">:</span> <span class="p">{{</span> <span class="nx">type</span> <span class="p">}}</span>
    <span class="p">&lt;</span><span class="nt">br</span><span class="p">&gt;</span>
    <span class="nx">interval</span><span class="o">:</span> <span class="p">{{</span> <span class="nx">interval</span> <span class="p">}}</span>
  <span class="p">&lt;/</span><span class="nt">Layout</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">template</span><span class="p">&gt;</span>

<span class="p">...</span>
<span class="p">&lt;</span><span class="nt">style</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;scss&#34;</span> <span class="na">scoped</span><span class="p">&gt;</span>
<span class="p">.</span><span class="nx">statistics</span> <span class="p">{</span>
  <span class="o">::</span><span class="nx">v</span><span class="o">-</span><span class="nx">deep</span> <span class="p">{</span>
    <span class="p">.</span><span class="nx">type</span><span class="o">-</span><span class="nx">tabs</span><span class="o">-</span><span class="nx">item</span> <span class="p">{</span>
      <span class="nx">background</span><span class="o">:</span> <span class="err">#</span><span class="nx">fff</span><span class="p">;</span>
      <span class="nx">position</span><span class="o">:</span> <span class="nx">relative</span><span class="p">;</span>
      <span class="o">&amp;</span><span class="p">.</span><span class="nx">selected</span> <span class="p">{</span>
        <span class="nx">background</span><span class="o">:</span> <span class="err">#</span><span class="nx">c4c4c4</span><span class="p">;</span>
        <span class="o">&amp;::</span><span class="nx">after</span> <span class="p">{</span>
          <span class="nx">display</span><span class="o">:</span> <span class="nx">none</span><span class="p">;</span>
          <span class="p">}</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">.</span><span class="nx">interval</span><span class="o">-</span><span class="nx">tabs</span><span class="o">-</span><span class="nx">item</span> <span class="p">{</span>
      <span class="c1">// height: 48px;
</span><span class="c1"></span>      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">&lt;/</span><span class="nt">style</span><span class="p">&gt;</span>

</code></pre></td></tr></table>
</div>
</div><ul>
<li>可以直接使用SCSS样式控制，也可以使用TS 配置组件默认 height</li>
<li>但不推荐，会造成逻辑与样式耦合</li>
</ul>
<hr>
<h2 id="用列表展示数据">用列表展示数据</h2>
<h3 id="结构">结构</h3>
<blockquote>
<p>结构类似于无根节点的树<code>trees</code></p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-JavaScript" data-lang="JavaScript"><span class="p">[</span>
<span class="p">{</span><span class="nx">title</span><span class="o">:</span><span class="s1">&#39;今天&#39;</span><span class="p">,</span> <span class="nx">items</span><span class="o">:</span> <span class="p">[</span><span class="nx">r1</span><span class="p">,</span> <span class="nx">r2</span><span class="p">,</span> <span class="p">...]},</span>
<span class="p">{</span><span class="nx">title</span><span class="o">:</span><span class="s1">&#39;明天&#39;</span><span class="p">,</span> <span class="nx">items</span><span class="o">:</span> <span class="p">[</span><span class="nx">r3</span><span class="p">,</span> <span class="nx">r4</span><span class="p">,</span> <span class="nx">r5</span><span class="p">,</span> <span class="p">...]},</span>
<span class="p">{</span><span class="nx">title</span><span class="o">:</span><span class="s1">&#39;昨天&#39;</span><span class="p">,</span> <span class="nx">items</span><span class="o">:</span> <span class="p">[</span><span class="nx">r6</span><span class="p">,</span> <span class="nx">r7</span><span class="p">,</span> <span class="p">...]}</span>
<span class="p">]</span>
<span class="cm">/*
</span><span class="cm">recordList
</span><span class="cm">1 r1
</span><span class="cm">1 r2
</span><span class="cm">2 r3
</span><span class="cm">2 r4
</span><span class="cm">2 r5
</span><span class="cm">3 r6
</span><span class="cm">3 r7
</span><span class="cm">*/</span>

<span class="p">[</span>
<span class="p">{</span><span class="nx">title</span><span class="o">:</span><span class="s1">&#39;20xx-xx-02&#39;</span><span class="p">,</span> <span class="nx">items</span><span class="o">:</span> <span class="p">[</span><span class="nx">r1</span><span class="p">,</span> <span class="nx">r2</span><span class="p">,</span> <span class="p">...]},</span>
<span class="p">{</span><span class="nx">title</span><span class="o">:</span><span class="s1">&#39;20xx-xx-02&#39;</span><span class="p">,</span> <span class="nx">items</span><span class="o">:</span> <span class="p">[</span><span class="nx">r3</span><span class="p">,</span> <span class="nx">r4</span><span class="p">,</span> <span class="nx">r5</span><span class="p">,</span> <span class="p">...]},</span>
<span class="p">{</span><span class="nx">title</span><span class="o">:</span><span class="s1">&#39;20xx-xx-01&#39;</span><span class="p">,</span> <span class="nx">items</span><span class="o">:</span> <span class="p">[</span><span class="nx">r6</span><span class="p">,</span> <span class="nx">r7</span><span class="p">,</span> <span class="p">...]}</span>
<span class="p">]</span>
<span class="c1">// 桶1 r1 r2
</span><span class="c1">// 桶2 r3 r4 r5
</span><span class="c1">// 桶3 r6 r7
</span></code></pre></td></tr></table>
</div>
</div><h3 id="步骤">步骤</h3>
<ul>
<li>首先使用钩子获取数据
<ul>
<li><code>beforeCreate() {this.$store.commit('fetchRecords');}</code></li>
</ul>
</li>
<li>使用计算属性操作数据，注意必须有返回值<code>return ...</code>
<ul>
<li><code>get recordList() {return ...}</code>获取记录列表，注意返回值类型</li>
<li><code>get result() {return ...}</code></li>
</ul>
</li>
<li>使用<strong>计数排序</strong> <strong>桶排序</strong>
<ul>
<li>使用<code>hashTable</code>存数据</li>
<li>大致结构 ：<code>list: []</code> + <code>type</code>/<code>interval: string</code> = <code>recordTrees: {title: string, items: RecordItem[]}[]</code></li>
<li>按天分组排序，在计算属性中写排序逻辑
<ul>
<li><code>get result() {}</code></li>
</ul>
</li>
</ul>
</li>
</ul>
<hr>
<h3 id="隐藏的bug">隐藏的bug</h3>
<blockquote>
<p>注意<code>recordList</code>的类型，即使已经声明类型，<code>recordList: RecordItem[]</code>，<code>recordList</code>类型为<code>any</code></p>
</blockquote>
<ul>
<li><code>Vuex</code>类型上的<code>bug</code>，在得到<code>this.$store</code>时，并不能返回正确的类型，导致得到的<code>store</code>返回的类型永远是<code>any</code></li>
<li><code>Vuex</code>并不能像之前自己使用<code>models</code>里数据时声明数据类型<code>tagListModel</code></li>
<li>注意<code>recordList[i].createdAt</code>属性的类型</li>
<li>每次都强制类型断言 <code>as RootState</code>
<ul>
<li><code>get recorList() {return (this.$store.state as RootState).recordList;}</code></li>
<li>此时的返回值<code>recordList</code>的类型显示正确为<code>RecordItem[]</code></li>
<li>属性<code>recordList[i].createdAt</code>的类型显示为<code>Date | undefined</code>，但需要的是字符串，字符串才可以分割操作</li>
</ul>
</li>
</ul>
<blockquote>
<p><code>Date</code>类型不能被<code>JSON.stringify</code>序列化</p>
</blockquote>
<ul>
<li>当使用<code>JSON.parse()</code>无法保证左右两边的类型是相同的
<ul>
<li><code>state.recordList = JSON.parse(window.localStorage.getItem('recordList') ?? '[]') as RecordItem[];</code></li>
<li><code>JSON.parse()</code>返回的是<code>any</code>类型</li>
<li><code>recordList</code>强制定义类型为<code>recordItem[]</code>，只在运行时才得到</li>
<li><code>JSON</code>不支持<code>Date</code>等内置对象，会转成<code>string</code>但不是所需要的</li>
</ul>
</li>
<li><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/JSON/stringify#%E6%8F%8F%E8%BF%B0"><code>Date</code> 日期调用了 <code>toJSON()</code> 将其转换为了 <code>string</code> 字符串（同<code>Date.toISOString()</code>），因此会被当做字符串处</a></li>
</ul>
<blockquote>
<p><code>toISOString()</code>特指<code>ISO8601</code></p>
</blockquote>
<ul>
<li>类型声明<code>type RecordItem = {tags: string[]; tips: string; type: string; amount: number; createdAt?: Date;}</code>中的<code>createdAt?: Date;</code>改为<code>createdAt?: String;</code></li>
<li>查看所有引用<code>createdAt</code>，TS 编译报错</li>
<li>将所有改成<code>*.createdAt = new Date().toISOSting()</code></li>
</ul>
<blockquote>
<p>标记问题：这是<code>vue</code>和<code>TS</code>配合不好的地方</p>
</blockquote>
<ul>
<li>在<code>src/store/index.ts</code>中声明的<code>store</code>类型是<code>&lt;RootState&gt;</code>
<ul>
<li>之前将<code>state</code>的类型进行断言<code>state: {tagList: [], recordList: [], currentTag: undefined} as RootState,</code></li>
</ul>
</li>
<li>查看源码<code>vuex/types/vue.d.ts</code>
<ul>
<li><code>declare module &quot;vue/type/vue&quot; {interface Vue {$store: Store&lt;any&gt;}}</code>写死类型是<code>&lt;any&gt;</code></li>
</ul>
</li>
</ul>
<hr>
<h3 id="使用计算属性computed操作展示数据">使用计算属性<code>computed</code>操作展示数据</h3>
<blockquote>
<p>TS声明空对象类型</p>
</blockquote>
<ul>
<li>分别声明空对象的键和值的类型</li>
<li><code>const hashTable: { [key: string]: RecordItem[] } = {};</code></li>
</ul>
<blockquote>
<p>使用<code>hashTable</code>存数据</p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-TypeScript" data-lang="TypeScript"><span class="p">...</span>
<span class="kr">get</span> <span class="nx">result() {</span>
    <span class="kr">const</span> <span class="p">{</span><span class="nx">recordList</span><span class="p">}</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
    <span class="kr">const</span> <span class="nx">hashTable</span><span class="o">:</span> <span class="p">{</span> <span class="p">[</span><span class="nx">key</span>: <span class="kt">string</span><span class="p">]</span><span class="o">:</span> <span class="nx">RecordItem</span><span class="p">[]</span> <span class="p">}</span> <span class="o">=</span> <span class="p">{};</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">recordList</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// ISO8601 // new Date().toISOString()
</span><span class="c1"></span>      <span class="c1">// recordList[i].createdAt!.split(&#39;T&#39;); // 2021-02-24T04:00:00
</span><span class="c1"></span>      <span class="c1">// const [date, time] = recordList[i].createdAt!.split(&#39;T&#39;);
</span><span class="c1"></span>      <span class="kr">const</span> <span class="p">[</span><span class="nx">date</span><span class="p">,]</span> <span class="o">=</span> <span class="nx">recordList</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">createdAt</span><span class="o">!</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s1">&#39;T&#39;</span><span class="p">);</span>
      <span class="nx">hashTable</span><span class="p">[</span><span class="nx">date</span><span class="p">]</span> <span class="o">=</span> <span class="nx">hashTable</span><span class="p">[</span><span class="nx">date</span><span class="p">]</span> <span class="o">||</span> <span class="p">[];</span>
      <span class="nx">hashTable</span><span class="p">[</span><span class="nx">date</span><span class="p">].</span><span class="nx">push</span><span class="p">(</span><span class="nx">recordList</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&#34;hashTable[date]&#34;</span><span class="p">);</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">hashTable</span><span class="p">[</span><span class="nx">date</span><span class="p">]);</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;-------------&#39;</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nx">hashTable</span><span class="p">;</span>
<span class="p">}</span>
<span class="p">...</span>
</code></pre></td></tr></table>
</div>
</div><ul>
<li><code>recordList[i].createdAt!.split('T');</code>：
<ul>
<li>判断拿到数据后，取出的值<code>createdAt</code>一定存在，加上强制类型断言<code>createdAt!.*</code></li>
<li><code>ESLint</code> 报错就取消全局类型声明<code>custom.d.ts</code>中<code>type RecordItem</code>的<code>createdAt?: string;</code>，改为<code>createdAt: string;</code></li>
</ul>
</li>
<li>解构<code>const [date, time] = recordList[i].createdAt!.split('T');</code>
<ul>
<li><code>T</code>的前面是日期，后面是时间</li>
<li><code>ESLint</code> 报错<code>time</code>未使用就先删除<code>time</code></li>
</ul>
</li>
<li>类似计数排序：初始化<code>hashTable[date] = hashTable[date] || [];</code></li>
<li>推入数据<code>hashTable[date].push(recordList[i]);</code></li>
<li>尝试打印出<code>console.log(hashTable)</code>或在视图中临时写上数据<code>{{xxx}}</code></li>
<li>查看每项的内容</li>
</ul>
<blockquote>
<p>发现一开始的<code>hashTable</code>声明类型结构错误</p>
</blockquote>
<ul>
<li>避免类型声明结构混乱，定义一个中间类型，先声明哈希表值的类型：<code>type HashTableValue = { title: string; items: RecordItem[] };</code></li>
<li>初始化声明哈希表改为<code>const hashTable: { [HashTableKey: string]: HashTableValue } = {};</code>
<ul>
<li><code>HashTableKey</code>命名可为任意字符串，但从所需的结构上看，表示的是日期<code>date</code></li>
<li>按日期分组</li>
</ul>
</li>
<li>遍历取到的计算属性<code>recordList</code>：<code>for (let i = 0; i &lt; recordList.length; i++) {...}</code>
<ul>
<li>取出日期<code>const [date,] = recordList[i].createdAt.split('T');</code></li>
<li>将每次取出的日期<code>date</code>作为<code>hashTable</code>的属性名<code>hashTable[date]</code></li>
<li>初始化<code>hashTable</code>：<code>hashTable[date] = hashTable[date] || {title: date, items: []};</code>
<ul>
<li>将<code>hashTable[date]</code>对应的属性值赋值到<code>hashTable</code>的<code>[date]</code>属性上</li>
<li>保底值为<code>{title: date, items: []}</code></li>
</ul>
</li>
<li>在每项的<code>items</code>中推入遍历的数据（<code>recordList[i]</code>数组）
<ul>
<li><code>hashTable[date].items.push(recordList[i]);</code></li>
</ul>
</li>
</ul>
</li>
<li>返回值<code>hashTable</code></li>
</ul>
<blockquote>
<p><code>Statistics.vue</code></p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-HTML" data-lang="HTML">...
<span class="p">&lt;</span><span class="nt">script</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;ts&#34;</span><span class="p">&gt;</span>
<span class="kr">import</span> <span class="nx">Vue</span> <span class="nx">from</span> <span class="s1">&#39;vue&#39;</span><span class="p">;</span>
<span class="kr">import</span> <span class="p">{</span><span class="nx">Component</span><span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;vue-property-decorator&#39;</span><span class="p">;</span>
<span class="kr">import</span> <span class="nx">Tabs</span> <span class="nx">from</span> <span class="s1">&#39;@/components/Tabs.vue&#39;</span><span class="p">;</span>
<span class="kr">import</span> <span class="nx">recordTypeList</span> <span class="nx">from</span> <span class="s1">&#39;@/constants/recordTypeList&#39;</span><span class="p">;</span>
<span class="kr">import</span> <span class="nx">intervalList</span> <span class="nx">from</span> <span class="s1">&#39;@/constants/intervalList&#39;</span><span class="p">;</span>

<span class="err">@</span><span class="nx">Component</span><span class="p">({</span>
  <span class="nx">components</span><span class="o">:</span> <span class="p">{</span><span class="nx">Tabs</span><span class="p">}</span>
<span class="p">})</span>
<span class="kr">export</span> <span class="k">default</span> <span class="kr">class</span> <span class="nx">Statistics</span> <span class="kr">extends</span> <span class="nx">Vue</span> <span class="p">{</span>
  <span class="nx">type</span> <span class="o">=</span> <span class="s1">&#39;-&#39;</span><span class="p">;</span>
  <span class="nx">interval</span> <span class="o">=</span> <span class="s1">&#39;day&#39;</span><span class="p">;</span>
  <span class="nx">intervalList</span> <span class="o">=</span> <span class="nx">intervalList</span><span class="p">;</span>
  <span class="nx">recordTypeList</span> <span class="o">=</span> <span class="nx">recordTypeList</span><span class="p">;</span>

  <span class="nx">get</span> <span class="nx">recordList</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">$store</span><span class="p">.</span><span class="nx">state</span> <span class="nx">as</span> <span class="nx">RootState</span><span class="p">).</span><span class="nx">recordList</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="nx">get</span> <span class="nx">result</span><span class="p">()</span> <span class="p">{</span>
    <span class="kr">const</span> <span class="p">{</span><span class="nx">recordList</span><span class="p">}</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
    <span class="nx">type</span> <span class="nx">HashTableValue</span> <span class="o">=</span> <span class="p">{</span> <span class="nx">title</span><span class="o">:</span> <span class="nx">string</span><span class="p">;</span> <span class="nx">items</span><span class="o">:</span> <span class="nx">RecordItem</span><span class="p">[]</span> <span class="p">};</span>
    <span class="kr">const</span> <span class="nx">hashTable</span><span class="o">:</span> <span class="p">{</span> <span class="p">[</span><span class="nx">HashTableKey</span><span class="o">:</span> <span class="nx">string</span><span class="p">]</span><span class="o">:</span> <span class="nx">HashTableValue</span> <span class="p">}</span> <span class="o">=</span> <span class="p">{};</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">recordList</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="kr">const</span> <span class="p">[</span><span class="nx">date</span><span class="p">,]</span> <span class="o">=</span> <span class="nx">recordList</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">createdAt</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s1">&#39;T&#39;</span><span class="p">);</span>
      <span class="nx">hashTable</span><span class="p">[</span><span class="nx">date</span><span class="p">]</span> <span class="o">=</span> <span class="nx">hashTable</span><span class="p">[</span><span class="nx">date</span><span class="p">]</span> <span class="o">||</span> <span class="p">{</span><span class="nx">title</span><span class="o">:</span> <span class="nx">date</span><span class="p">,</span> <span class="nx">items</span><span class="o">:</span> <span class="p">[]};</span>
      <span class="nx">hashTable</span><span class="p">[</span><span class="nx">date</span><span class="p">].</span><span class="nx">items</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">recordList</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">hashTable</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nx">hashTable</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="nx">beforeCreate</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">$store</span><span class="p">.</span><span class="nx">commit</span><span class="p">(</span><span class="s1">&#39;fetchRecords&#39;</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
<span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
...
</code></pre></td></tr></table>
</div>
</div><hr>
<h3 id="循环渲染">循环渲染</h3>
<blockquote>
<p><code>Statistics.vue</code></p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-vue" data-lang="vue"><span class="p">&lt;</span><span class="nt">template</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">Layout</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;statistics&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">Tabs</span> <span class="na">class</span><span class="nt">-prefix</span><span class="err">=&#34;</span><span class="na">type</span><span class="err">&#34;</span> <span class="nt">:data-source</span><span class="s">=&#34;recordTypeList&#34;</span> <span class="nt">:type.sync</span><span class="s">=&#34;type&#34;</span><span class="p">/&gt;</span>
    <span class="p">&lt;</span><span class="nt">Tabs</span> <span class="na">class</span><span class="nt">-prefix</span><span class="err">=&#34;</span><span class="na">interval</span><span class="err">&#34;</span> <span class="nt">:data-source</span><span class="s">=&#34;intervalList&#34;</span> <span class="nt">:type.sync</span><span class="s">=&#34;interval&#34;</span> <span class="na">tabs</span><span class="nt">-height</span><span class="err">=&#34;</span><span class="na">48px</span><span class="err">&#34;</span><span class="p">/&gt;</span>
    <span class="nx">type</span><span class="o">:</span> <span class="p">{{</span> <span class="nx">type</span> <span class="p">}}</span>
    <span class="p">&lt;</span><span class="nt">br</span><span class="p">&gt;</span>
    <span class="nx">interval</span><span class="o">:</span> <span class="p">{{</span> <span class="nx">interval</span> <span class="p">}}</span>
    <span class="p">&lt;</span><span class="nt">hr</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">div</span><span class="p">&gt;</span>
      <span class="p">&lt;</span><span class="nt">ol</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">li</span> <span class="nt">v-for</span><span class="s">=&#34;(value, name, index) in result&#34; </span><span class="nt">:key</span><span class="s">=&#34;name&#34;</span><span class="p">&gt;</span>
          <span class="p">&lt;</span><span class="nt">h3</span><span class="p">&gt;{{</span> <span class="nx">index</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">}}</span><span class="err">：</span><span class="p">{{</span> <span class="nx">value</span><span class="p">.</span><span class="nx">title</span> <span class="p">}}&lt;/</span><span class="nt">h3</span><span class="p">&gt;</span>
          <span class="p">&lt;</span><span class="nt">ol</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">li</span> <span class="nt">v-for</span><span class="s">=&#34;item in value.items&#34; :key=&#34;item.id&#34;</span><span class="p">&gt;</span>
              <span class="p">{{</span> <span class="na">item.amount</span> <span class="p">}}</span> <span class="p">{{</span> <span class="na">item.createdAt</span> <span class="p">}}</span>
            <span class="p">&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
          <span class="p">&lt;/</span><span class="nt">ol</span><span class="p">&gt;</span>
        <span class="p">&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
      <span class="p">&lt;/</span><span class="nt">ol</span><span class="p">&gt;</span>
    <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
  <span class="p">&lt;/</span><span class="nt">Layout</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">template</span><span class="p">&gt;</span>
<span class="na">...</span>
</code></pre></td></tr></table>
</div>
</div><ul>
<li><code>result</code>返回的是<code>hashTable</code>，<a href="https://cn.vuejs.org/v2/guide/list.html#%E5%9C%A8-v-for-%E9%87%8C%E4%BD%BF%E7%94%A8%E5%AF%B9%E8%B1%A1">在 v-for 里使用对象</a>，遍历<code>hashTable</code>的 <code>property</code></li>
<li><code>&lt;li v-for=&quot;(value, name) in result&quot; :key=&quot;index&quot;&gt;{{ value }}&lt;/li&gt;</code></li>
<li>必须写<a href="https://cn.vuejs.org/v2/api/#key"><code>:key</code></a> DOM diff 算法让<code>Vue</code>正确识别不同的<code>DOM</code>，正确的复用
<ul>
<li>给 Vue 一个提示，以便它能跟踪每个节点的身份，从而复用和重新排序现有元素，需要为每项提供一个唯一 <code>key attribute</code></li>
<li>这里可以使用唯一属性名作为<code>:key</code></li>
</ul>
</li>
<li><strong>key值是必须唯一的</strong>，如果重复就会报错，<code>Dupliacated key detected NaN</code></li>
<li>取到的<code>value</code>也是一个对象（表示<code>RecordItem</code>）</li>
<li>第二层循环<code>&lt;li v-for=&quot;item in group.items&quot; :key=&quot;item.id&quot;&gt;{{ item.amount }} {{ item.createdAt }}&lt;/li&gt;</code></li>
</ul>
<blockquote>
<p>未实现按类型（支出/收入）和排序的逻辑</p>
</blockquote>
<hr>
<h2 id="完善并添加statisticvue-scss">完善并添加<code>Statistic.vue</code> SCSS</h2>
<ul>
<li>注意样式加了<code>scope</code>属性，只影响当前组件的标签，不会深入组件标签继续影响内部结构</li>
<li>使用深度作用选择器<code>/deep/</code>（CSS）或<code>::v-deep</code>（SCSS）</li>
<li>不用<code>min-height</code>来撑开，改用<code>line-height</code>和<code>padding</code>来撑开高度</li>
</ul>
<blockquote>
<p>格式化显示<code>item.tags</code></p>
</blockquote>
<ul>
<li><code>custom.d.ts</code>中改为<code>type RecordItem = { tags: {id: string; name: string}, ...} }[];</code></li>
</ul>
<blockquote>
<p>显示<code>xx年xx月xx日</code></p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-vue" data-lang="vue"><span class="p">&lt;</span><span class="nt">template</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">Layout</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;statistics&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">Tabs</span> <span class="na">class</span><span class="nt">-prefix</span><span class="err">=&#34;</span><span class="na">type</span><span class="err">&#34;</span> <span class="nt">:data-source</span><span class="s">=&#34;recordTypeList&#34;</span> <span class="nt">:type.sync</span><span class="s">=&#34;type&#34;</span><span class="p">/&gt;</span>
    <span class="p">&lt;</span><span class="nt">Tabs</span> <span class="na">class</span><span class="nt">-prefix</span><span class="err">=&#34;</span><span class="na">interval</span><span class="err">&#34;</span> <span class="nt">:data-source</span><span class="s">=&#34;intervalList&#34;</span> <span class="nt">:type.sync</span><span class="s">=&#34;interval&#34;</span> <span class="na">tabs</span><span class="nt">-height</span><span class="err">=&#34;</span><span class="na">48px</span><span class="err">&#34;</span><span class="p">/&gt;</span>
    <span class="p">&lt;</span><span class="nt">ol</span><span class="p">&gt;</span>
      <span class="p">&lt;</span><span class="nt">li</span> <span class="nt">v-for</span><span class="s">=&#34;(value, name, index) in result&#34; </span><span class="nt">:key</span><span class="s">=&#34;name&#34;</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">h3</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;title&#34;</span><span class="p">&gt;{{</span> <span class="nx">index</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">}}</span><span class="err">：</span><span class="p">{{</span> <span class="nx">value</span><span class="p">.</span><span class="nx">title</span> <span class="p">}}&lt;/</span><span class="nt">h3</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">ol</span><span class="p">&gt;</span>
          <span class="p">&lt;</span><span class="nt">li</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;record&#34;</span> <span class="nt">v-for</span><span class="s">=&#34;item in value.items&#34; :key=&#34;item.id&#34;&gt;
</span><span class="s">            &lt;span class=&#34;recordTag&#34;&gt;{{ tagToString(item.tags) }}&lt;/span&gt;
</span><span class="s">            &lt;div class=&#34;notes&#34;&gt;
</span><span class="s">              &lt;span class=&#34;tips&#34;&gt;备注：&lt;/span&gt;&lt;span class=&#34;text&#34;</span><span class="p">&gt;{{</span> <span class="na">item.tips</span> <span class="p">}}&lt;/</span><span class="nt">span</span><span class="p">&gt;</span>
            <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">span</span><span class="p">&gt;</span><span class="err">￥</span> <span class="p">{{</span> <span class="nx">item</span><span class="p">.</span><span class="nx">amount</span> <span class="p">}}&lt;/</span><span class="nt">span</span><span class="p">&gt;</span>
          <span class="p">&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
        <span class="p">&lt;/</span><span class="nt">ol</span><span class="p">&gt;</span>
      <span class="p">&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
    <span class="p">&lt;/</span><span class="nt">ol</span><span class="p">&gt;</span>
  <span class="p">&lt;/</span><span class="nt">Layout</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">template</span><span class="p">&gt;</span>
<span class="p">...</span>
<span class="p">&lt;</span><span class="nt">style</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;scss&#34;</span> <span class="na">scoped</span><span class="p">&gt;</span>
<span class="err">@</span><span class="kr">import</span> <span class="s2">&#34;~@/assets/style/global.scss&#34;</span><span class="p">;</span>
<span class="p">.</span><span class="nx">statistics</span> <span class="p">{</span>
  <span class="o">%</span><span class="nx">item</span> <span class="p">{</span>
    <span class="nx">padding</span><span class="o">:</span> <span class="mi">8</span><span class="nx">px</span> <span class="mi">16</span><span class="nx">px</span><span class="p">;</span>
    <span class="nx">line</span><span class="o">-</span><span class="nx">height</span><span class="o">:</span> <span class="mi">24</span><span class="nx">px</span><span class="p">;</span>
    <span class="c1">//min-height: 40px;
</span><span class="c1"></span>    <span class="nx">display</span><span class="o">:</span> <span class="nx">flex</span><span class="p">;</span>
    <span class="nx">justify</span><span class="o">-</span><span class="nx">content</span><span class="o">:</span> <span class="nx">space</span><span class="o">-</span><span class="nx">between</span><span class="p">;;</span>
    <span class="nx">align</span><span class="o">-</span><span class="nx">items</span><span class="o">:</span> <span class="nx">center</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="o">::</span><span class="nx">v</span><span class="o">-</span><span class="nx">deep</span> <span class="p">{</span>
    <span class="p">.</span><span class="nx">type</span><span class="o">-</span><span class="nx">tabs</span><span class="o">-</span><span class="nx">item</span> <span class="p">{</span>
      <span class="nx">background</span><span class="o">:</span> <span class="err">#</span><span class="nx">fff</span><span class="p">;</span>
      <span class="nx">position</span><span class="o">:</span> <span class="nx">relative</span><span class="p">;</span>
      <span class="o">&amp;</span><span class="p">.</span><span class="nx">selected</span> <span class="p">{</span>
        <span class="nx">background</span><span class="o">:</span> <span class="err">#</span><span class="nx">c4c4c4</span><span class="p">;</span>
        <span class="o">&amp;::</span><span class="nx">after</span> <span class="p">{</span>
          <span class="nx">display</span><span class="o">:</span> <span class="nx">none</span><span class="p">;</span>
          <span class="p">}</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">.</span><span class="nx">interval</span><span class="o">-</span><span class="nx">tabs</span><span class="o">-</span><span class="nx">item</span> <span class="p">{</span>
      <span class="c1">// height: 48px;
</span><span class="c1"></span>      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">.</span><span class="nx">title</span> <span class="p">{</span>
    <span class="err">@</span><span class="nx">extend</span> <span class="o">%</span><span class="nx">item</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">.</span><span class="nx">record</span> <span class="p">{</span>
    <span class="nx">background</span><span class="o">:</span> <span class="err">#</span><span class="nx">fff</span><span class="p">;</span>
    <span class="err">@</span><span class="nx">extend</span> <span class="o">%</span><span class="nx">item</span><span class="p">;</span>
    <span class="p">.</span><span class="nx">recordTag</span> <span class="p">{</span>
      <span class="err">@</span><span class="nx">include</span> <span class="nx">multiline</span><span class="o">-</span><span class="nx">ellipsis</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">40</span><span class="nx">px</span><span class="p">,</span> <span class="mi">5</span><span class="nx">em</span><span class="p">);</span>
      <span class="p">}</span>
    <span class="p">.</span><span class="nx">notes</span> <span class="p">{</span>
      <span class="nx">display</span><span class="o">:</span> <span class="nx">flex</span><span class="p">;</span>
      <span class="nx">margin</span><span class="o">-</span><span class="nx">right</span><span class="o">:</span> <span class="nx">auto</span><span class="p">;</span>
      <span class="nx">margin</span><span class="o">-</span><span class="nx">left</span><span class="o">:</span> <span class="mi">16</span><span class="nx">px</span><span class="p">;</span>
      <span class="nx">color</span><span class="o">:</span> <span class="err">#</span><span class="mi">999</span><span class="p">;</span>
      <span class="p">.</span><span class="nx">tips</span> <span class="p">{</span>
        <span class="err">@</span><span class="nx">include</span> <span class="nx">multiline</span><span class="o">-</span><span class="nx">ellipsis</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">40</span><span class="nx">px</span><span class="p">,</span> <span class="mi">3</span><span class="nx">em</span><span class="p">);</span>
        <span class="p">}</span>
      <span class="p">.</span><span class="nx">text</span> <span class="p">{</span>
        <span class="err">@</span><span class="nx">include</span> <span class="nx">multiline</span><span class="o">-</span><span class="nx">ellipsis</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">40</span><span class="nx">px</span><span class="p">,</span> <span class="mi">3</span><span class="nx">em</span><span class="p">);</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">&lt;/</span><span class="nt">style</span><span class="p">&gt;</span>

</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>是否超出 存储最大值</p>
</blockquote>
<ul>
<li><code>localStorage</code>的最大存储为<code>5MB</code>左右</li>
<li>使用<code>IndexedDB</code></li>
</ul>
<blockquote>
<p>是否超出最大显示行数</p>
</blockquote>
<ul>
<li>引入<code>global.scss</code>使用<code>mixin</code>封装的超出文字省略</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-SCSS" data-lang="SCSS"><span class="nc">...</span>
<span class="o">//</span> <span class="nt">mixins</span> <span class="nt">text</span> <span class="nt">overflow</span>
<span class="o">@</span><span class="nt">mixin</span> <span class="nt">multiline-ellipsis</span><span class="o">(</span><span class="err">$</span><span class="nt">line</span><span class="nd">:</span> <span class="nt">2</span><span class="o">,</span> <span class="err">$</span><span class="nt">line-height</span><span class="nd">:</span> <span class="nt">1</span><span class="nc">.6em</span><span class="o">,</span> <span class="err">$</span><span class="nt">max-width</span><span class="nd">:</span> <span class="nt">5em</span><span class="o">)</span> <span class="p">{</span>
  <span class="c1">//white-space: nowrap;
</span><span class="c1"></span>  <span class="na">word-break</span><span class="o">:</span> <span class="ni">break-word</span><span class="p">;</span>
  <span class="na">overflow</span><span class="o">:</span> <span class="ni">hidden</span><span class="p">;</span>
  <span class="na">text-overflow</span><span class="o">:</span> <span class="ni">ellipsis</span><span class="p">;</span>
  <span class="na">display</span><span class="o">:</span> <span class="o">-</span><span class="n">webkit-box</span><span class="p">;</span>
  <span class="na">-webkit-line-clamp</span><span class="o">:</span> <span class="nv">$line</span><span class="p">;</span>
  <span class="na">-webkit-box-orient</span><span class="o">:</span> <span class="ni">vertical</span><span class="p">;</span>
  <span class="na">line-height</span><span class="o">:</span> <span class="nv">$line-height</span><span class="p">;</span>
  <span class="na">max-height</span><span class="o">:</span> <span class="nv">$line-height</span> <span class="o">*</span> <span class="nv">$line</span><span class="p">;</span>
  <span class="na">max-width</span><span class="o">:</span> <span class="nv">$max-width</span><span class="p">;</span>
  <span class="p">}</span>

</code></pre></td></tr></table>
</div>
</div><hr>
<h2 id="iso8601-和-dayjs"><code>ISO8601</code> 和 <code>dayjs</code></h2>
<ul>
<li><a href="https://zh.wikipedia.org/wiki/ISO_8601#%E6%97%A5%E6%9C%9F%E5%92%8C%E6%97%B6%E9%97%B4%E7%9A%84%E7%BB%84%E5%90%88%E8%A1%A8%E7%A4%BA%E6%B3%95"><code>ISO8601</code></a></li>
<li>得到<code>ISO8601</code>
<ul>
<li><strong><code>const time = new Date().toISOString()</code></strong></li>
<li><code>const myTime = new Date(Date.parse(time))</code></li>
<li><code>myTime.getHours()</code></li>
</ul>
</li>
</ul>
<blockquote>
<p><a href="http://momentjs.cn/"><code>Moment.js</code></a> 或者<a href="https://moment.github.io/luxon/"><code>Luxon.js</code></a>体积较大</p>
</blockquote>
<ul>
<li><a href="https://inventi.studio/en/blog/why-you-shouldnt-use-moment-js">Why you shouldn&rsquo;t use Moment.js&hellip;</a></li>
<li>Vue.js min 才30k</li>
</ul>
<blockquote>
<p>使用<a href="https://dayjs.gitee.io/zh-CN/"><code>Day.js</code></a></p>
</blockquote>
<ul>
<li>安装<code>yarn add dayjs@1.8.20</code></li>
<li>引用包<code>import dayjs from 'dayjs';</code></li>
<li>查看<code>API</code>: <code>const api = dayjs();</code></li>
</ul>
<blockquote>
<p>正确显示<code>toISOString()</code>修正时差得到本地时间</p>
</blockquote>
<ul>
<li><code>toISOString()</code>会得到零时区而非本地（东八区）的时间</li>
<li><a href="https://stackoverflow.com/questions/10830357/javascript-toisostring-ignores-timezone-offset">How to ISO 8601 format a Date with Timezone Offset in JavaScript?</a></li>
<li>忽略时差<code>date.getTime() - (date.getTimezoneOffset() * 60000)</code></li>
<li>增加状态属性<code>localTimeStamp</code></li>
</ul>
<blockquote>
<p><code>src/store/index.ts</code></p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-TypeScript" data-lang="TypeScript"><span class="kr">import</span> <span class="p">...</span>

<span class="kr">const</span> <span class="nx">store</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Vuex</span><span class="p">.</span><span class="nx">Store</span><span class="p">&lt;</span><span class="nt">RootState</span><span class="p">&gt;({</span>
  <span class="nx">state</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">tagList</span><span class="o">:</span> <span class="p">[],</span>
    <span class="nx">recordList</span><span class="o">:</span> <span class="p">[],</span>
    <span class="nx">currentTag</span>: <span class="kt">undefined</span><span class="p">,</span>
    <span class="nx">localTimeStamp</span><span class="o">:</span> <span class="s1">&#39;&#39;</span>
  <span class="p">}</span> <span class="kr">as</span> <span class="nx">RootState</span><span class="p">,</span>
  <span class="nx">mutations</span><span class="o">:</span> <span class="p">{</span>
    <span class="p">...</span>
    <span class="nx">getLocalTimeStamp</span><span class="p">(</span><span class="nx">state</span><span class="p">)</span> <span class="p">{</span>
      <span class="kr">const</span> <span class="nx">date</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">();</span>
      <span class="k">return</span> <span class="nx">state</span><span class="p">.</span><span class="nx">localTimeStamp</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">(</span><span class="nx">date</span><span class="p">.</span><span class="nx">getTime</span><span class="p">()</span> <span class="o">-</span> <span class="p">(</span><span class="nx">date</span><span class="p">.</span><span class="nx">getTimezoneOffset</span><span class="p">()</span> <span class="o">*</span> <span class="mi">60000</span><span class="p">))</span>
        <span class="p">.</span><span class="nx">toISOString</span><span class="p">();</span>
    <span class="p">},</span>
    <span class="p">...</span>
<span class="p">});</span>
<span class="kr">export</span> <span class="k">default</span> <span class="nx">store</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p><code>src/custom.d.ts</code></p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-TypeScript" data-lang="TypeScript"><span class="p">...</span>
<span class="kr">type</span> <span class="nx">RootState</span> <span class="o">=</span> <span class="p">{</span>
  <span class="nx">tagList</span>: <span class="kt">Tag</span><span class="p">[];</span>
  <span class="nx">recordList</span>: <span class="kt">RecordItem</span><span class="p">[];</span>
  <span class="nx">currentTag?</span>: <span class="kt">Tag</span><span class="p">;</span>
  <span class="nx">localTimeStamp</span>: <span class="kt">string</span>
<span class="p">}</span>
<span class="p">...</span>
</code></pre></td></tr></table>
</div>
</div><hr>
<blockquote>
<p><code>Statistic.vue </code>改显示<code>xx年xx月xx日</code>为显示今天、明天、昨天、上周、上月、以前</p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-vue" data-lang="vue"><span class="p">&lt;</span><span class="nt">template</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">Layout</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;statistics&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">Tabs</span> <span class="na">class</span><span class="nt">-prefix</span><span class="err">=&#34;</span><span class="na">type</span><span class="err">&#34;</span> <span class="nt">:data-source</span><span class="s">=&#34;recordTypeList&#34;</span> <span class="nt">:type.sync</span><span class="s">=&#34;type&#34;</span><span class="p">/&gt;</span>
    <span class="p">&lt;</span><span class="nt">Tabs</span> <span class="na">class</span><span class="nt">-prefix</span><span class="err">=&#34;</span><span class="na">interval</span><span class="err">&#34;</span> <span class="nt">:data-source</span><span class="s">=&#34;intervalList&#34;</span> <span class="nt">:type.sync</span><span class="s">=&#34;interval&#34;</span> <span class="na">tabs</span><span class="nt">-height</span><span class="err">=&#34;</span><span class="na">48px</span><span class="err">&#34;</span><span class="p">/&gt;</span>
    <span class="p">&lt;</span><span class="nt">ol</span><span class="p">&gt;</span>
      <span class="p">&lt;</span><span class="nt">li</span> <span class="nt">v-for</span><span class="s">=&#34;(value, name, index) in result&#34; </span><span class="nt">:key</span><span class="s">=&#34;index&#34;</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">h3</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;title&#34;</span><span class="p">&gt;{{</span> <span class="nx">showDay</span><span class="p">(</span><span class="nx">value</span><span class="p">.</span><span class="nx">title</span><span class="p">)</span> <span class="p">}}&lt;/</span><span class="nt">h3</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">ol</span><span class="p">&gt;</span>
          <span class="p">&lt;</span><span class="nt">li</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;record&#34;</span> <span class="nt">v-for</span><span class="s">=&#34;item in value.items&#34; :key=&#34;item.id&#34;&gt;
</span><span class="s">            &lt;span class=&#34;recordTag&#34;&gt;{{ tagToString(item.tags) }}&lt;/span&gt;
</span><span class="s">            &lt;div class=&#34;notes&#34;&gt;
</span><span class="s">              &lt;span class=&#34;tips&#34;&gt;备注：&lt;/span&gt;&lt;span class=&#34;text&#34;&gt;{{ item.tips }}&lt;/span&gt;
</span><span class="s">            &lt;/div&gt;
</span><span class="s">            &lt;span&gt;￥ {{ item.amount }}&lt;/span&gt;
</span><span class="s">          &lt;/li&gt;
</span><span class="s">        &lt;/ol&gt;
</span><span class="s">      &lt;/li&gt;
</span><span class="s">    &lt;/ol&gt;
</span><span class="s">  &lt;/Layout&gt;
</span><span class="s">&lt;/template&gt;
</span><span class="s">
</span><span class="s">&lt;script lang=&#34;ts&#34;</span><span class="p">&gt;</span>
<span class="na">...</span>
<span class="na">import</span> <span class="na">dayjs</span> <span class="na">from</span> <span class="err">&#39;</span><span class="na">dayjs</span><span class="err">&#39;;</span>
<span class="na">...</span>
<span class="na">export</span> <span class="na">default</span> <span class="na">class</span> <span class="na">Statistics</span> <span class="na">extends</span> <span class="na">Vue</span> <span class="p">{</span>
  <span class="na">...</span>
  <span class="err">/*</span>
  <span class="err">//</span> <span class="na">对比原生</span> <span class="na">Date</span> <span class="na">写法</span>
  <span class="na">showDay</span><span class="err">(</span><span class="na">string</span><span class="o">:</span> <span class="na">string</span><span class="err">)</span> <span class="p">{</span>
    <span class="na">const</span> <span class="na">dt </span><span class="o">=</span> <span class="na">new</span> <span class="na">Date</span><span class="err">(</span><span class="na">Date.parse</span><span class="err">(</span><span class="na">string</span><span class="err">));</span>
    <span class="na">const</span> <span class="na">y </span><span class="o">=</span> <span class="na">dt.getFullYear</span><span class="err">();</span>
    <span class="na">const</span> <span class="na">m </span><span class="o">=</span> <span class="na">dt.getMonth</span><span class="err">();</span>
    <span class="na">const</span> <span class="na">d </span><span class="o">=</span> <span class="na">dt.getDate</span><span class="err">();</span>
    <span class="na">const</span> <span class="na">now </span><span class="o">=</span> <span class="na">new</span> <span class="na">Date</span><span class="err">();</span>
    <span class="na">if</span> <span class="err">(</span><span class="na">now.getFullYear</span><span class="err">()</span> <span class="err">===</span> <span class="na">y</span> <span class="err">&amp;&amp;</span> <span class="na">now.getMonth</span><span class="err">()</span> <span class="err">===</span> <span class="na">m</span> <span class="err">&amp;&amp;</span> <span class="na">now.getDate</span><span class="err">()</span> <span class="err">===</span> <span class="na">d</span><span class="err">)</span> <span class="p">{</span>
        <span class="na">return</span> <span class="err">&#39;</span><span class="na">今天</span><span class="err">&#39;;</span>
    <span class="p">}</span> <span class="na">else</span> <span class="p">{</span>
        <span class="na">return</span> <span class="na">string</span><span class="err">;</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="err">*/</span>
  <span class="na">...</span>
  <span class="na">showDay</span><span class="err">(</span><span class="na">someday</span><span class="o">:</span> <span class="na">string</span><span class="err">)</span> <span class="p">{</span>
    <span class="na">const</span> <span class="na">now </span><span class="o">=</span> <span class="na">dayjs</span><span class="err">();</span>
    <span class="na">const</span> <span class="na">thatDay </span><span class="o">=</span> <span class="na">dayjs</span><span class="err">(</span><span class="na">someday</span><span class="err">);</span>
    <span class="na">if</span> <span class="err">(</span><span class="na">dayjs</span><span class="err">(</span><span class="na">someday</span><span class="err">)</span><span class="na">.isSame</span><span class="err">(</span><span class="na">now</span><span class="err">,</span> <span class="err">&#39;</span><span class="na">day</span><span class="err">&#39;))</span> <span class="p">{</span>
      <span class="na">return</span> <span class="err">&#39;</span><span class="na">今天</span><span class="err">&#39;;</span>
    <span class="p">}</span> <span class="na">else</span> <span class="na">if</span> <span class="err">(</span><span class="na">thatDay.isSame</span><span class="err">(</span><span class="na">now.subtract</span><span class="err">(</span><span class="na">1</span><span class="err">,</span> <span class="err">&#39;</span><span class="na">day</span><span class="err">&#39;),</span> <span class="err">&#39;</span><span class="na">day</span><span class="err">&#39;))</span> <span class="p">{</span>
      <span class="na">return</span> <span class="err">&#39;</span><span class="na">昨天</span><span class="err">&#39;;</span>
    <span class="p">}</span> <span class="na">else</span> <span class="na">if</span> <span class="err">(</span><span class="na">thatDay.isSame</span><span class="err">(</span><span class="na">now.subtract</span><span class="err">(</span><span class="na">2</span><span class="err">,</span> <span class="err">&#39;</span><span class="na">day</span><span class="err">&#39;),</span> <span class="err">&#39;</span><span class="na">day</span><span class="err">&#39;))</span> <span class="p">{</span>
      <span class="na">return</span> <span class="err">&#39;</span><span class="na">前天</span><span class="err">&#39;;</span>
    <span class="p">}</span> <span class="na">else</span> <span class="na">if</span> <span class="err">(</span><span class="na">thatDay.isSame</span><span class="err">(</span><span class="na">now</span><span class="err">,</span> <span class="err">&#39;</span><span class="na">year</span><span class="err">&#39;))</span> <span class="p">{</span>
      <span class="na">return</span> <span class="na">thatDay.format</span><span class="err">(&#39;</span><span class="na">M月D日</span><span class="err">&#39;);</span>
    <span class="p">}</span> <span class="na">else</span> <span class="p">{</span>
      <span class="na">return</span> <span class="na">thatDay.format</span><span class="err">(&#39;</span><span class="na">YYYY年M月D日</span><span class="err">&#39;);</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="na">beforeCreate</span><span class="err">()</span> <span class="p">{</span>
    <span class="na">this.</span><span class="err">$</span><span class="na">store.commit</span><span class="err">(&#39;</span><span class="na">fetchRecords</span><span class="err">&#39;);</span>
  <span class="p">}</span>
<span class="p">}</span>
<span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>

</code></pre></td></tr></table>
</div>
</div><ul>
<li><code>const now = dayjs();</code></li>
<li>判断相符<code>.isSame(now, 'day')</code></li>
<li>得到昨天：<code>now.valueOf() - 86400*1000</code>
<ul>
<li>使用<code>Dayjs</code>提供的<code>API</code>：<code>dayjs(someday).isSame(now.subtract(1, 'day'))</code></li>
<li>减一天<code>.subtract(1, 'day')</code></li>
</ul>
</li>
<li>格式化<code>thatDay.format('YYYY年M月D日');</code></li>
</ul>
<h2 id="模块化状态管理">模块化状态管理</h2>
<ul>
<li>分为<code>tagStore.ts</code>和<code>recordStore.ts</code></li>
<li>在组件中执行状态变更的方法不变<code>this.$store.commit('typeXXX', payloadXXX);</code></li>
<li>访问状态需要加一层模块名的属性<code>this.$store.state.tagStore.currentTag;</code></li>
<li>原来的<code>this.$store.state.someState</code>改为<code>this.$store.state.yourModuleName.someState</code></li>
<li>参考 <a href="https://www.ru23.com/note/a8440b25.html">vue状态管理之vuex（十六）</a></li>
</ul>
<blockquote>
<p><code>custom.d.ts</code>分开声明类型</p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-TypeScript" data-lang="TypeScript"><span class="kr">type</span> <span class="nx">RecordItem</span> <span class="o">=</span> <span class="p">{</span>
  <span class="nx">tags</span>: <span class="kt">Tag</span><span class="p">[];</span>
  <span class="nx">tips</span>: <span class="kt">string</span><span class="p">;</span>
  <span class="kr">type</span><span class="o">:</span> <span class="kt">string</span><span class="p">;</span>
  <span class="nx">amount</span>: <span class="kt">number</span><span class="p">;</span>
  <span class="nx">createdAt</span>: <span class="kt">string</span><span class="p">;</span>
<span class="p">}</span>
<span class="kr">type</span> <span class="nx">Tag</span> <span class="o">=</span> <span class="p">{</span>
  <span class="nx">id</span>: <span class="kt">string</span><span class="p">;</span>
  <span class="nx">name</span>: <span class="kt">string</span><span class="p">;</span>
<span class="p">}</span>
<span class="kr">type</span> <span class="nx">DataSource</span> <span class="o">=</span> <span class="p">{</span> <span class="nx">text</span>: <span class="kt">string</span><span class="p">;</span> <span class="kr">type</span><span class="o">:</span> <span class="kt">string</span> <span class="p">}</span>
<span class="cm">/*
</span><span class="cm">type RootState = {
</span><span class="cm">  tagList: Tag[];
</span><span class="cm">  recordList: RecordItem[];
</span><span class="cm">  currentTag?: Tag;
</span><span class="cm">  localTimeStamp: string;
</span><span class="cm">  createRecordError?: Error;
</span><span class="cm">}
</span><span class="cm">*/</span>
<span class="c1">// RootState 拆开分为 tagState 和 recordState
</span><span class="c1"></span><span class="kr">type</span> <span class="nx">tagState</span> <span class="o">=</span> <span class="p">{</span>
  <span class="nx">tagList</span>: <span class="kt">Tag</span><span class="p">[];</span>
  <span class="nx">currentTag</span>: <span class="kt">Tag</span><span class="p">;</span>
<span class="p">}</span>
<span class="kr">type</span> <span class="nx">recordState</span> <span class="o">=</span> <span class="p">{</span>
  <span class="nx">recordList</span>: <span class="kt">RecordItem</span><span class="p">[];</span>
  <span class="nx">localTimeStamp</span>: <span class="kt">string</span><span class="p">;</span>
  <span class="nx">createRecordError?</span>: <span class="kt">Error</span> <span class="o">|</span> <span class="kc">null</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p><code>src/store/index.ts</code></p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span><span class="lnt">80
</span><span class="lnt">81
</span><span class="lnt">82
</span><span class="lnt">83
</span><span class="lnt">84
</span><span class="lnt">85
</span><span class="lnt">86
</span><span class="lnt">87
</span><span class="lnt">88
</span><span class="lnt">89
</span><span class="lnt">90
</span><span class="lnt">91
</span><span class="lnt">92
</span><span class="lnt">93
</span><span class="lnt">94
</span><span class="lnt">95
</span><span class="lnt">96
</span><span class="lnt">97
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-TypeScript" data-lang="TypeScript"><span class="kr">import</span> <span class="nx">Vue</span> <span class="kr">from</span> <span class="s1">&#39;vue&#39;</span><span class="p">;</span>
<span class="kr">import</span> <span class="nx">Vuex</span> <span class="kr">from</span> <span class="s1">&#39;vuex&#39;</span><span class="p">;</span>
<span class="kr">import</span> <span class="nx">tagStore</span> <span class="kr">from</span> <span class="s1">&#39;@/store/modules/tagStore.ts&#39;</span><span class="p">;</span>
<span class="kr">import</span> <span class="nx">recordStore</span> <span class="kr">from</span> <span class="s1">&#39;@/store/modules/recordStore.ts&#39;</span><span class="p">;</span>

<span class="nx">Vue</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">Vuex</span><span class="p">);</span>

<span class="kr">const</span> <span class="nx">store</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Vuex</span><span class="p">.</span><span class="nx">Store</span><span class="p">(</span>
  <span class="p">{</span>
    <span class="cm">/*
</span><span class="cm">    state: {
</span><span class="cm">      tagList: [],
</span><span class="cm">      recordList: [],
</span><span class="cm">      currentTag: undefined,
</span><span class="cm">      localTimeStamp: &#39;&#39;
</span><span class="cm">    } as RootState,
</span><span class="cm">    
</span><span class="cm">    mutations: {
</span><span class="cm">      fetchRecords(state) {
</span><span class="cm">        state.recordList = JSON.parse(window.localStorage.getItem(&#39;recordList&#39;) ?? &#39;[]&#39;) as RecordItem[];
</span><span class="cm">      },
</span><span class="cm">      saveRecords(state) {
</span><span class="cm">        window.localStorage.setItem(&#39;recordList&#39;,
</span><span class="cm">          JSON.stringify(state.recordList));
</span><span class="cm">      },
</span><span class="cm">      getLocalTimeStamp(state) {
</span><span class="cm">        const date = new Date();
</span><span class="cm">        return state.localTimeStamp = new Date(date.getTime() - (date.getTimezoneOffset() * 60000))
</span><span class="cm">          .toISOString();
</span><span class="cm">      },
</span><span class="cm">      createRecord(state, record) {
</span><span class="cm">        const clonedRecord = clone(record);
</span><span class="cm">        store.commit(&#39;getLocalTimeStamp&#39;);
</span><span class="cm">        clonedRecord.createdAt = store.state.localTimeStamp;
</span><span class="cm">        state.recordList.push(clonedRecord);
</span><span class="cm">        store.commit(&#39;saveRecords&#39;);
</span><span class="cm">      },
</span><span class="cm">      fetchTags(state) {
</span><span class="cm">        return state.tagList = JSON.parse(window.localStorage.getItem(&#39;tagList&#39;) ?? &#39;[]&#39;);
</span><span class="cm">      },
</span><span class="cm">      saveTags(state) {
</span><span class="cm">        localStorage.setItem(&#39;tagList&#39;, JSON.stringify(state.tagList));
</span><span class="cm">      },
</span><span class="cm">      createTag(state, name: string) {
</span><span class="cm">        const names = state.tagList.map(d =&gt; d.name);
</span><span class="cm">        if (names.indexOf(name) &gt;= 0) {
</span><span class="cm">          window.alert(&#39;标签名重复了&#39;);
</span><span class="cm">          // return &#39;duplicated&#39;;
</span><span class="cm">        }
</span><span class="cm">        const id = operateId.createId().toString();
</span><span class="cm">        state.tagList.push({id, name});
</span><span class="cm">        store.commit(&#39;saveTags&#39;);
</span><span class="cm">        window.alert(&#39;添加成功&#39;);
</span><span class="cm">        // return &#39;success&#39;;
</span><span class="cm">      },
</span><span class="cm">      removeTag(state, id: string) {
</span><span class="cm">        let index = -1;
</span><span class="cm">        for (let i = 0; i &lt; state.tagList.length; i++) {
</span><span class="cm">          if (state.tagList[i].id === id) {
</span><span class="cm">            index = i;
</span><span class="cm">            break;
</span><span class="cm">          }
</span><span class="cm">        }
</span><span class="cm">        if (index &gt;= 0) {
</span><span class="cm">          state.tagList.splice(index, 1);
</span><span class="cm">          store.commit(&#39;saveTags&#39;);
</span><span class="cm">        } else {
</span><span class="cm">          window.alert(&#39;删除失败&#39;);
</span><span class="cm">        }
</span><span class="cm">      },
</span><span class="cm">      updateTag(state, tag: { id: string; name: string }) {
</span><span class="cm">        const {id, name} = tag;
</span><span class="cm">        const idList = state.tagList.map(item =&gt; item.id);
</span><span class="cm">        if (idList.indexOf(id) &gt;= 0) {
</span><span class="cm">          const nameList = state.tagList.map(item =&gt; item.name);
</span><span class="cm">          if (nameList.indexOf(name) &gt;= 0) {
</span><span class="cm">            window.alert(&#39;标签名重复类&#39;);
</span><span class="cm">          } else {
</span><span class="cm">            const tagItem = state.tagList.filter(item =&gt; item.id === id)[0];
</span><span class="cm">            tagItem.name = name;
</span><span class="cm">            store.commit(&#39;saveTags&#39;);
</span><span class="cm">          }
</span><span class="cm">        }
</span><span class="cm">      },
</span><span class="cm">      setCurrentTag(state, id: string) {
</span><span class="cm">        // state.currentTag = state.tagList.find(t =&gt; t.id === id);
</span><span class="cm">        state.currentTag = state.tagList.filter(t =&gt; t.id === id)[0];
</span><span class="cm">      },
</span><span class="cm">    },
</span><span class="cm">    */</span>
    
    <span class="kr">module</span><span class="nx">s</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">recordStore</span><span class="p">,</span>
      <span class="nx">tagStore</span>
    <span class="p">}</span>
  <span class="p">});</span>
<span class="kr">export</span> <span class="k">default</span> <span class="nx">store</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p><code>tagStore.ts</code></p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-TypeScript" data-lang="TypeScript"><span class="kr">import</span> <span class="nx">store</span> <span class="kr">from</span> <span class="s1">&#39;@/store&#39;</span><span class="p">;</span>
<span class="kr">import</span> <span class="nx">operateId</span> <span class="kr">from</span> <span class="s1">&#39;@/lib/operateId&#39;</span><span class="p">;</span>

<span class="kr">const</span> <span class="nx">tagStore</span> <span class="o">=</span> <span class="p">{</span>
  <span class="kr">namespace</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
  <span class="nx">state</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">tagList</span><span class="o">:</span> <span class="p">[],</span>
    <span class="nx">currentTag</span><span class="o">:</span> <span class="p">{},</span>
  <span class="p">},</span>
  <span class="nx">mutations</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">fetchTags</span><span class="p">(</span><span class="nx">state</span>: <span class="kt">tagState</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">state</span><span class="p">.</span><span class="nx">tagList</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nb">window</span><span class="p">.</span><span class="nx">localStorage</span><span class="p">.</span><span class="nx">getItem</span><span class="p">(</span><span class="s1">&#39;tagList&#39;</span><span class="p">)</span> <span class="o">??</span> <span class="s1">&#39;[]&#39;</span><span class="p">);</span>
    <span class="p">},</span>
    <span class="nx">saveTags</span><span class="p">(</span><span class="nx">state</span>: <span class="kt">tagState</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">localStorage</span><span class="p">.</span><span class="nx">setItem</span><span class="p">(</span><span class="s1">&#39;tagList&#39;</span><span class="p">,</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">state</span><span class="p">.</span><span class="nx">tagList</span><span class="p">));</span>
    <span class="p">},</span>
    <span class="nx">createTag</span><span class="p">(</span><span class="nx">state</span>: <span class="kt">tagState</span><span class="p">,</span> <span class="nx">name</span>: <span class="kt">string</span><span class="p">)</span> <span class="p">{</span>
      <span class="kr">const</span> <span class="nx">names</span> <span class="o">=</span> <span class="nx">state</span><span class="p">.</span><span class="nx">tagList</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">d</span> <span class="o">=&gt;</span> <span class="nx">d</span><span class="p">.</span><span class="nx">name</span><span class="p">);</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">names</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
        <span class="nb">window</span><span class="p">.</span><span class="nx">alert</span><span class="p">(</span><span class="s1">&#39;标签名重复了&#39;</span><span class="p">);</span>
        <span class="c1">// return &#39;duplicated&#39;;
</span><span class="c1"></span>      <span class="p">}</span>
      <span class="kr">const</span> <span class="nx">id</span> <span class="o">=</span> <span class="nx">operateId</span><span class="p">.</span><span class="nx">createId</span><span class="p">().</span><span class="nx">toString</span><span class="p">();</span>
      <span class="nx">state</span><span class="p">.</span><span class="nx">tagList</span><span class="p">.</span><span class="nx">push</span><span class="p">({</span><span class="nx">id</span><span class="p">,</span> <span class="nx">name</span><span class="p">});</span>
      <span class="nx">store</span><span class="p">.</span><span class="nx">commit</span><span class="p">(</span><span class="s1">&#39;saveTags&#39;</span><span class="p">);</span>
      <span class="nb">window</span><span class="p">.</span><span class="nx">alert</span><span class="p">(</span><span class="s1">&#39;添加成功&#39;</span><span class="p">);</span>
      <span class="c1">// return &#39;success&#39;;
</span><span class="c1"></span>    <span class="p">},</span>
    <span class="nx">removeTag</span><span class="p">(</span><span class="nx">state</span>: <span class="kt">tagState</span><span class="p">,</span> <span class="nx">id</span>: <span class="kt">string</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">let</span> <span class="nx">index</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
      <span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">state</span><span class="p">.</span><span class="nx">tagList</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">state</span><span class="p">.</span><span class="nx">tagList</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">id</span> <span class="o">===</span> <span class="nx">id</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">index</span> <span class="o">=</span> <span class="nx">i</span><span class="p">;</span>
          <span class="k">break</span><span class="p">;</span>
        <span class="p">}</span>
      <span class="p">}</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">index</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">state</span><span class="p">.</span><span class="nx">tagList</span><span class="p">.</span><span class="nx">splice</span><span class="p">(</span><span class="nx">index</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
        <span class="nx">store</span><span class="p">.</span><span class="nx">commit</span><span class="p">(</span><span class="s1">&#39;saveTags&#39;</span><span class="p">);</span>
      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nb">window</span><span class="p">.</span><span class="nx">alert</span><span class="p">(</span><span class="s1">&#39;删除失败&#39;</span><span class="p">);</span>
      <span class="p">}</span>
    <span class="p">},</span>
    <span class="nx">updateTag</span><span class="p">(</span><span class="nx">state</span>: <span class="kt">tagState</span><span class="p">,</span> <span class="nx">tag</span><span class="o">:</span> <span class="p">{</span> <span class="nx">id</span>: <span class="kt">string</span><span class="p">;</span> <span class="nx">name</span>: <span class="kt">string</span> <span class="p">})</span> <span class="p">{</span>
      <span class="kr">const</span> <span class="p">{</span><span class="nx">id</span><span class="p">,</span> <span class="nx">name</span><span class="p">}</span> <span class="o">=</span> <span class="nx">tag</span><span class="p">;</span>
      <span class="kr">const</span> <span class="nx">idList</span> <span class="o">=</span> <span class="nx">state</span><span class="p">.</span><span class="nx">tagList</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">item</span> <span class="o">=&gt;</span> <span class="nx">item</span><span class="p">.</span><span class="nx">id</span><span class="p">);</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">idList</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">id</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
        <span class="kr">const</span> <span class="nx">nameList</span> <span class="o">=</span> <span class="nx">state</span><span class="p">.</span><span class="nx">tagList</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">item</span> <span class="o">=&gt;</span> <span class="nx">item</span><span class="p">.</span><span class="nx">name</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">nameList</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
          <span class="nb">window</span><span class="p">.</span><span class="nx">alert</span><span class="p">(</span><span class="s1">&#39;标签名重复类&#39;</span><span class="p">);</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
          <span class="kr">const</span> <span class="nx">tagItem</span> <span class="o">=</span> <span class="nx">state</span><span class="p">.</span><span class="nx">tagList</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="nx">item</span> <span class="o">=&gt;</span> <span class="nx">item</span><span class="p">.</span><span class="nx">id</span> <span class="o">===</span> <span class="nx">id</span><span class="p">)[</span><span class="mi">0</span><span class="p">];</span>
          <span class="nx">tagItem</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="nx">name</span><span class="p">;</span>
          <span class="nx">store</span><span class="p">.</span><span class="nx">commit</span><span class="p">(</span><span class="s1">&#39;saveTags&#39;</span><span class="p">);</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">},</span>
    <span class="nx">setCurrentTag</span><span class="p">(</span><span class="nx">state</span>: <span class="kt">tagState</span><span class="p">,</span> <span class="nx">id</span>: <span class="kt">string</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// state.currentTag = state.tagList.find(t =&gt; t.id === id);
</span><span class="c1"></span>      <span class="nx">state</span><span class="p">.</span><span class="nx">currentTag</span> <span class="o">=</span> <span class="nx">state</span><span class="p">.</span><span class="nx">tagList</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="nx">t</span> <span class="o">=&gt;</span> <span class="nx">t</span><span class="p">.</span><span class="nx">id</span> <span class="o">===</span> <span class="nx">id</span><span class="p">)[</span><span class="mi">0</span><span class="p">];</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">};</span>
<span class="kr">export</span> <span class="k">default</span> <span class="nx">tagStore</span><span class="p">;</span>

</code></pre></td></tr></table>
</div>
</div><blockquote>
<p><code>recoredStore.ts</code></p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-TypeScript" data-lang="TypeScript"><span class="kr">import</span> <span class="nx">clone</span> <span class="kr">from</span> <span class="s1">&#39;@/lib/clone&#39;</span><span class="p">;</span>
<span class="kr">import</span> <span class="nx">store</span> <span class="kr">from</span> <span class="s1">&#39;@/store&#39;</span><span class="p">;</span>

<span class="kr">const</span> <span class="nx">recordStore</span> <span class="o">=</span> <span class="p">{</span>
  <span class="kr">namespace</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
  <span class="nx">state</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">recordList</span><span class="o">:</span> <span class="p">[],</span>
    <span class="nx">localTimeStamp</span><span class="o">:</span> <span class="s1">&#39;&#39;</span>
  <span class="p">},</span>
  <span class="nx">mutations</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">fetchRecords</span><span class="p">(</span><span class="nx">state</span>: <span class="kt">recordState</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">state</span><span class="p">.</span><span class="nx">recordList</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nb">window</span><span class="p">.</span><span class="nx">localStorage</span><span class="p">.</span><span class="nx">getItem</span><span class="p">(</span><span class="s1">&#39;recordList&#39;</span><span class="p">)</span> <span class="o">??</span> <span class="s1">&#39;[]&#39;</span><span class="p">)</span> <span class="kr">as</span> <span class="nx">RecordItem</span><span class="p">[];</span>
    <span class="p">},</span>
    <span class="nx">saveRecords</span><span class="p">(</span><span class="nx">state</span>: <span class="kt">recordState</span><span class="p">)</span> <span class="p">{</span>
      <span class="nb">window</span><span class="p">.</span><span class="nx">localStorage</span><span class="p">.</span><span class="nx">setItem</span><span class="p">(</span><span class="s1">&#39;recordList&#39;</span><span class="p">,</span>
        <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">state</span><span class="p">.</span><span class="nx">recordList</span><span class="p">));</span>
    <span class="p">},</span>
    <span class="nx">getLocalTimeStamp</span><span class="p">(</span><span class="nx">state</span>: <span class="kt">recordState</span><span class="p">)</span> <span class="p">{</span>
      <span class="kr">const</span> <span class="nx">date</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">();</span>
      <span class="k">return</span> <span class="nx">state</span><span class="p">.</span><span class="nx">localTimeStamp</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">(</span><span class="nx">date</span><span class="p">.</span><span class="nx">getTime</span><span class="p">()</span> <span class="o">-</span> <span class="p">(</span><span class="nx">date</span><span class="p">.</span><span class="nx">getTimezoneOffset</span><span class="p">()</span> <span class="o">*</span> <span class="mi">60000</span><span class="p">))</span>
        <span class="p">.</span><span class="nx">toISOString</span><span class="p">();</span>
    <span class="p">},</span>
    <span class="nx">createRecord</span><span class="p">(</span><span class="nx">state</span>: <span class="kt">recordState</span><span class="p">,</span> <span class="nx">record</span>: <span class="kt">RecordItem</span><span class="p">)</span> <span class="p">{</span>
      <span class="kr">const</span> <span class="nx">clonedRecord</span> <span class="o">=</span> <span class="nx">clone</span><span class="p">(</span><span class="nx">record</span><span class="p">);</span>
      <span class="nx">store</span><span class="p">.</span><span class="nx">commit</span><span class="p">(</span><span class="s1">&#39;getLocalTimeStamp&#39;</span><span class="p">);</span>
      <span class="nx">clonedRecord</span><span class="p">.</span><span class="nx">createdAt</span> <span class="o">=</span> <span class="nx">state</span><span class="p">.</span><span class="nx">localTimeStamp</span><span class="p">;</span>
      <span class="nx">state</span><span class="p">.</span><span class="nx">recordList</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">clonedRecord</span><span class="p">);</span>
      <span class="nx">store</span><span class="p">.</span><span class="nx">commit</span><span class="p">(</span><span class="s1">&#39;saveRecords&#39;</span><span class="p">);</span>
    <span class="p">},</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="kr">export</span> <span class="k">default</span> <span class="nx">recordStore</span><span class="p">;</span>

</code></pre></td></tr></table>
</div>
</div><blockquote>
<p><code>Money.vue</code></p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-vue" data-lang="vue"><span class="p">&lt;</span><span class="nt">template</span><span class="p">&gt;...&lt;/</span><span class="nt">template</span><span class="p">&gt;</span>

<span class="p">&lt;</span><span class="nt">script</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;ts&#34;</span><span class="p">&gt;</span>
<span class="c1">// import ...;
</span><span class="c1"></span>
<span class="err">@</span><span class="nx">Component</span><span class="p">({</span>
  <span class="nx">components</span><span class="o">:</span> <span class="p">{</span><span class="nx">Tabs</span><span class="p">,</span> <span class="nx">FormItem</span><span class="p">,</span> <span class="nx">Tags</span><span class="p">,</span> <span class="nx">Numpad</span><span class="p">}</span>
<span class="p">})</span>
<span class="kr">export</span> <span class="k">default</span> <span class="kr">class</span> <span class="nx">Money</span> <span class="kr">extends</span> <span class="nx">Vue</span> <span class="p">{</span>
  <span class="p">...</span>
  <span class="nx">created</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">$store</span><span class="p">.</span><span class="nx">commit</span><span class="p">(</span><span class="s1">&#39;fetchRecords&#39;</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="nx">get</span> <span class="nx">recordList</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">$store</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">recordStore</span><span class="p">.</span><span class="nx">recordList</span> <span class="nx">as</span> <span class="nx">RecordItem</span><span class="p">[];</span>
  <span class="p">}</span>
  <span class="nx">onUpdateTips</span><span class="p">(</span><span class="nx">value</span><span class="o">:</span> <span class="nx">string</span><span class="p">)</span> <span class="p">{...}</span>
  <span class="nx">pickTags</span><span class="p">(</span><span class="nx">selectedTags</span><span class="o">:</span> <span class="p">{</span><span class="nx">id</span><span class="o">:</span> <span class="nx">string</span><span class="p">;</span> <span class="nx">name</span><span class="o">:</span> <span class="nx">string</span> <span class="p">}[])</span> <span class="p">{...}</span>
  <span class="p">...</span>
  <span class="nx">saveRecord</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">$store</span><span class="p">.</span><span class="nx">commit</span><span class="p">(</span><span class="s1">&#39;createRecord&#39;</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">record</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
<span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>

<span class="p">&lt;</span><span class="nt">style</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;scss&#34;</span><span class="p">&gt;</span>
<span class="p">...</span>
<span class="p">&lt;/</span><span class="nt">style</span><span class="p">&gt;</span>

<span class="p">&lt;</span><span class="nt">style</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;scss&#34;</span> <span class="na">scoped</span><span class="p">&gt;</span>
<span class="p">...</span>
<span class="p">&lt;/</span><span class="nt">style</span><span class="p">&gt;</span>

</code></pre></td></tr></table>
</div>
</div><blockquote>
<p><code>Statistic.vue </code></p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-HTML" data-lang="HTML"><span class="p">&lt;</span><span class="nt">template</span><span class="p">&gt;</span>...<span class="p">&lt;/</span><span class="nt">template</span><span class="p">&gt;</span>

<span class="p">&lt;</span><span class="nt">script</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;ts&#34;</span><span class="p">&gt;</span>
<span class="c1">// import ...;
</span><span class="c1"></span>
<span class="err">@</span><span class="nx">Component</span><span class="p">({</span>
  <span class="nx">components</span><span class="o">:</span> <span class="p">{</span><span class="nx">Tabs</span><span class="p">},</span>
<span class="p">})</span>
<span class="kr">export</span> <span class="k">default</span> <span class="kr">class</span> <span class="nx">Statistics</span> <span class="kr">extends</span> <span class="nx">Vue</span> <span class="p">{</span>
  <span class="p">...</span>
  <span class="nx">beforeCreate</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">$store</span><span class="p">.</span><span class="nx">commit</span><span class="p">(</span><span class="s1">&#39;fetchRecords&#39;</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="nx">get</span> <span class="nx">recordList</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">$store</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">recordStore</span><span class="p">.</span><span class="nx">recordList</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="nx">get</span> <span class="nx">result</span><span class="p">()</span> <span class="p">{...}</span>
  <span class="nx">tagToString</span><span class="p">(</span><span class="nx">tags</span><span class="o">:</span> <span class="nx">Tag</span><span class="p">[])</span> <span class="p">{...}</span>
  <span class="nx">showDay</span><span class="p">(</span><span class="nx">someday</span><span class="o">:</span> <span class="nx">string</span><span class="p">)</span> <span class="p">{...}</span>
<span class="p">}</span>
<span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>

<span class="p">&lt;</span><span class="nt">style</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;scss&#34;</span> <span class="na">scoped</span><span class="p">&gt;</span>
<span class="p">@</span><span class="k">import</span> <span class="s2">&#34;~@/assets/style/global.scss&#34;</span><span class="p">;</span>
<span class="o">...</span>
<span class="p">&lt;/</span><span class="nt">style</span><span class="p">&gt;</span>

</code></pre></td></tr></table>
</div>
</div><blockquote>
<p><code>Labels.vue </code></p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-vue" data-lang="vue"><span class="p">&lt;</span><span class="nt">template</span><span class="p">&gt;...&lt;/</span><span class="nt">template</span><span class="p">&gt;</span>

<span class="p">&lt;</span><span class="nt">script</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;ts&#34;</span><span class="p">&gt;</span>
<span class="c1">// import ...;
</span><span class="c1"></span>
<span class="err">@</span><span class="nx">Component</span><span class="p">({</span>
  <span class="nx">components</span><span class="o">:</span> <span class="p">{</span><span class="nx">Button</span><span class="p">}</span>
<span class="p">})</span>

<span class="kr">export</span> <span class="k">default</span> <span class="kr">class</span> <span class="nx">Labels</span> <span class="kr">extends</span> <span class="nx">mixins</span><span class="p">(</span><span class="nx">tagHelper</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">get</span> <span class="nx">tags</span><span class="p">()</span> <span class="p">{</span><span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">$store</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">tagStore</span><span class="p">.</span><span class="nx">tagList</span><span class="p">;}</span>
  <span class="nx">beforeCreate</span><span class="p">()</span> <span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">$store</span><span class="p">.</span><span class="nx">commit</span><span class="p">(</span><span class="s1">&#39;fetchTags&#39;</span><span class="p">);}</span>
<span class="p">}</span>
<span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>

<span class="p">&lt;</span><span class="nt">style</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;scss&#34;</span> <span class="na">scoped</span><span class="p">&gt;</span>
<span class="err">@</span><span class="kr">import</span> <span class="s2">&#34;~@/assets/style/global.scss&#34;</span><span class="p">;</span>
<span class="p">...</span>
<span class="p">&lt;/</span><span class="nt">style</span><span class="p">&gt;</span>

</code></pre></td></tr></table>
</div>
</div><blockquote>
<p><code>EditLabel.vue </code></p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-vue" data-lang="vue"><span class="p">&lt;</span><span class="nt">template</span><span class="p">&gt;...&lt;/</span><span class="nt">template</span><span class="p">&gt;</span>

<span class="p">&lt;</span><span class="nt">script</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;ts&#34;</span><span class="p">&gt;</span>
<span class="c1">// import ...;
</span><span class="c1"></span>
<span class="err">@</span><span class="nx">Component</span><span class="p">({</span>
  <span class="nx">components</span><span class="o">:</span> <span class="p">{</span><span class="nx">Button</span><span class="p">,</span> <span class="nx">FormItem</span><span class="p">}</span>
<span class="p">})</span>
<span class="kr">export</span> <span class="k">default</span> <span class="kr">class</span> <span class="nx">EditLabel</span> <span class="kr">extends</span> <span class="nx">Vue</span> <span class="p">{</span>
  <span class="nx">get</span> <span class="nx">currentTag</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">$store</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">tagStore</span><span class="p">.</span><span class="nx">currentTag</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="nx">created</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">$store</span><span class="p">.</span><span class="nx">commit</span><span class="p">(</span><span class="s1">&#39;fetchTags&#39;</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">$store</span><span class="p">.</span><span class="nx">commit</span><span class="p">(</span><span class="s1">&#39;setCurrentTag&#39;</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">$route</span><span class="p">.</span><span class="nx">params</span><span class="p">.</span><span class="nx">id</span><span class="p">);</span>
    <span class="p">...</span>
  <span class="p">}</span>

  <span class="nx">update</span><span class="p">(</span><span class="nx">name</span><span class="o">:</span> <span class="nx">string</span><span class="p">)</span> <span class="p">{</span>
    <span class="p">...</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">$store</span><span class="p">.</span><span class="nx">commit</span><span class="p">(</span><span class="s1">&#39;updateTag&#39;</span><span class="p">,</span> <span class="p">{</span><span class="nx">id</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">currentTag</span><span class="p">.</span><span class="nx">id</span><span class="p">,</span> <span class="nx">name</span><span class="p">});</span>
  <span class="p">}</span>

  <span class="nx">remove</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">currentTag</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">$store</span><span class="p">.</span><span class="nx">commit</span><span class="p">(</span><span class="s1">&#39;removeTag&#39;</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">currentTag</span><span class="p">.</span><span class="nx">id</span><span class="p">);</span>
      <span class="p">...}</span>
  <span class="p">}</span>
  <span class="nx">goBack</span><span class="p">()</span> <span class="p">{...}</span>
<span class="p">}</span>
<span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>

<span class="p">&lt;</span><span class="nt">style</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;scss&#34;</span> <span class="na">scoped</span><span class="p">&gt;</span>
<span class="err">@</span><span class="kr">import</span> <span class="s2">&#34;~@/assets/style/global.scss&#34;</span><span class="p">;</span>
<span class="p">...</span>
<span class="p">&lt;/</span><span class="nt">style</span><span class="p">&gt;</span>

</code></pre></td></tr></table>
</div>
</div><blockquote>
<p><code>Tags.vue </code></p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-vue" data-lang="vue"><span class="p">&lt;</span><span class="nt">template</span><span class="p">&gt;...&lt;/</span><span class="nt">template</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">script</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;ts&#34;</span><span class="p">&gt;</span>
<span class="c1">// import ...;
</span><span class="c1"></span>
<span class="err">@</span><span class="nx">Component</span>
<span class="kr">export</span> <span class="k">default</span> <span class="kr">class</span> <span class="nx">Tags</span> <span class="kr">extends</span> <span class="nx">mixins</span><span class="p">(</span><span class="nx">tagHelper</span><span class="p">)</span> <span class="p">{</span>
  <span class="p">...</span>
  <span class="nx">created</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">$store</span><span class="p">.</span><span class="nx">commit</span><span class="p">(</span><span class="s1">&#39;fetchTags&#39;</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="nx">get</span> <span class="nx">tagList</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">$store</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">tagStore</span><span class="p">.</span><span class="nx">tagList</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="nx">toggle</span><span class="p">(</span><span class="nx">tag</span><span class="o">:</span> <span class="nx">Tag</span><span class="p">)</span> <span class="p">{...}</span>
<span class="p">}</span>
<span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">style</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;scss&#34;</span> <span class="na">scoped</span><span class="p">&gt;</span>
<span class="err">@</span><span class="kr">import</span> <span class="s2">&#34;~@/assets/style/global.scss&#34;</span><span class="p">;</span>
<span class="p">...</span>
<span class="p">&lt;/</span><span class="nt">style</span><span class="p">&gt;</span>

</code></pre></td></tr></table>
</div>
</div><ul>
<li>参考文档
<ul>
<li><a href="https://juejin.cn/post/6844903942275465230#heading-3"><code>Vue &amp; Vuex in Typescript - vuex-class 使用指南</code></a> <code>@Mutation</code> 装饰器</li>
<li><a href="https://juejin.cn/post/6844904003633954829">Vue &amp; TypeScript 初体验 - 使用Vuex (vuex-module-decorators)</a></li>
<li><a href="https://segmentfault.com/a/1190000019906575">使用 TypeScript + Vuex</a></li>
<li>github
<ul>
<li><a href="https://github.com/ktsn/vuex-class">ktsn/vuex-class</a></li>
<li><a href="https://github.com/gertqin/vuex-class-modules">gertqin/vuex-class-modules</a></li>
<li><a href="https://github.com/kaorun343/vue-property-decorator#VModel">vue-property-decorator</a></li>
<li><a href="https://github.com/Armour/vue-typescript-admin-template/blob/master/README-zh.md">vue-typescript-admin-template</a></li>
<li><a href="https://github.com/michaelolof/vuex-class-component">michaelolof/vuex-class-component</a></li>
<li><a href="https://github.com/kaorun343/vue-property-decorator#Emit">vue-property-decorator</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="https://segmentfault.com/a/1190000011864013/">Vue2.5+ Typescript 引入全面指南 - Vuex篇</a></li>
<li><code>Muation</code> 函数<strong>不可为 async函数</strong>, 也不能<strong>使用箭头函数来定义</strong>, 因为代码需要运行在重新绑定执行的上下文</li>
</ul>
<hr>
<h2 id="数据排序计数排序的变形">数据排序（计数排序的变形）</h2>
<blockquote>
<p>首先了解数据<code>result</code>的类型</p>
</blockquote>
<ul>
<li>目前<code>result</code>是<code>hashTable</code>（对象）</li>
<li>遍历对象时，遍历的顺序是否固定
<ul>
<li>遍历对象的<code>key</code>，遍历的顺序是否固定</li>
<li><code>hashTable</code>中的顺序是用户输入得到的，输入顺序不一定符合预期</li>
</ul>
</li>
</ul>
<blockquote>
<p>JS 中对象的 key 是有顺序的</p>
</blockquote>
<ul>
<li>JS 中对象的字段遍历顺序是没有保证的，例如 <code>Object.keys</code>函数产生的数组顺序没有保证</li>
<li>实际上在 ES2015 之后标准规定了 key 的顺序（准确的说是规定了 <code>[[OwnPropertyKeys]]()</code>这个内部方法返回的 key 的顺序）</li>
</ul>
<blockquote>
<p>结论：keys 数组分为三个部分：</p>
</blockquote>
<ul>
<li>可以作为数组索引的 key 按照升序排列，例如 1、2、3。
是字符串不是 symbol 的 key，按照创建顺序排列。</li>
<li>symbol 类的 key 按照创建顺序排列。</li>
<li>参考链接 <a href="https://link.zhihu.com/?target=https%3A//262.ecma-international.org/11.0/%23sec-ordinary-object-internal-methods-and-internal-slots-ownpropertykeys">ECMAScript 9.1.11</a></li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-JavaScript" data-lang="JavaScript"><span class="nx">Reflect</span><span class="p">.</span><span class="nx">ownKeys</span><span class="p">({</span>
  <span class="p">[</span><span class="nx">Symbol</span><span class="p">(</span><span class="s1">&#39;88888&#39;</span><span class="p">)]</span><span class="o">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">18</span><span class="o">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="nx">star</span><span class="o">:</span> <span class="s1">&#39;☆★&#39;</span><span class="p">,</span>
  <span class="mi">4</span><span class="o">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="nx">hahaha</span><span class="o">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
<span class="p">})</span>

<span class="c1">// [&#39;4&#39;, &#39;18&#39;, &#39;star&#39;, &#39;hahaha&#39;, Symbol(88888)]
</span></code></pre></td></tr></table>
</div>
</div><blockquote>
<p>必须改为一个数组，才能排序</p>
</blockquote>
<ul>
<li>按时间排序，近的排在前面</li>
<li>显示的顺序为 今天 昨天 （本年内）具体日期 （去年以及之前）具体日期</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-JavaScript" data-lang="JavaScript"><span class="cm">/*
</span><span class="cm">* [
</span><span class="cm">*   {title, items},
</span><span class="cm">*   {title, items},
</span><span class="cm">*   {title, items},
</span><span class="cm">* ]
</span><span class="cm">* */</span>
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p><code>clone.ts</code></p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-TypeScript" data-lang="TypeScript"><span class="kd">function</span> <span class="nx">clone</span><span class="p">&lt;</span><span class="nt">T</span><span class="p">&gt;(</span><span class="nx">data</span>: <span class="kt">T</span><span class="p">)</span><span class="o">:</span> <span class="nx">T</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">data</span><span class="p">));</span>
<span class="p">}</span>

<span class="kr">export</span> <span class="k">default</span> <span class="nx">clone</span><span class="p">;</span>

</code></pre></td></tr></table>
</div>
</div><ul>
<li>TS 声明类型：
<ul>
<li><code>type HashTableValue = { title: string; items: RecordItem[] };</code></li>
</ul>
</li>
<li>查询到对应的<code>title</code>，将<code>recordList</code>排序，依次推入数组</li>
<li><code>recordList</code>是<code>RecordItem</code>的数组，进行排序<code>.sort((a, b) =&gt; {})</code>
<ul>
<li><code>const n = recordList.sort((a, b) =&gt; {a.createdAt});</code></li>
<li><code>a.createdAt</code>的值为字符串，按<code>ASCII</code>顺序比较大小，不是预期的顺序，<code>'a' - 'b' // NaN</code>不能用字符串的减法</li>
<li><strong>使用<code>.sort()</code>必须变为数字类型，用<code>.valueOf()</code></strong>：
<ul>
<li><code>dayjs(a.createdAt).valueOf()</code></li>
</ul>
</li>
</ul>
</li>
<li><code>const newList = recordList.sort((a: RecordItem, b: RecordItem) =&gt; ( dayjs(a.createdAt).valueOf() - dayjs(b.createdAt).valueOf() ));</code></li>
<li>需要逆向从近期到远期的<code>( dayjs(b.createdAt).valueOf() - dayjs(a.createdAt).valueOf() )</code></li>
<li>注意<code>.sort()</code>会<strong>改变原数组自身</strong>，保留原数组，使用<strong>深克隆</strong>
<ul>
<li>导入之前的工具函数<code>import clone from '@/lib/clone.ts';</code>的<code>clone()</code></li>
<li><code>function clone(data: any) { return JSON.parse(JSON.stringify(data)) as RecordItem; }</code></li>
<li>由于接受的参数类型是<code>any</code>，而<code>JSON.parse()</code>返回值类型也是<code>any</code></li>
<li>使用泛型<code>function clone&lt;T&gt;(data: T): T {...}</code> 统一入参和返回值的类型
<ul>
<li>在尖括号中声明类型</li>
</ul>
</li>
<li>之后使用<code>.sort()</code> TS 会自动推断类型</li>
</ul>
</li>
</ul>
<blockquote>
<p><code>Statistic.vue </code></p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-TypeScript" data-lang="TypeScript">  <span class="p">...</span>
  <span class="kr">get</span> <span class="nx">result() {</span>
    <span class="kr">const</span> <span class="p">{</span><span class="nx">recordList</span><span class="p">}</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
    <span class="kr">type</span> <span class="nx">HashTableValue</span> <span class="o">=</span> <span class="p">{</span> <span class="nx">title</span>: <span class="kt">string</span><span class="p">;</span> <span class="nx">items</span>: <span class="kt">RecordItem</span><span class="p">[]</span> <span class="p">};</span>
    <span class="kr">const</span> <span class="nx">hashTable</span>: <span class="kt">HashTableValue</span><span class="p">[]</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="kr">const</span> <span class="nx">newList</span> <span class="o">=</span> <span class="nx">clone</span><span class="p">(</span><span class="nx">recordList</span><span class="p">).</span><span class="nx">sort</span><span class="p">((</span><span class="nx">a</span>: <span class="kt">RecordItem</span><span class="p">,</span> <span class="nx">b</span>: <span class="kt">RecordItem</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">(</span>
        <span class="nx">dayjs</span><span class="p">(</span><span class="nx">b</span><span class="p">.</span><span class="nx">createdAt</span><span class="p">).</span><span class="nx">valueOf</span><span class="p">()</span> <span class="o">-</span> <span class="nx">dayjs</span><span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">createdAt</span><span class="p">).</span><span class="nx">valueOf</span><span class="p">()</span>
    <span class="p">));</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">newList</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">i</span> <span class="o">=&gt;</span> <span class="nx">i</span><span class="p">.</span><span class="nx">createdAt</span><span class="p">));</span>
    <span class="k">return</span> <span class="p">[];</span>
  <span class="p">}</span>
  <span class="p">...</span>
</code></pre></td></tr></table>
</div>
</div><ul>
<li>先将局部数据<code>recordList</code>排序，再<code>push</code>到数据中</li>
</ul>
<hr>
<h2 id="数据排序后分组">数据排序后分组</h2>
<ul>
<li>判断数组长度<code>if(recordList.length === 0) {return []};</code>，确保存在可操作数据</li>
<li>取出新的<code>newList</code>的第一个数据
<ul>
<li><code>const x = [{title: dayjs(recordList[0].createdAt).format('YYYY-MM-DD'), items: [recordList[0]]}];</code></li>
</ul>
</li>
<li>从第二个数据的<code>.createdAt</code>和第一个数据的<code>title</code>和开始循环比较
<ul>
<li>新的数据和分组的<code>title</code>是否一致
<ul>
<li>一致放入当前组的<code>items</code></li>
<li>不一致，作为新的一组的<code>title</code>，放入新分组的<code>items</code></li>
</ul>
</li>
</ul>
</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-JavaScript" data-lang="JavaScript"><span class="cm">/*
</span><span class="cm">* [
</span><span class="cm">*   {title: &#39;11&#39;, items: [{11...}, {11...}]},
</span><span class="cm">*   {title: &#39;12&#39;, items: [{12...}, {12...}, {12...}]},
</span><span class="cm">*   {title: &#39;13&#39;, items: [{13...}, {13...}]},
</span><span class="cm">*   {title: &lt;string&gt;, items: [{13...}, {13...}]},
</span><span class="cm">* ]
</span><span class="cm">* */</span>
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>统一显示时间戳比较 -标记问题ok</p>
</blockquote>
<ul>
<li><code>const localDay = dayjs(current.createdAt.split('T')[0]);</code></li>
<li>由于有时区的概念 <code>dayjs(current.createdAt)</code>算上时间部分的日期会延后一天</li>
<li>封装倒时差函数<code>clearJetLag(new Date(), '-')</code></li>
</ul>
<blockquote>
<p><code>src/store/modules/recordStore.ts</code></p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-TypeScript" data-lang="TypeScript"><span class="kr">import</span> <span class="nx">clone</span> <span class="kr">from</span> <span class="s1">&#39;@/lib/clone&#39;</span><span class="p">;</span>
<span class="kr">import</span> <span class="nx">store</span> <span class="kr">from</span> <span class="s1">&#39;@/store&#39;</span><span class="p">;</span>
<span class="kr">import</span> <span class="nx">clearJetLag</span> <span class="kr">from</span> <span class="s1">&#39;@/lib/clearJetLag.ts&#39;</span><span class="p">;</span>

<span class="kr">const</span> <span class="nx">recordStore</span> <span class="o">=</span> <span class="p">{</span>
  <span class="kr">namespace</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
  <span class="nx">state() {</span>
    <span class="k">return</span> <span class="p">{</span>
      <span class="nx">recordList</span><span class="o">:</span> <span class="p">[],</span>
      <span class="nx">localTimeStamp</span><span class="o">:</span> <span class="s1">&#39;&#39;</span>
    <span class="p">};</span>
  <span class="p">},</span>
  <span class="nx">mutations</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">getLocalTimeStamp</span><span class="p">(</span><span class="nx">state</span>: <span class="kt">recordState</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">state</span><span class="p">.</span><span class="nx">localTimeStamp</span> <span class="o">=</span> <span class="nx">clearJetLag</span><span class="p">(</span><span class="k">new</span> <span class="nb">Date</span><span class="p">(),</span> <span class="s1">&#39;-&#39;</span><span class="p">);</span>
    <span class="p">},</span>
    <span class="nx">fetchRecords</span><span class="p">(</span><span class="nx">state</span>: <span class="kt">recordState</span><span class="p">)</span> <span class="p">{...},</span>
    <span class="nx">saveRecords</span><span class="p">(</span><span class="nx">state</span>: <span class="kt">recordState</span><span class="p">)</span> <span class="p">{...},</span>
    <span class="nx">createRecord</span><span class="p">(</span><span class="nx">state</span>: <span class="kt">recordState</span><span class="p">,</span> <span class="nx">record</span>: <span class="kt">RecordItem</span><span class="p">)</span> <span class="p">{</span>
      <span class="kr">const</span> <span class="nx">clonedRecord</span> <span class="o">=</span> <span class="nx">clone</span><span class="p">(</span><span class="nx">record</span><span class="p">);</span>
      <span class="nx">store</span><span class="p">.</span><span class="nx">commit</span><span class="p">(</span><span class="s1">&#39;getLocalTimeStamp&#39;</span><span class="p">);</span>
      <span class="nx">clonedRecord</span><span class="p">.</span><span class="nx">createdAt</span> <span class="o">=</span> <span class="nx">state</span><span class="p">.</span><span class="nx">localTimeStamp</span><span class="p">;</span>
      <span class="nx">state</span><span class="p">.</span><span class="nx">recordList</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">clonedRecord</span><span class="p">);</span>
      <span class="nx">store</span><span class="p">.</span><span class="nx">commit</span><span class="p">(</span><span class="s1">&#39;saveRecords&#39;</span><span class="p">);</span>
    <span class="p">},</span>
  <span class="p">}</span>
<span class="p">};</span>

<span class="kr">export</span> <span class="k">default</span> <span class="nx">recordStore</span><span class="p">;</span>

</code></pre></td></tr></table>
</div>
</div><blockquote>
<p><code>src/lib/clearJetLag.ts</code></p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-TypeScript" data-lang="TypeScript"><span class="kd">function</span> <span class="nx">clearJetLag</span><span class="p">(</span><span class="nx">isoDate</span>: <span class="kt">Date</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">(),</span> <span class="nx">offsetType</span><span class="o">:</span> <span class="s1">&#39;-&#39;</span> <span class="o">|</span> <span class="s1">&#39;+&#39;</span> <span class="o">|</span> <span class="s1">&#39;&#39;</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">let</span> <span class="nx">localClock</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">offsetType</span> <span class="o">===</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">localClock</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">(</span><span class="nx">isoDate</span><span class="p">.</span><span class="nx">getTime</span><span class="p">()).</span><span class="nx">toISOString</span><span class="p">();</span>
  <span class="p">}</span><span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="nx">offsetType</span> <span class="o">===</span> <span class="s1">&#39;-&#39;</span><span class="p">){</span>
    <span class="nx">localClock</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">(</span><span class="nx">isoDate</span><span class="p">.</span><span class="nx">getTime</span><span class="p">()</span> <span class="o">-</span> <span class="p">(</span><span class="nx">isoDate</span><span class="p">.</span><span class="nx">getTimezoneOffset</span><span class="p">()</span> <span class="o">*</span> <span class="mi">60000</span><span class="p">)).</span><span class="nx">toISOString</span><span class="p">();</span>
  <span class="p">}</span><span class="k">else</span><span class="p">{</span>
    <span class="nx">localClock</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">(</span><span class="nx">isoDate</span><span class="p">.</span><span class="nx">getTime</span><span class="p">()</span> <span class="o">+</span> <span class="p">(</span><span class="nx">isoDate</span><span class="p">.</span><span class="nx">getTimezoneOffset</span><span class="p">()</span> <span class="o">*</span> <span class="mi">60000</span><span class="p">)).</span><span class="nx">toISOString</span><span class="p">();</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="nx">localClock</span>
<span class="p">}</span>

<span class="kr">export</span> <span class="k">default</span> <span class="nx">clearJetLag</span><span class="p">;</span>

</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>重构命名</p>
</blockquote>
<ul>
<li><code>get groupedList() { ... return rusult;}</code></li>
</ul>
<blockquote>
<p>更改<code>template</code> 循环渲染的<code>:key</code></p>
</blockquote>
<ul>
<li>数据由对象变为数组<strong>方便排序</strong></li>
<li><code>li v-for=&quot;(group, index) in groupedList&quot; :key=&quot;index&quot;&gt;</code></li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-vue" data-lang="vue"><span class="p">&lt;</span><span class="nt">template</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">Layout</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;statistics&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">Tabs</span> <span class="na">class</span><span class="nt">-prefix</span><span class="err">=&#34;</span><span class="na">type</span><span class="err">&#34;</span> <span class="nt">:data-source</span><span class="s">=&#34;recordTypeList&#34;</span> <span class="nt">:type.sync</span><span class="s">=&#34;type&#34;</span><span class="p">/&gt;</span>
    <span class="p">&lt;</span><span class="nt">ol</span><span class="p">&gt;</span>
      <span class="p">&lt;</span><span class="nt">li</span> <span class="nt">v-for</span><span class="s">=&#34;(group, index) in groupedList&#34; </span><span class="nt">:key</span><span class="s">=&#34;index&#34;</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">h3</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;title&#34;</span><span class="p">&gt;{{</span> <span class="nx">showDay</span><span class="p">(</span><span class="nx">group</span><span class="p">.</span><span class="nx">title</span><span class="p">)</span> <span class="p">}}&lt;/</span><span class="nt">h3</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">ol</span><span class="p">&gt;</span>
          <span class="p">&lt;</span><span class="nt">li</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;record&#34;</span> <span class="nt">v-for</span><span class="s">=&#34;item in group.items&#34; :key=&#34;item.id&#34;&gt;
</span><span class="s">            &lt;span class=&#34;recordTag&#34;&gt;{{ tagToString(item.tags) }}&lt;/span&gt;
</span><span class="s">            &lt;div class=&#34;notes&#34;&gt;
</span><span class="s">              &lt;span class=&#34;tips&#34;&gt;备注：&lt;/span&gt;&lt;span class=&#34;text&#34;&gt;{{ item.tips }}&lt;/span&gt;
</span><span class="s">            &lt;/div&gt;
</span><span class="s">            &lt;span&gt;￥ {{ item.amount }}&lt;/span&gt;
</span><span class="s">          &lt;/li&gt;
</span><span class="s">        &lt;/ol&gt;
</span><span class="s">      &lt;/li&gt;
</span><span class="s">    &lt;/ol&gt;
</span><span class="s">  &lt;/Layout&gt;
</span><span class="s">&lt;/template&gt;
</span><span class="s">
</span><span class="s">&lt;script lang=&#34;ts&#34;</span><span class="p">&gt;</span>
<span class="na">import</span> <span class="na">Vue</span> <span class="na">from</span> <span class="err">&#39;</span><span class="na">vue</span><span class="err">&#39;;</span>
<span class="na">import</span> <span class="p">{</span><span class="na">Component</span><span class="p">}</span> <span class="na">from</span> <span class="err">&#39;</span><span class="na">vue</span><span class="nt">-property-decorator</span><span class="err">&#39;;</span>
<span class="na">import</span> <span class="na">Tabs</span> <span class="na">from</span> <span class="err">&#39;@/</span><span class="na">components</span><span class="err">/</span><span class="na">Tabs.vue</span><span class="err">&#39;;</span>
<span class="na">import</span> <span class="na">recordTypeList</span> <span class="na">from</span> <span class="err">&#39;@/</span><span class="na">constants</span><span class="err">/</span><span class="na">recordTypeList.ts</span><span class="err">&#39;;</span>
<span class="na">import</span> <span class="na">dayjs</span> <span class="na">from</span> <span class="err">&#39;</span><span class="na">dayjs</span><span class="err">&#39;;</span>
<span class="na">import</span> <span class="err">&#39;</span><span class="na">dayjs</span><span class="err">/</span><span class="na">locale</span><span class="err">/</span><span class="na">zh</span><span class="nt">-cn</span><span class="err">&#39;;</span>
<span class="na">import</span> <span class="na">clone</span> <span class="na">from</span> <span class="err">&#39;@/</span><span class="na">lib</span><span class="err">/</span><span class="na">clone.ts</span><span class="err">&#39;;</span>

<span class="na">dayjs.locale</span><span class="err">(&#39;</span><span class="na">zh</span><span class="nt">-cn</span><span class="err">&#39;);</span>

<span class="err">@</span><span class="na">Component</span><span class="err">(</span><span class="p">{</span>
  <span class="na">components</span><span class="o">:</span> <span class="p">{</span><span class="na">Tabs</span><span class="p">}</span><span class="err">,</span>
<span class="p">}</span><span class="err">)</span>
<span class="na">export</span> <span class="na">default</span> <span class="na">class</span> <span class="na">Statistics</span> <span class="na">extends</span> <span class="na">Vue</span> <span class="p">{</span>
  <span class="na">type </span><span class="o">=</span> <span class="s">&#39;-&#39;</span><span class="err">;</span>
  <span class="na">recordTypeList </span><span class="o">=</span> <span class="na">recordTypeList</span><span class="err">;</span>

  <span class="na">beforeCreate</span><span class="err">()</span> <span class="p">{</span>
    <span class="na">this.</span><span class="err">$</span><span class="na">store.commit</span><span class="err">(&#39;</span><span class="na">fetchRecords</span><span class="err">&#39;);</span>
  <span class="p">}</span>

  <span class="na">get</span> <span class="na">recordList</span><span class="err">()</span> <span class="p">{</span>
    <span class="na">return</span> <span class="na">this.</span><span class="err">$</span><span class="na">store.state.recordStore.recordList</span><span class="err">;</span>
  <span class="p">}</span>

  <span class="na">get</span> <span class="na">groupedList</span><span class="err">()</span> <span class="p">{</span>
    <span class="na">const</span> <span class="p">{</span><span class="na">recordList</span><span class="p">}</span> <span class="err">=</span> <span class="na">this</span><span class="err">;</span>
    <span class="na">if</span> <span class="err">(</span><span class="na">recordList.length</span> <span class="err">===</span> <span class="na">0</span><span class="err">)</span> <span class="p">{</span><span class="na">return</span> <span class="err">[];</span><span class="p">}</span>
    <span class="na">type</span> <span class="na">groupedType </span><span class="o">=</span> <span class="p">{</span> <span class="nx">title</span><span class="o">:</span> <span class="nx">string</span><span class="p">;</span> <span class="nx">items</span><span class="o">:</span> <span class="nx">RecordItem</span><span class="p">[]</span> <span class="p">}</span><span class="err">;</span>
    <span class="na">const</span> <span class="na">newList </span><span class="o">=</span> <span class="na">clone</span><span class="err">(</span><span class="na">recordList</span><span class="err">)</span><span class="na">.sort</span><span class="err">((</span><span class="na">a</span><span class="o">:</span> <span class="na">RecordItem</span><span class="err">,</span> <span class="na">b</span><span class="o">:</span> <span class="na">RecordItem</span><span class="err">)</span> <span class="err">=</span><span class="p">&gt;</span> <span class="p">(</span>
        <span class="nx">dayjs</span><span class="p">(</span><span class="nx">b</span><span class="p">.</span><span class="nx">createdAt</span><span class="p">).</span><span class="nx">valueOf</span><span class="p">()</span> <span class="o">-</span> <span class="nx">dayjs</span><span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">createdAt</span><span class="p">).</span><span class="nx">valueOf</span><span class="p">()</span>
    <span class="p">));</span>
    <span class="cm">/* newList
</span><span class="cm">    { tags: Tag[];
</span><span class="cm">      tips: string;
</span><span class="cm">      type: string;
</span><span class="cm">      amount: number;
</span><span class="cm">      createdAt: string;
</span><span class="cm">    }[]
</span><span class="cm">  */</span>
    <span class="c1">// 排序后的第一项 newList[0] 处理后 作为初始项
</span><span class="c1"></span>    <span class="kr">const</span> <span class="nx">result</span><span class="o">:</span> <span class="nx">groupedType</span><span class="p">[]</span> <span class="o">=</span> <span class="p">[{</span>
      <span class="nx">title</span><span class="o">:</span> <span class="nx">dayjs</span><span class="p">(</span><span class="nx">newList</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">createdAt</span><span class="p">).</span><span class="nx">format</span><span class="p">(</span><span class="s1">&#39;YYYY-MM-DD&#39;</span><span class="p">),</span>
      <span class="nx">items</span><span class="o">:</span> <span class="p">[</span><span class="nx">newList</span><span class="p">[</span><span class="mi">0</span><span class="p">],]</span>
    <span class="p">}];</span>
    <span class="c1">// 判断 newList[i] 从第二项开始的每一项的title: &#39;20XX-XX-XX&#39;  是否符合当前 分组项
</span><span class="c1"></span>    <span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">newList</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="kr">const</span> <span class="nx">current</span> <span class="o">=</span> <span class="nx">newList</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span> <span class="c1">// 当前项
</span><span class="c1"></span>      <span class="kr">const</span> <span class="nx">lastGroupItem</span> <span class="o">=</span> <span class="nx">result</span><span class="p">[</span><span class="nx">result</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="mi">1</span><span class="p">];</span> <span class="c1">// 分组数据的最后一项
</span><span class="c1"></span>      <span class="kr">const</span> <span class="nx">localDay</span> <span class="o">=</span> <span class="nx">dayjs</span><span class="p">(</span><span class="nx">current</span><span class="p">.</span><span class="nx">createdAt</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s1">&#39;T&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]);</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">dayjs</span><span class="p">(</span><span class="nx">lastGroupItem</span><span class="p">.</span><span class="nx">title</span><span class="p">).</span><span class="nx">isSame</span><span class="p">(</span><span class="nx">localDay</span><span class="p">,</span> <span class="s1">&#39;day&#39;</span><span class="p">))</span> <span class="p">{</span>
        <span class="nx">lastGroupItem</span><span class="p">.</span><span class="nx">items</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">current</span><span class="p">);</span>
      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nx">result</span><span class="p">.</span><span class="nx">push</span><span class="p">({</span>
          <span class="nx">title</span><span class="o">:</span> <span class="nx">localDay</span><span class="p">.</span><span class="nx">format</span><span class="p">(</span><span class="s1">&#39;YYYY-MM-DD&#39;</span><span class="p">),</span>
          <span class="nx">items</span><span class="o">:</span> <span class="p">[</span><span class="nx">current</span><span class="p">]</span>
        <span class="p">});</span>
      <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nx">result</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="nx">tagToString</span><span class="p">(</span><span class="nx">tags</span><span class="o">:</span> <span class="nx">Tag</span><span class="p">[])</span> <span class="p">{</span>
    <span class="kr">const</span> <span class="nx">names</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">tags</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">names</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">tags</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">name</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nx">names</span><span class="p">.</span><span class="nx">length</span> <span class="o">===</span> <span class="mi">0</span> <span class="o">?</span> <span class="s1">&#39;无&#39;</span> <span class="o">:</span> <span class="nx">names</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="nx">showDay</span><span class="p">(</span><span class="nx">someday</span><span class="o">:</span> <span class="nx">string</span><span class="p">)</span> <span class="p">{</span>
    <span class="kr">const</span> <span class="nx">now</span> <span class="o">=</span> <span class="nx">dayjs</span><span class="p">(</span><span class="k">new</span> <span class="nb">Date</span><span class="p">());</span>
    <span class="kr">const</span> <span class="nx">thatDay</span> <span class="o">=</span> <span class="nx">dayjs</span><span class="p">(</span><span class="nx">someday</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">thatDay</span><span class="p">.</span><span class="nx">isSame</span><span class="p">(</span><span class="nx">now</span><span class="p">,</span> <span class="s1">&#39;day&#39;</span><span class="p">))</span> <span class="p">{</span>
      <span class="k">return</span> <span class="s1">&#39;今天&#39;</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">thatDay</span><span class="p">.</span><span class="nx">isSame</span><span class="p">(</span><span class="nx">now</span><span class="p">.</span><span class="nx">subtract</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;day&#39;</span><span class="p">),</span> <span class="s1">&#39;day&#39;</span><span class="p">))</span> <span class="p">{</span>
      <span class="k">return</span> <span class="s1">&#39;昨天&#39;</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">thatDay</span><span class="p">.</span><span class="nx">isSame</span><span class="p">(</span><span class="nx">now</span><span class="p">.</span><span class="nx">subtract</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;day&#39;</span><span class="p">),</span> <span class="s1">&#39;day&#39;</span><span class="p">))</span> <span class="p">{</span>
      <span class="k">return</span> <span class="s1">&#39;前天&#39;</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">thatDay</span><span class="p">.</span><span class="nx">isSame</span><span class="p">(</span><span class="nx">now</span><span class="p">,</span> <span class="s1">&#39;year&#39;</span><span class="p">))</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">thatDay</span><span class="p">.</span><span class="nx">format</span><span class="p">(</span><span class="s1">&#39;M月D日&#39;</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">thatDay</span><span class="p">.</span><span class="nx">format</span><span class="p">(</span><span class="s1">&#39;YYYY年M月D日&#39;</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">}</span>

<span class="p">}</span>
<span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>

<span class="p">&lt;</span><span class="nt">style</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;scss&#34;</span> <span class="na">scoped</span><span class="p">&gt;</span>
<span class="err">@</span><span class="kr">import</span> <span class="s2">&#34;~@/assets/style/global.scss&#34;</span><span class="p">;</span>
<span class="p">...</span>
<span class="p">&lt;/</span><span class="nt">style</span><span class="p">&gt;</span>

</code></pre></td></tr></table>
</div>
</div><hr>
<h2 id="完成统计页面">完成统计页面</h2>
<h3 id="区分-支出和收入">区分 支出和收入</h3>
<blockquote>
<p>在排序前加 <code>filter</code></p>
</blockquote>
<ul>
<li>查找对应类型相匹配的</li>
<li><code>.filter(r=&gt; r.type === this.type)</code></li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-TypeScript" data-lang="TypeScript"><span class="p">...</span>
    <span class="kr">const</span> <span class="p">{</span><span class="nx">recordList</span><span class="p">}</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
    <span class="kr">type</span> <span class="nx">groupedType</span> <span class="o">=</span> <span class="p">{</span> <span class="nx">title</span>: <span class="kt">string</span><span class="p">;</span> <span class="nx">total?</span>: <span class="kt">number</span><span class="p">;</span> <span class="nx">items</span>: <span class="kt">RecordItem</span><span class="p">[]</span> <span class="p">};</span>
    <span class="c1">// newList: { tags: Tag[]; tips: string; type: string; amount: number; createdAt: string; }[]
</span><span class="c1"></span>    <span class="k">if</span> <span class="p">(</span><span class="nx">recordList</span><span class="p">.</span><span class="nx">length</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span><span class="k">return</span> <span class="p">[]</span> <span class="kr">as</span> <span class="nx">groupedType</span><span class="p">[];};</span>
    <span class="kr">const</span> <span class="nx">newList</span> <span class="o">=</span> <span class="nx">clone</span><span class="p">(</span><span class="nx">recordList</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">filter</span><span class="p">((</span><span class="nx">r</span>: <span class="kt">RecordItem</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">r</span><span class="p">.</span><span class="kr">type</span> <span class="o">===</span> <span class="k">this</span><span class="p">.</span><span class="kr">type</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">sort</span><span class="p">((</span><span class="nx">a</span>: <span class="kt">RecordItem</span><span class="p">,</span> <span class="nx">b</span>: <span class="kt">RecordItem</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">(</span>
            <span class="nx">dayjs</span><span class="p">(</span><span class="nx">b</span><span class="p">.</span><span class="nx">createdAt</span><span class="p">).</span><span class="nx">valueOf</span><span class="p">()</span> <span class="o">-</span> <span class="nx">dayjs</span><span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">createdAt</span><span class="p">).</span><span class="nx">valueOf</span><span class="p">()</span>
        <span class="p">));</span>
<span class="p">...</span>
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>注意 <code>.filter()</code>可能会使返回的新数组长度变短为空数组，进行之后的操作的时候访问内部属性为空值<code>undefined</code></p>
</blockquote>
<ul>
<li>判断经过筛选后的数组长度是否为 0 ，返回空数组，结束函数</li>
<li><code>if (newList.length === 0) {return [] as groupedType[];}</code></li>
</ul>
<hr>
<h3 id="显示总额">显示总额</h3>
<ul>
<li>给<code>result</code>添加<code>total</code>属性
<ul>
<li>初始化<code>{ title: ..., total: 0, items: ...}</code></li>
<li>或者声明类型：<code>type groupedType = { title: string; total?: number; items: RecordItem[] };</code></li>
<li><code>total?: number;</code> 表示赋值时，<code>total</code>属性可以不存在</li>
<li><code>const result: groupedType[] = {...}</code></li>
</ul>
</li>
<li>需要统计的是每组<code>group</code>各项<code>items</code>的<code>amount</code>属性</li>
<li>使用<code>.map</code>遍历每组<code>group</code>（<code>map</code>是有返回值的<code>forEach</code>；<code>forEach</code>是没有返回值的<code>map</code>）
<ul>
<li>使用<code>reduce</code>对每组<code>group</code>的<code>items</code>进行归纳统计
<ul>
<li>初始值<code>0</code></li>
<li>形参为 统计结果<code>sum</code> 项目<code>item</code></li>
<li>将<code>amount</code>进行加减，统计到<code>result</code>的<code>total</code>属性</li>
<li>注意<code>amount</code>类型</li>
</ul>
</li>
<li>将统计结赋值给<code>group.total</code></li>
</ul>
</li>
<li>将<code>total</code>显示到<code>template</code>：
<ul>
<li><code>&lt;h3 class=&quot;title&quot;&gt;{{ showDay(group.title) }} &lt;span&gt; ￥{{ group.total }}&lt;/span&gt;&lt;/h3&gt;</code></li>
</ul>
</li>
</ul>
<blockquote>
<p>标记问题 记录bug:</p>
</blockquote>
<ul>
<li><code>amount</code>显示为字符串拼接</li>
<li>从输入得到的类型为字符串而非数字</li>
<li>在<code>Numpad.vue</code>中传入的外部数据<code>@Prop() readonly value!: number;</code>没有声明类型</li>
<li>必须提前声明传入的类型<code>@Prop(Number) readonly value!: number;</code></li>
<li><code>amount</code>在<code>&lt;Numpad :value.sync=&quot;record.amount&quot; @submit=&quot;saveRecord&quot;/&gt;</code>处更新</li>
<li><code>Numpad.vue</code>中方法<code>confirmNum() {this.$emit(...)}</code>发布的第二个参数<code>output</code>类型是<code>any</code>，必须转为数字类型</li>
<li>查看<code>localStorage</code>中<code>recordList</code>的数据<code>amount</code>属性值都是字符串，应为数字</li>
</ul>
<blockquote>
<p><code>Statistic.vue </code></p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-vue" data-lang="vue"><span class="p">&lt;</span><span class="nt">template</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">Layout</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;statistics&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">Tabs</span> <span class="na">class</span><span class="nt">-prefix</span><span class="err">=&#34;</span><span class="na">type</span><span class="err">&#34;</span> <span class="nt">:data-source</span><span class="s">=&#34;recordTypeList&#34;</span> <span class="nt">:type.sync</span><span class="s">=&#34;type&#34;</span><span class="p">/&gt;</span>
    <span class="p">&lt;</span><span class="nt">ol</span><span class="p">&gt;</span>
      <span class="p">&lt;</span><span class="nt">li</span> <span class="nt">v-for</span><span class="s">=&#34;(group, index) in groupedList&#34; </span><span class="nt">:key</span><span class="s">=&#34;index&#34;</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">h3</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;title&#34;</span><span class="p">&gt;{{</span> <span class="nx">showDay</span><span class="p">(</span><span class="nx">group</span><span class="p">.</span><span class="nx">title</span><span class="p">)</span> <span class="p">}}</span> <span class="p">&lt;</span><span class="nt">span</span><span class="p">&gt;</span> <span class="err">￥</span><span class="p">{{</span> <span class="nx">group</span><span class="p">.</span><span class="nx">total</span> <span class="p">}}&lt;/</span><span class="nt">span</span><span class="p">&gt;&lt;/</span><span class="nt">h3</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">ol</span><span class="p">&gt;</span>
          <span class="p">&lt;</span><span class="nt">li</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;record&#34;</span> <span class="nt">v-for</span><span class="s">=&#34;item in group.items&#34; :key=&#34;item.id&#34;&gt;
</span><span class="s">            &lt;span class=&#34;recordTag&#34;&gt;{{ tagToString(item.tags) }}&lt;/span&gt;
</span><span class="s">            &lt;div class=&#34;notes&#34;&gt;
</span><span class="s">              &lt;span class=&#34;tips&#34;&gt;备注：&lt;/span&gt;&lt;span class=&#34;text&#34;&gt;{{ item.tips }}&lt;/span&gt;
</span><span class="s">            &lt;/div&gt;
</span><span class="s">            &lt;span&gt;￥ {{ item.amount }}&lt;/span&gt;
</span><span class="s">          &lt;/li&gt;
</span><span class="s">        &lt;/ol&gt;
</span><span class="s">      &lt;/li&gt;
</span><span class="s">    &lt;/ol&gt;
</span><span class="s">  &lt;/Layout&gt;
</span><span class="s">&lt;/template&gt;
</span><span class="s">
</span><span class="s">&lt;script lang=&#34;ts&#34;</span><span class="p">&gt;</span>
<span class="na">import</span> <span class="na">Vue</span> <span class="na">from</span> <span class="err">&#39;</span><span class="na">vue</span><span class="err">&#39;;</span>
<span class="na">import</span> <span class="p">{</span><span class="na">Component</span><span class="p">}</span> <span class="na">from</span> <span class="err">&#39;</span><span class="na">vue</span><span class="nt">-property-decorator</span><span class="err">&#39;;</span>
<span class="na">import</span> <span class="na">Tabs</span> <span class="na">from</span> <span class="err">&#39;@/</span><span class="na">components</span><span class="err">/</span><span class="na">Tabs.vue</span><span class="err">&#39;;</span>
<span class="na">import</span> <span class="na">recordTypeList</span> <span class="na">from</span> <span class="err">&#39;@/</span><span class="na">constants</span><span class="err">/</span><span class="na">recordTypeList.ts</span><span class="err">&#39;;</span>
<span class="na">import</span> <span class="na">dayjs</span> <span class="na">from</span> <span class="err">&#39;</span><span class="na">dayjs</span><span class="err">&#39;;</span>
<span class="na">import</span> <span class="err">&#39;</span><span class="na">dayjs</span><span class="err">/</span><span class="na">locale</span><span class="err">/</span><span class="na">zh</span><span class="nt">-cn</span><span class="err">&#39;;</span>
<span class="na">import</span> <span class="na">clone</span> <span class="na">from</span> <span class="err">&#39;@/</span><span class="na">lib</span><span class="err">/</span><span class="na">clone.ts</span><span class="err">&#39;;</span>

<span class="na">dayjs.locale</span><span class="err">(&#39;</span><span class="na">zh</span><span class="nt">-cn</span><span class="err">&#39;);</span>

<span class="err">@</span><span class="na">Component</span><span class="err">(</span><span class="p">{</span>
  <span class="na">components</span><span class="o">:</span> <span class="p">{</span><span class="na">Tabs</span><span class="p">}</span><span class="err">,</span>
<span class="p">}</span><span class="err">)</span>
<span class="na">export</span> <span class="na">default</span> <span class="na">class</span> <span class="na">Statistics</span> <span class="na">extends</span> <span class="na">Vue</span> <span class="p">{</span>
  <span class="na">type </span><span class="o">=</span> <span class="s">&#39;-&#39;</span><span class="err">;</span>
  <span class="na">recordTypeList </span><span class="o">=</span> <span class="na">recordTypeList</span><span class="err">;</span>

  <span class="na">beforeCreate</span><span class="err">()</span> <span class="p">{</span>
    <span class="na">this.</span><span class="err">$</span><span class="na">store.commit</span><span class="err">(&#39;</span><span class="na">fetchRecords</span><span class="err">&#39;);</span>
  <span class="p">}</span>

  <span class="na">get</span> <span class="na">recordList</span><span class="err">()</span> <span class="p">{</span>
    <span class="na">return</span> <span class="na">this.</span><span class="err">$</span><span class="na">store.state.recordStore.recordList</span><span class="err">;</span>
  <span class="p">}</span>

  <span class="na">get</span> <span class="na">groupedList</span><span class="err">()</span> <span class="p">{</span>
    <span class="na">const</span> <span class="p">{</span><span class="na">recordList</span><span class="p">}</span> <span class="err">=</span> <span class="na">this</span><span class="err">;</span>
    <span class="na">type</span> <span class="na">groupedType </span><span class="o">=</span> <span class="p">{</span> <span class="nx">title</span><span class="o">:</span> <span class="nx">string</span><span class="p">;</span> <span class="nx">total</span><span class="o">?:</span> <span class="nx">number</span><span class="p">;</span> <span class="nx">items</span><span class="o">:</span> <span class="nx">RecordItem</span><span class="p">[]</span> <span class="p">}</span><span class="err">;</span>
    <span class="err">//</span> <span class="na">newList</span><span class="o">:</span> <span class="p">{</span> <span class="na">tags</span><span class="o">:</span> <span class="na">Tag</span><span class="err">[];</span> <span class="na">tips</span><span class="o">:</span> <span class="na">string</span><span class="err">;</span> <span class="na">type</span><span class="o">:</span> <span class="na">string</span><span class="err">;</span> <span class="na">amount</span><span class="o">:</span> <span class="na">number</span><span class="err">;</span> <span class="na">createdAt</span><span class="o">:</span> <span class="na">string</span><span class="err">;</span> <span class="p">}</span><span class="err">[]</span>
    <span class="na">const</span> <span class="na">newList </span><span class="o">=</span> <span class="na">clone</span><span class="err">(</span><span class="na">recordList</span><span class="err">)</span>
        <span class="na">.filter</span><span class="err">((</span><span class="na">r</span><span class="o">:</span> <span class="na">RecordItem</span><span class="err">)</span> <span class="err">=</span><span class="p">&gt;</span> <span class="nx">r</span><span class="p">.</span><span class="nx">type</span> <span class="o">===</span> <span class="k">this</span><span class="p">.</span><span class="nx">type</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">sort</span><span class="p">((</span><span class="nx">a</span><span class="o">:</span> <span class="nx">RecordItem</span><span class="p">,</span> <span class="nx">b</span><span class="o">:</span> <span class="nx">RecordItem</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">(</span>
            <span class="nx">dayjs</span><span class="p">(</span><span class="nx">b</span><span class="p">.</span><span class="nx">createdAt</span><span class="p">).</span><span class="nx">valueOf</span><span class="p">()</span> <span class="o">-</span> <span class="nx">dayjs</span><span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">createdAt</span><span class="p">).</span><span class="nx">valueOf</span><span class="p">()</span>
        <span class="p">));</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">newList</span><span class="p">.</span><span class="nx">length</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span><span class="k">return</span> <span class="p">[]</span> <span class="nx">as</span> <span class="nx">groupedType</span><span class="p">[];}</span>
    <span class="c1">// 排序后的第一项 newList[0] 处理后 作为初始项
</span><span class="c1"></span>    <span class="kr">const</span> <span class="nx">result</span><span class="o">:</span> <span class="nx">groupedType</span><span class="p">[]</span> <span class="o">=</span> <span class="p">[{</span>
      <span class="nx">title</span><span class="o">:</span> <span class="nx">dayjs</span><span class="p">(</span><span class="nx">newList</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">createdAt</span><span class="p">).</span><span class="nx">format</span><span class="p">(</span><span class="s1">&#39;YYYY-MM-DD&#39;</span><span class="p">),</span>
      <span class="nx">items</span><span class="o">:</span> <span class="p">[</span><span class="nx">newList</span><span class="p">[</span><span class="mi">0</span><span class="p">],]</span>
    <span class="p">}];</span>
    <span class="c1">// 判断 newList[i] 从第二项开始的每一项的title: &#39;20XX-XX-XX&#39;  是否符合当前 分组项
</span><span class="c1"></span>    <span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">newList</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="kr">const</span> <span class="nx">current</span> <span class="o">=</span> <span class="nx">newList</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span> <span class="c1">// 当前项
</span><span class="c1"></span>      <span class="kr">const</span> <span class="nx">lastGroupItem</span> <span class="o">=</span> <span class="nx">result</span><span class="p">[</span><span class="nx">result</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="mi">1</span><span class="p">];</span> <span class="c1">// 分组数据的最后一项
</span><span class="c1"></span>      <span class="kr">const</span> <span class="nx">localDay</span> <span class="o">=</span> <span class="nx">dayjs</span><span class="p">(</span><span class="nx">current</span><span class="p">.</span><span class="nx">createdAt</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s1">&#39;T&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]);</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">dayjs</span><span class="p">(</span><span class="nx">lastGroupItem</span><span class="p">.</span><span class="nx">title</span><span class="p">).</span><span class="nx">isSame</span><span class="p">(</span><span class="nx">localDay</span><span class="p">,</span> <span class="s1">&#39;day&#39;</span><span class="p">))</span> <span class="p">{</span>
        <span class="nx">lastGroupItem</span><span class="p">.</span><span class="nx">items</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">current</span><span class="p">);</span>
      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nx">result</span><span class="p">.</span><span class="nx">push</span><span class="p">({</span>
          <span class="nx">title</span><span class="o">:</span> <span class="nx">localDay</span><span class="p">.</span><span class="nx">format</span><span class="p">(</span><span class="s1">&#39;YYYY-MM-DD&#39;</span><span class="p">),</span>
          <span class="nx">items</span><span class="o">:</span> <span class="p">[</span><span class="nx">current</span><span class="p">]</span>
        <span class="p">});</span>
      <span class="p">}</span>
    <span class="p">}</span>
    <span class="c1">// result.group.items: { tags: Tag[]; tips: string; type: string; amount: number; createdAt: string; }[]
</span><span class="c1"></span>    <span class="nx">result</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">group</span> <span class="p">=&gt;</span> <span class="p">{</span>
      <span class="nx">group</span><span class="p">.</span><span class="nx">total</span> <span class="o">=</span> <span class="nx">group</span><span class="p">.</span><span class="nx">items</span><span class="p">.</span><span class="nx">reduce</span><span class="p">((</span><span class="nx">sum</span><span class="p">,</span> <span class="nx">item</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="nx">sum</span> <span class="o">+</span> <span class="nx">item</span><span class="p">.</span><span class="nx">amount</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
    <span class="p">});</span>
    <span class="k">return</span> <span class="nx">result</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="nx">tagToString</span><span class="p">(</span><span class="nx">tags</span><span class="o">:</span> <span class="nx">Tag</span><span class="p">[])</span> <span class="p">{</span>
    <span class="kr">const</span> <span class="nx">names</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">tags</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">names</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">tags</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">name</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nx">names</span><span class="p">.</span><span class="nx">length</span> <span class="o">===</span> <span class="mi">0</span> <span class="o">?</span> <span class="s1">&#39;无&#39;</span> <span class="o">:</span> <span class="nx">names</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="nx">showDay</span><span class="p">(</span><span class="nx">someday</span><span class="o">:</span> <span class="nx">string</span><span class="p">)</span> <span class="p">{</span>
    <span class="kr">const</span> <span class="nx">now</span> <span class="o">=</span> <span class="nx">dayjs</span><span class="p">(</span><span class="k">new</span> <span class="nb">Date</span><span class="p">());</span>
    <span class="kr">const</span> <span class="nx">thatDay</span> <span class="o">=</span> <span class="nx">dayjs</span><span class="p">(</span><span class="nx">someday</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">thatDay</span><span class="p">.</span><span class="nx">isSame</span><span class="p">(</span><span class="nx">now</span><span class="p">,</span> <span class="s1">&#39;day&#39;</span><span class="p">))</span> <span class="p">{</span>
      <span class="k">return</span> <span class="s1">&#39;今天&#39;</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">thatDay</span><span class="p">.</span><span class="nx">isSame</span><span class="p">(</span><span class="nx">now</span><span class="p">.</span><span class="nx">subtract</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;day&#39;</span><span class="p">),</span> <span class="s1">&#39;day&#39;</span><span class="p">))</span> <span class="p">{</span>
      <span class="k">return</span> <span class="s1">&#39;昨天&#39;</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">thatDay</span><span class="p">.</span><span class="nx">isSame</span><span class="p">(</span><span class="nx">now</span><span class="p">.</span><span class="nx">subtract</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;day&#39;</span><span class="p">),</span> <span class="s1">&#39;day&#39;</span><span class="p">))</span> <span class="p">{</span>
      <span class="k">return</span> <span class="s1">&#39;前天&#39;</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">thatDay</span><span class="p">.</span><span class="nx">isSame</span><span class="p">(</span><span class="nx">now</span><span class="p">,</span> <span class="s1">&#39;year&#39;</span><span class="p">))</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">thatDay</span><span class="p">.</span><span class="nx">format</span><span class="p">(</span><span class="s1">&#39;M月D日&#39;</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">thatDay</span><span class="p">.</span><span class="nx">format</span><span class="p">(</span><span class="s1">&#39;YYYY年M月D日&#39;</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">}</span>

<span class="p">}</span>
<span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>

<span class="p">&lt;</span><span class="nt">style</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;scss&#34;</span> <span class="na">scoped</span><span class="p">&gt;</span>
<span class="err">@</span><span class="kr">import</span> <span class="s2">&#34;~@/assets/style/global.scss&#34;</span><span class="p">;</span>
<span class="p">...</span>
<span class="p">&lt;/</span><span class="nt">style</span><span class="p">&gt;</span>

</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>Vue 和 TypeScript第二个结合不好的地方：<code>this.$emit(event, ...args)</code></p>
</blockquote>
<ul>
<li>TS <strong>没有在<code>this.$emit()</code>处警告<code>...args</code>的<code>any</code>类型</strong></li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-TypeScript" data-lang="TypeScript"><span class="p">...</span>
    <span class="c1">// result.group.items: { tags: Tag[]; tips: string; type: string; amount: number; createdAt: string; }[]
</span><span class="c1"></span>    <span class="nx">result</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">group</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="nx">group</span><span class="p">.</span><span class="nx">total</span> <span class="o">=</span> <span class="nx">group</span><span class="p">.</span><span class="nx">items</span><span class="p">.</span><span class="nx">reduce</span><span class="p">((</span><span class="nx">sum</span><span class="p">,</span> <span class="nx">item</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">sum</span> <span class="o">+</span> <span class="nx">item</span><span class="p">.</span><span class="nx">amount</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
    <span class="p">});</span>
<span class="p">...</span>
</code></pre></td></tr></table>
</div>
</div><hr>
<h2 id="一些-bug">一些 bug</h2>
<blockquote>
<p><code>Money.vue</code> <code>Tags.vue</code> <code>$event</code></p>
</blockquote>
<ul>
<li><code>&lt;Tags @update:selectedTags=&quot;pickTags($event)&quot;/&gt;</code>或不传值<code>&lt;Tags @update:selectedTags=&quot;pickTags&quot;/&gt;</code>，使用方法隐式传值，默认传<code>$event</code>
<ul>
<li><code>pickTags(eventValue: Tag[]) {this.record.tags = eventValue;}</code></li>
</ul>
</li>
<li><code>&lt;Tags @update:selectedTags=&quot;record.tags = $event&quot;/&gt;</code>内联语法，需要显示传值
<ul>
<li><code>pickTags(selectedTags: Tag[]) {this.record.tags = selectedTags;}</code></li>
</ul>
</li>
<li>参考
<ul>
<li><a href="https://cn.vuejs.org/v2/api/#v-on">v-on</a> <code>$event</code>
<ul>
<li>用在<strong>普通元素</strong>上时，只能<strong>监听<a href="https://developer.mozilla.org/zh-CN/docs/Web/Events">原生 DOM 事件</a></strong></li>
<li>用在自定义元素组件上时，也可以监听子组件触发的自定义事件</li>
<li>监听原生 DOM 事件时，方法以事件为唯一的参数。如果使用内联语句，语句可以访问一个 <code>$event property：v-on:click=&quot;handle('ok', $event)&quot;</code></li>
</ul>
</li>
<li><a href="https://cn.vuejs.org/v2/guide/components.html#%E4%BD%BF%E7%94%A8%E4%BA%8B%E4%BB%B6%E6%8A%9B%E5%87%BA%E4%B8%80%E4%B8%AA%E5%80%BC">使用事件抛出一个值</a>
<ul>
<li>子组件使用 $emit 的第二个参数来提供这个值<code>&lt;button v-on:click=&quot;$emit('enlarge-text', 0.1)&quot;&gt;Enlarge text&lt;/button&gt;</code></li>
<li>父级组件监听这个事件时，可通过 <code>$event</code> 访问到被抛出的这个值<code>&lt;blog-post v-on:enlarge-text=&quot;postFontSize += $event&quot;&gt;</code></li>
<li>如果这个事件处理函数是一个方法，这个值将会作为第一个参数传入这个方法</li>
</ul>
</li>
<li><a href="https://cn.vuejs.org/v2/guide/events.html#%E5%86%85%E8%81%94%E5%A4%84%E7%90%86%E5%99%A8%E4%B8%AD%E7%9A%84%E6%96%B9%E6%B3%95">内联处理器中的方法</a>
<ul>
<li>有时也需要在内联语句处理器中访问原始的 DOM 事件。可以用特殊变量 <code>$event</code> 把它传入方法</li>
</ul>
</li>
<li><a href="https://cn.vuejs.org/v2/guide/events.html#%E4%BA%8B%E4%BB%B6%E5%A4%84%E7%90%86%E6%96%B9%E6%B3%95">事件处理方法</a> v-on 还可以接收一个需要调用的<code>Methods</code>里方法名称
<ul>
<li>原生 DOM 事件 的<code>event</code> 作为参数传给方法
<ul>
<li>例如获取输入事件的输入值<code>@input=&quot;oninputValueChanged($event.target.value)&quot;</code></li>
<li>例如点击事件获取点击的目标值<code>@click=&quot;toggle(tag, $event.target.value)&quot;</code> 其中参数<code>tag</code>由循环渲染列表的数据提供<code>v-for=&quot;tag in tagList&quot;</code></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<hr>
<blockquote>
<p>实现tooltip加个尖角标</p>
</blockquote>
<ul>
<li><code>formatter</code>函数拼接样式</li>
<li><a href="https://juejin.cn/post/6984639169653899277">echarts修改tooltip默认样式（使用formatter函数拼接加工）</a></li>
</ul>
<hr>
<blockquote>
<p>空白 无记录 提示文字</p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-JavaScript" data-lang="JavaScript">
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-HTML" data-lang="HTML">
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-SCSS" data-lang="SCSS">
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-TypeScript" data-lang="TypeScript">
</code></pre></td></tr></table>
</div>
</div><ul>
<li><code>Money.vue</code>缺 “添加至少一个标签” 逻辑</li>
<li>确认保存后 缺 重置备注 和标签 逻辑
<ul>
<li><code>&lt;FormItem class=&quot;form-item&quot; field-name=&quot;备注&quot; placeholder=&quot;在这里输入备注&quot; @update:inputValue=&quot;onUpdateTips&quot; :value=&quot;record.tips&quot;/&gt;</code> 需要绑定<code>:value=&quot;record.tips&quot;</code>才会起效</li>
</ul>
</li>
</ul>
<hr>
<blockquote>
<p>逻辑耦合</p>
</blockquote>
<ul>
<li><code>createTag</code>方法中当<code>store</code>提交<code>saveTags</code>成功保存完标签后，<code>window.alert('xxx')</code></li>
<li>收集错误提示，<code>alert</code>处理所有报错</li>
</ul>
<hr>
<h2 id="createdat-of-undefined-的解决办法">createdAt of undefined 的解决办法</h2>
<ul>
<li>即使返回空值有时也需声明类型<code>if (newList.length === 0) {return [] as groupedType[];}</code></li>
</ul>
<hr>
<ul>
<li>核心痛点：每次调用 <code>this.$store.dispatch</code> / <code>this.$store.commit</code> / <code>this.$store.state</code> / <code>this.$store.getters</code> 都会伴随着类型丢失。</li>
</ul>
<hr>
<ul>
<li>所有代码：https://github.com/FrankFang/morney-live-list</li>
<li>所有 commits：https://github.com/FrankFang/morney-live-list/commits/master</li>
</ul>
<blockquote>
<p>参考文档</p>
</blockquote>
<ul>
<li><a href="https://tech.meituan.com/2017/04/27/vuex-code-analysis.html">Vuex框架原理与源码分析-明裔</a></li>
<li><a href="https://juejin.cn/post/6844904002992209928/">Vue &amp; TypeScript 初体验</a></li>
<li><a href="http://www.quasarchs.com/"><code>http://www.quasarchs.com/</code></a></li>
<li><a href="https://ithelp.ithome.com.tw/articles/10214429/">Vuex 基本入門 Day 8</a></li>
<li><a href="https://mmf-fe.github.io/vue-typescript/zh-cn/Vuex.html">Vuex 模板使用了 vuex-class 简化 vuex</a></li>
<li><a href="https://www.wenyuanblog.com/blogs/vue-vuex-module-division-in-real-project.html">Vuex业务模块划分项目实例</a></li>
<li><a href="http://obkoro1.com/2017/12/09/%E6%89%8B%E6%91%B8%E6%89%8B%E6%95%99%E4%BD%A0%E5%9C%A8vue-cli%E9%87%8C%E9%9D%A2%E4%BD%BF%E7%94%A8vuex%EF%BC%8C%E4%BB%A5%E5%8F%8Avuex%E7%AE%80%E4%BB%8B/">手摸手教你在vue-cli里面使用vuex，以及vuex简介</a></li>
<li><a href="https://blog.csdn.net/fanweilin0123/article/details/109903447/">Vuex 4.0中使用typescript, Vuex4.0中modules的ts使用，Vue3 + Vuex4.0 + TypeScript 使用详情</a></li>
<li><a href="https://my.oschina.net/u/4327970/blog/3337405">Vuex 进阶使用之modules模块化划分、mapState、mapActions辅助函数的使用</a></li>
<li><a href="https://codertw.com/%E7%A8%8B%E5%BC%8F%E8%AA%9E%E8%A8%80/711241/">Vue&amp;TypeScript初體驗使用Vuex(vuexmoduledecorators)</a></li>
<li><a href="https://yq.aliyun.com/articles/738863">Vuex进阶篇——Module模块化学习</a></li>
<li><a href="https://juejin.cn/post/6844903807285985294/">更好的使用module vuex</a></li>
<li><a href="https://juejin.cn/post/6844903928149065742/">Vuex（module）</a></li>
<li><a href="https://blog.csdn.net/chenzhizhuo/article/details/96872320/">Vuex 之 module 使用方法及场景</a></li>
<li><a href="https://www.jianshu.com/p/aa022b1c6686/">Vuex 模块(Module)</a></li>
<li><a href="https://segmentfault.com/a/1190000019924674">Vuex 模块化使用</a></li>
<li><a href="https://segmentfault.com/a/1190000015782272">VueJS中学习使用Vuex详解</a></li>
<li><a href="https://zhuanlan.zhihu.com/p/59433637/">大型项目使用Vuex modules后，模块之间怎么访问action</a></li>
<li><a href="https://www.shangmayuan.com/a/e81f589be6254cdba88ef7bc.html">uni-app 使用vuex（vuex module）</a></li>
</ul>
<hr>

    </div>

    
    
<div class="post-copyright">
  <p class="copyright-item">
    <span class="item-title">文章作者</span>
    <span class="item-content">Joel Xu</span>
  </p>
  <p class="copyright-item">
    <span class="item-title">上次更新</span>
    <span class="item-content">
      2021-11-27
      
        
        
      
    </span>
  </p>
  
  <p class="copyright-item">
    <span class="item-title">许可协议</span>
    <span class="item-content"><a rel="license noopener" href="https://creativecommons.org/licenses/by-nc-nd/4.0/" target="_blank">CC BY-NC-ND 4.0</a></span>
  </p>
</div>


    
    

    <footer class="post-footer">
      <div class="post-tags">
          <a href="http://xmasuhai.xyz/tags/frontend/">FrontEnd</a>
          <a href="http://xmasuhai.xyz/tags/project/">Project</a>
          <a href="http://xmasuhai.xyz/tags/money/">money</a>
          
        </div>

      
      <nav class="post-nav">
        
          <a class="prev" href="/post/ajax/%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB0%E6%89%8B%E5%86%99%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%95%B0%E6%8D%AEmock%E5%89%8D%E5%90%8E%E7%AB%AF%E8%81%94%E8%B0%83/">
            
            <i class="iconfont">
              <svg  class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="18" height="18">
  <path d="M691.908486 949.511495l75.369571-89.491197c10.963703-12.998035 10.285251-32.864502-1.499144-44.378743L479.499795 515.267417 757.434875 204.940602c11.338233-12.190647 11.035334-32.285311-0.638543-44.850487l-80.46666-86.564541c-11.680017-12.583596-30.356378-12.893658-41.662889-0.716314L257.233596 494.235404c-11.332093 12.183484-11.041474 32.266891 0.657986 44.844348l80.46666 86.564541c1.772366 1.910513 3.706415 3.533476 5.750981 4.877077l306.620399 321.703933C662.505829 963.726242 680.945807 962.528973 691.908486 949.511495z"></path>
</svg>

            </i>
            <span class="prev-text nav-default">【前后端分离0】手写服务器、数据Mock、前后端联调</span>
            <span class="prev-text nav-mobile">上一篇</span>
          </a>
        
          <a class="next" href="/post/project/money/%E9%A1%B9%E7%9B%AE-%E5%96%B5%E5%86%85%E8%AE%B0%E8%B4%A6-meoney-04vue-%E5%85%A8%E5%B1%80%E6%95%B0%E6%8D%AE%E7%AE%A1%E7%90%86/">
            <span class="next-text nav-default">【项目 喵内记账 Meoney 04】Vue 全局数据管理</span>
            <span class="prev-text nav-mobile">下一篇</span>
            
            <i class="iconfont">
              <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="18" height="18">
  <path d="M332.091514 74.487481l-75.369571 89.491197c-10.963703 12.998035-10.285251 32.864502 1.499144 44.378743l286.278095 300.375162L266.565125 819.058374c-11.338233 12.190647-11.035334 32.285311 0.638543 44.850487l80.46666 86.564541c11.680017 12.583596 30.356378 12.893658 41.662889 0.716314l377.434212-421.426145c11.332093-12.183484 11.041474-32.266891-0.657986-44.844348l-80.46666-86.564541c-1.772366-1.910513-3.706415-3.533476-5.750981-4.877077L373.270379 71.774697C361.493148 60.273758 343.054193 61.470003 332.091514 74.487481z"></path>
</svg>

            </i>
          </a>
      </nav>
    </footer>
  </article>

  
  
  
  

  
  

  

  
  

  

  

  

    

  

        </div>
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="icon-links">
  
  
    <a href="mailto:xmasuhai@163.com" rel="me noopener" class="iconfont"
      title="email" >
      <svg class="icon" viewBox="0 0 1451 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="36" height="36">
  <path d="M664.781909 681.472759 0 97.881301C0 3.997201 71.046997 0 71.046997 0L474.477909 0 961.649408 0 1361.641813 0C1361.641813 0 1432.688811 3.997201 1432.688811 97.881301L771.345323 681.472759C771.345323 681.472759 764.482731 685.154773 753.594283 688.65053L753.594283 688.664858C741.602731 693.493018 729.424896 695.068979 718.077952 694.839748 706.731093 695.068979 694.553173 693.493018 682.561621 688.664858L682.561621 688.65053C671.644501 685.140446 664.781909 681.472759 664.781909 681.472759L664.781909 681.472759ZM718.063616 811.603883C693.779541 811.016482 658.879232 802.205449 619.10784 767.734955 542.989056 701.759633 0 212.052267 0 212.052267L0 942.809523C0 942.809523 0 1024 83.726336 1024L682.532949 1024 753.579947 1024 1348.948139 1024C1432.688811 1024 1432.688811 942.809523 1432.688811 942.809523L1432.688811 212.052267C1432.688811 212.052267 893.138176 701.759633 817.019477 767.734955 777.248 802.205449 742.347691 811.03081 718.063616 811.603883L718.063616 811.603883Z"></path>
</svg>

    </a>
  
    <a href="https://github.com/xmasuhai" rel="me noopener" class="iconfont"
      title="github"  target="_blank"
      >
      <svg class="icon" style="" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="36" height="36">
  <path d="M512 12.672c-282.88 0-512 229.248-512 512 0 226.261333 146.688 418.133333 350.08 485.76 25.6 4.821333 34.986667-11.008 34.986667-24.618667 0-12.16-0.426667-44.373333-0.64-87.04-142.421333 30.890667-172.458667-68.693333-172.458667-68.693333C188.672 770.986667 155.008 755.2 155.008 755.2c-46.378667-31.744 3.584-31.104 3.584-31.104 51.413333 3.584 78.421333 52.736 78.421333 52.736 45.653333 78.293333 119.850667 55.68 149.12 42.581333 4.608-33.109333 17.792-55.68 32.426667-68.48-113.706667-12.8-233.216-56.832-233.216-253.013333 0-55.893333 19.84-101.546667 52.693333-137.386667-5.76-12.928-23.04-64.981333 4.48-135.509333 0 0 42.88-13.738667 140.8 52.48 40.96-11.392 84.48-17.024 128-17.28 43.52 0.256 87.04 5.888 128 17.28 97.28-66.218667 140.16-52.48 140.16-52.48 27.52 70.528 10.24 122.581333 5.12 135.509333 32.64 35.84 52.48 81.493333 52.48 137.386667 0 196.693333-119.68 240-233.6 252.586667 17.92 15.36 34.56 46.762667 34.56 94.72 0 68.522667-0.64 123.562667-0.64 140.202666 0 13.44 8.96 29.44 35.2 24.32C877.44 942.592 1024 750.592 1024 524.672c0-282.752-229.248-512-512-512"></path>
</svg>

    </a>
  
    <a href="https://www.zhihu.com/people/xue-shou-41/posts" rel="me noopener" class="iconfont"
      title="zhihu"  target="_blank"
      >
      <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="36" height="36">
  <path d="M351.791182 562.469462l192.945407 0c0-45.367257-21.3871-71.939449-21.3871-71.939449L355.897709 490.530013c3.977591-82.182744 7.541767-187.659007 8.816806-226.835262l159.282726 0c0 0-0.86367-67.402109-18.578124-67.402109s-279.979646 0-279.979646 0 16.850783-88.141456 39.318494-127.053698c0 0-83.60514-4.510734-112.121614 106.962104S81.344656 355.077018 76.80834 367.390461c-4.536316 12.313443 24.62791 5.832845 36.941354 0 12.313443-5.832845 68.050885-25.924439 84.252893-103.69571l86.570681 0c1.165546 49.28652 4.596691 200.335724 3.515057 226.835262L109.86113 490.530013c-25.275663 18.147312-33.701566 71.939449-33.701566 71.939449L279.868105 562.469462c-8.497535 56.255235-23.417339 128.763642-44.275389 167.210279-33.05279 60.921511-50.55235 116.65793-169.802314 212.576513 0 0-19.442818 14.257725 40.829917 9.073656 60.273758-5.185093 117.305683-20.739347 156.840094-99.807147 20.553105-41.107233 41.805128-93.250824 58.386782-146.138358l-0.055259 0.185218 167.855986 193.263655c0 0 22.035876-51.847855 5.832845-108.880803L371.045711 650.610918l-42.1244 31.157627-0.045025 0.151449c11.69946-41.020252 20.11206-81.5749 22.726607-116.858498C351.665315 564.212152 351.72876 563.345412 351.791182 562.469462z"></path>
  <path d="M584.918753 182.033893l0 668.840094 70.318532 0 28.807093 80.512708 121.875768-80.512708 153.600307 0L959.520453 182.033893 584.918753 182.033893zM887.150192 778.934538l-79.837326 0-99.578949 65.782216-23.537066-65.782216-24.855084 0L659.341766 256.673847l227.807403 0L887.149169 778.934538z"></path>
</svg>

    </a>


<a href="http://xmasuhai.xyz/index.xml" rel="noopener alternate" type="application/rss&#43;xml"
    class="iconfont" title="rss" target="_blank">
    <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="30" height="30">
  <path d="M819.157333 1024C819.157333 574.592 449.408 204.8 0 204.8V0c561.706667 0 1024 462.293333 1024 1024h-204.842667zM140.416 743.04a140.8 140.8 0 0 1 140.501333 140.586667A140.928 140.928 0 0 1 140.074667 1024C62.72 1024 0 961.109333 0 883.626667s62.933333-140.544 140.416-140.586667zM678.784 1024h-199.04c0-263.210667-216.533333-479.786667-479.744-479.786667V345.173333c372.352 0 678.784 306.517333 678.784 678.826667z"></path>
</svg>

  </a>
   
</div>

<div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://gohugo.io">Hugo</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Theme - <a class="theme-link" href="https://github.com/xianmin/hugo-theme-jane">Jane</a>
  </span>

  <span class="copyright-year">
    &copy;
    
      2019 -
    2022
    <span class="heart">
      
      <i class="iconfont">
        <svg class="icon" viewBox="0 0 1025 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="14" height="14">
  <path d="M1000.1 247.9c-15.5-37.3-37.6-70.6-65.7-98.9-54.4-54.8-125.8-85-201-85-85.7 0-166 39-221.4 107.4C456.6 103 376.3 64 290.6 64c-75.1 0-146.5 30.4-201.1 85.6-28.2 28.5-50.4 61.9-65.8 99.3-16 38.8-24 79.9-23.6 122.2 0.7 91.7 40.1 177.2 108.1 234.8 3.1 2.6 6 5.1 8.9 7.8 14.9 13.4 58 52.8 112.6 102.7 93.5 85.5 209.9 191.9 257.5 234.2 7 6.1 15.8 9.5 24.9 9.5 9.2 0 18.1-3.4 24.9-9.5 34.5-30.7 105.8-95.9 181.4-165 74.2-67.8 150.9-138 195.8-178.2 69.5-57.9 109.6-144.4 109.9-237.3 0.1-42.5-8-83.6-24-122.2z"
   fill="#8a8a8a"></path>
</svg>

      </i>
    </span><span class="author">
        Joel Xu
        
      </span></span>

  
  

  
</div>

    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont">
        
        <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="35" height="35">
  <path d="M510.866688 227.694839 95.449397 629.218702l235.761562 0-2.057869 328.796468 362.40389 0L691.55698 628.188232l241.942331-3.089361L510.866688 227.694839zM63.840492 63.962777l894.052392 0 0 131.813095L63.840492 195.775872 63.840492 63.962777 63.840492 63.962777zM63.840492 63.962777"></path>
</svg>

      </i>
    </div>
  </div>
  
<script type="text/javascript" src="/lib/jquery/jquery-3.2.1.min.js"></script>
  <script type="text/javascript" src="/lib/slideout/slideout-1.0.1.min.js"></script>




<script type="text/javascript" src="/js/main.638251f4230630f0335d8c6748e53a96f94b72670920b60c09a56fdc8bece214.js" integrity="sha256-Y4JR9CMGMPAzXYxnSOU6lvlLcmcJILYMCaVv3Ivs4hQ=" crossorigin="anonymous"></script>












  
    <script type="text/javascript" src="/js/load-photoswipe.js"></script>
    <script type="text/javascript" src="/lib/photoswipe/photoswipe.min.js"></script>
    <script type="text/javascript" src="/lib/photoswipe/photoswipe-ui-default.min.js"></script>
  















</body>
</html>
