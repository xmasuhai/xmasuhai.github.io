<!DOCTYPE html>
<html lang="zh-cn" itemscope itemtype="http://schema.org/WebPage">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>【项目 Vue3 轮子】1.8 部署项目并且发布源代码至 Npm - Joel in The House</title>
  

<meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta name="MobileOptimized" content="width"/>
<meta name="HandheldFriendly" content="true"/>


<meta name="applicable-device" content="pc,mobile">

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">

<meta name="mobile-web-app-capable" content="yes">

<meta name="author" content="Joel Xu" />
  <meta name="description" content="部署项目并且发布源代码至 npm [toc] 部署官网到 GitHub 需要大致完成两件事 部署官网 让官网上线，有文档层能直观地被看到，才会有人去使用 发布 Vueel UI 让其他开发者可以" />

  <meta name="keywords" content="Hugo, theme, jane" />






<meta name="generator" content="Hugo 0.59.1" />


<link rel="canonical" href="http://xmasuhai.xyz/post/project/vueel3/%E9%A1%B9%E7%9B%AE-vue3-%E8%BD%AE%E5%AD%901.8-%E9%83%A8%E7%BD%B2%E9%A1%B9%E7%9B%AE%E5%B9%B6%E4%B8%94%E5%8F%91%E5%B8%83%E6%BA%90%E4%BB%A3%E7%A0%81%E8%87%B3-npm/" />





<link rel="icon" href="/favicon.ico" />











<link rel="stylesheet" href="/sass/jane.min.af20b78e95c84de86b00a0242a4a77bd2601700e1b250edf27537d957ac0041d.css" integrity="sha256-ryC3jpXITehrAKAkKkp3vSYBcA4bJQ7fJ1N9lXrABB0=" media="screen" crossorigin="anonymous">





<meta property="og:title" content="【项目 Vue3 轮子】1.8 部署项目并且发布源代码至 Npm" />
<meta property="og:description" content="部署项目并且发布源代码至 npm [toc] 部署官网到 GitHub 需要大致完成两件事 部署官网 让官网上线，有文档层能直观地被看到，才会有人去使用 发布 Vueel UI 让其他开发者可以" />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://xmasuhai.xyz/post/project/vueel3/%E9%A1%B9%E7%9B%AE-vue3-%E8%BD%AE%E5%AD%901.8-%E9%83%A8%E7%BD%B2%E9%A1%B9%E7%9B%AE%E5%B9%B6%E4%B8%94%E5%8F%91%E5%B8%83%E6%BA%90%E4%BB%A3%E7%A0%81%E8%87%B3-npm/" />
<meta property="article:published_time" content="2022-02-02T14:24:49+08:00" />
<meta property="article:modified_time" content="2022-06-28T08:41:45+08:00" />
<meta itemprop="name" content="【项目 Vue3 轮子】1.8 部署项目并且发布源代码至 Npm">
<meta itemprop="description" content="部署项目并且发布源代码至 npm [toc] 部署官网到 GitHub 需要大致完成两件事 部署官网 让官网上线，有文档层能直观地被看到，才会有人去使用 发布 Vueel UI 让其他开发者可以">


<meta itemprop="datePublished" content="2022-02-02T14:24:49&#43;08:00" />
<meta itemprop="dateModified" content="2022-06-28T08:41:45&#43;08:00" />
<meta itemprop="wordCount" content="5588">



<meta itemprop="keywords" content="FrontEnd,Project,vueel," />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="【项目 Vue3 轮子】1.8 部署项目并且发布源代码至 Npm"/>
<meta name="twitter:description" content="部署项目并且发布源代码至 npm [toc] 部署官网到 GitHub 需要大致完成两件事 部署官网 让官网上线，有文档层能直观地被看到，才会有人去使用 发布 Vueel UI 让其他开发者可以"/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->




</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">Joel in The House</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="http://xmasuhai.xyz/">主页</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="http://xmasuhai.xyz/post/">文档</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="http://xmasuhai.xyz/tags/">标签</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="http://xmasuhai.xyz/categories/">目录</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="http://xmasuhai.xyz/about/">关于我</a>
          
        
      </li>
    

    
  </ul>
</nav>


  
    






  <link rel="stylesheet" href="/lib/photoswipe/photoswipe.min.css" />
  <link rel="stylesheet" href="/lib/photoswipe/default-skin/default-skin.min.css" />




<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

<div class="pswp__bg"></div>

<div class="pswp__scroll-wrap">
    
    <div class="pswp__container">
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
    </div>
    
    <div class="pswp__ui pswp__ui--hidden">
    <div class="pswp__top-bar">
      
      <div class="pswp__counter"></div>
      <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
      <button class="pswp__button pswp__button--share" title="Share"></button>
      <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
      <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
      
      
      <div class="pswp__preloader">
        <div class="pswp__preloader__icn">
          <div class="pswp__preloader__cut">
            <div class="pswp__preloader__donut"></div>
          </div>
        </div>
      </div>
    </div>
    <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
      <div class="pswp__share-tooltip"></div>
    </div>
    <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
    </button>
    <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
    </button>
    <div class="pswp__caption">
      <div class="pswp__caption__center"></div>
    </div>
    </div>
    </div>
</div>

  

  

  

  <header id="header" class="header container">
    <div class="logo-wrapper">
  <a href="/" class="logo">
    
      Joel in The House
    
  </a>
</div>

<nav class="site-navbar">
  <ul id="menu" class="menu">
    
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="http://xmasuhai.xyz/">主页</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="http://xmasuhai.xyz/post/">文档</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="http://xmasuhai.xyz/tags/">标签</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="http://xmasuhai.xyz/categories/">目录</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="http://xmasuhai.xyz/about/">关于我</a>
          

        

      </li>
    

    
    

    
  </ul>
</nav>

  </header>

  <div id="mobile-panel">
    <main id="main" class="main bg-llight">
      <div class="content-wrapper">
        <div id="content" class="content container">
          <article class="post bg-white">
    
    <header class="post-header">
      <h1 class="post-title">【项目 Vue3 轮子】1.8 部署项目并且发布源代码至 Npm</h1>
      
      <div class="post-meta">
        <time datetime="2022-02-02" class="post-time">
          2022-02-02
        </time>
        <div class="post-category">
            
          </div>
        <span class="more-meta"> 约 5588 字 </span>
          <span class="more-meta"> 预计阅读 12 分钟 </span>

        
        

        
        
      </div>
    </header>

    
    
<div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">文章目录</h2>
  <div class="post-toc-content">
    <nav id="TableOfContents">
<ul>
<li><a href="#部署项目并且发布源代码至-npm">部署项目并且发布源代码至 npm</a>
<ul>
<li><a href="#部署官网到-github">部署官网到 GitHub</a>
<ul>
<li><a href="#发布官网">发布官网</a></li>
<li><a href="#发布官网的步骤">发布官网的步骤</a></li>
<li><a href="#设置-build-path">设置<code>build path</code></a></li>
<li><a href="#部署到码云">部署到码云</a></li>
<li><a href="#脚本化半自动部署">脚本化半自动部署</a></li>
<li><a href="#使用-github-actions-持续集成">使用<code>GitHub Actions</code>持续集成</a></li>
</ul></li>
<li><a href="#发布-vueel-ui-至-npm">发布 Vueel UI 至 npm</a>
<ul>
<li><a href="#打包库文件">打包库文件</a></li>
<li><a href="#rollup-c-编译库文件"><code>rollup -c</code>  编译库文件</a></li>
<li><a href="#解释-rollup-config-js">解释 rollup.config.js</a></li>
<li><a href="#发布-dist-lib-目录-上传到npm服务器">发布 <code>dist/lib</code> 目录，上传到npm服务器</a>
<ul>
<li><a href="#在-package-json-中添加-files-和-main">在<code>package.json</code>中添加<code>files</code>和<code>main</code></a></li>
<li><a href="#npm-login"><code>npm login</code></a></li>
<li><a href="#npm-publish"><code>npm publish</code></a></li>
<li><a href="#一些细节">一些细节</a></li>
<li><a href="#小技巧">小技巧</a></li>
</ul></li>
</ul></li>
<li><a href="#模拟别人使用自己的组件">模拟别人使用自己的组件</a>
<ul>
<li><a href="#重构组件名">重构组件名</a></li>
<li><a href="#修复-tabs-组件的-bug">修复 Tabs 组件的 bug</a></li>
<li><a href="#显示或隐藏代码">显示或隐藏代码</a></li>
<li><a href="#修复-watcheffect">修复 <code>watchEffect</code></a></li>
<li><a href="#再次完善官网">再次完善官网</a></li>
</ul></li>
<li><a href="#总结">总结</a></li>
<li><a href="#把项目加到简历-vue-2-如何升级到-vue-3">把项目加到简历，Vue 2 如何升级到 Vue 3</a></li>
<li><a href="#更多">更多</a></li>
</ul></li>
</ul>
</nav>
  </div>
</div>

    
    <div class="post-content">
      

<h1 id="部署项目并且发布源代码至-npm">部署项目并且发布源代码至 npm</h1>

<p>[toc]</p>

<hr />

<h2 id="部署官网到-github">部署官网到 GitHub</h2>

<blockquote>
<p>需要大致完成两件事</p>
</blockquote>

<ul>
<li>部署官网

<ul>
<li>让官网上线，有文档层能直观地被看到，才会有人去使用</li>
</ul></li>
<li>发布 Vueel UI

<ul>
<li>让其他开发者可以使用 <code>npm install vueel3-ui</code>安装源码</li>
</ul></li>
</ul>

<h3 id="发布官网">发布官网</h3>

<blockquote>
<p>就是把 dist 目录上传到网上</p>
</blockquote>

<ul>
<li><code>yarn buil</code>时要注意设置<code>build path</code></li>
</ul>

<h3 id="发布官网的步骤">发布官网的步骤</h3>

<blockquote>
<p>注意要关闭网站的自动翻译功能，会打乱代码</p>
</blockquote>

<ul>
<li>1.如果有 dist 目录，则删除 dist 目录</li>
<li>2.在 <code>.gitignore</code>添加一行 <code>/dist/</code>然后提交代码</li>
<li>3.运行<code>yarn build</code>/<code>vite build</code>创建出最新的<code>dist</code></li>
<li>4.运行<code>hs dist -c-1</code>在本地测试网站是否成功运行</li>

<li><p>5.在部署到GitHub</p>

<ul>
<li>1.运行 <code>cd dist</code> 到 dist 目录下</li>
<li>2.运行<code>git init;git add .;git commit -m 'init';</code></li>
<li>3.注意现在 dist 是一个套娃的git仓库</li>
<li>4.新建远程仓库<code>vueel-website</code>，并关联到 dist 目录</li>
<li>5.注意不是关联到上层仓库的目录</li>
<li>6. 使用<code>git</code>协议的 点击SHH按钮，不要使用https</li>

<li><p>2.开启项目的<code>Pages</code>功能</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-sh" data-lang="sh"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-sh" data-lang="sh"><span class="nb">cd</span> dist
git init
git add .
git commit -m <span class="s2">&#34;first commit&#34;</span>
git branch -M main
git remote add origin git@github.com:xmasuhai/vueel3-demo-website.git
git push -f -u origin main
<span class="nb">cd</span> ..</code></pre></td></tr></table>
</div>
</div></li>
</ul></li>

<li><p>注意强制覆盖 <code>git push -f -u origin main</code></p></li>
</ul>

<blockquote>
<p>部署 GitHub Pages 发现 404</p>
</blockquote>

<ul>
<li>安装<code>yarn global add http-server</code></li>
<li>运行<code>hs dist -c-1</code>在本地测试网站是否成功运行</li>
<li>点击进入<code>http://127.0.0.1:8080</code></li>
<li>出现页面说明目前项目时可以部署的</li>
<li>但按照以上步骤部署发现页面一片空白</li>
<li>打开浏览器，开发者面板的ntework查看请求发现js和css资源都是404，而html请求正确</li>
<li>请求路径错误导致的404</li>
<li>需要重新设置<code>vite.config.ts</code>中的正确的路径<code>build path</code></li>
</ul>

<h3 id="设置-build-path">设置<code>build path</code></h3>

<blockquote>
<p>对比html文件和其他文件的请求路径</p>
</blockquote>

<ul>
<li>html 请求成功

<ul>
<li><code>Request URL: https://xmasuhai.xyz/vueel3-demo-website/index.html</code></li>
</ul></li>
<li>js 请求失败

<ul>
<li><code>Request URL: https://xmasuhai.xyz/assets/index.96031f0b.js</code></li>
</ul></li>
<li>css 请求失败

<ul>
<li><code>Request URL: https://xmasuhai.xyz/assets/index.98fa0c4b.css</code></li>
</ul></li>
<li>发现路径中仓库名不同</li>
</ul>

<blockquote>
<p>GitHub 会删掉以下划线开头的目录，例如<code>_assets/</code></p>
</blockquote>

<ul>
<li>参考查看官方的配置<a href="https://cn.vitejs.dev/config/"><code>vite.config.js</code></a></li>
<li>目前vite版本已经去默认掉<code>assetsDir</code>下划线</li>
</ul>

<blockquote>
<p>仓库名不同</p>
</blockquote>

<ul>
<li>需要在<code>vite.config.ts</code>中设置<code>base: './', ...</code>，以<code>./</code>开头而不是以<code>/</code>开头</li>
<li>重新部署即可正确显示页面</li>
</ul>

<hr />

<h3 id="部署到码云">部署到码云</h3>

<blockquote>
<p>提升访问速度</p>
</blockquote>

<ul>
<li>直接使用 github 账号登录码云</li>
<li>拉取 github 对应仓库</li>
<li>打开服务 -&gt; 部署 Gitee Pages</li>
</ul>

<h3 id="脚本化半自动部署">脚本化半自动部署</h3>

<blockquote>
<p>根目录下创建<code>deploy.sh</code></p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-sh" data-lang="sh"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-sh" data-lang="sh">rm -rf dist <span class="o">&amp;&amp;</span>
vite build <span class="o">&amp;&amp;</span>
<span class="nb">cd</span> dist <span class="o">&amp;&amp;</span>
git init <span class="o">&amp;&amp;</span>
git add . <span class="o">&amp;&amp;</span>
git commit -m <span class="s2">&#34;update&#34;</span> <span class="o">&amp;&amp;</span>
git branch -M main <span class="o">&amp;&amp;</span>
git remote add origin git@github.com:xmasuhai/vueel3-demo-website.git <span class="o">&amp;&amp;</span>
git push -f -u origin main <span class="o">&amp;&amp;</span>
<span class="nb">cd</span> -</code></pre></td></tr></table>
</div>
</div>
<ul>
<li>运行<code>sh deploy.sh</code>即可实现半自动部署</li>
<li>有时github部署会延迟，需要在浏览器network中开启禁用缓存，勾上 <code>Disable cache</code>，刷新网页几次即可</li>
</ul>

<h3 id="使用-github-actions-持续集成">使用<code>GitHub Actions</code>持续集成</h3>

<blockquote>
<p>根目录下创建<code>.github/workflows/deploy-website.yml</code></p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-sh" data-lang="sh"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-sh" data-lang="sh">name: Deploy GitHub Pages

on:
  <span class="c1"># 每当 push 到 main 分支时触发部署</span>
  push:
    branches: <span class="o">[</span>main<span class="o">]</span>

<span class="c1"># 任务</span>
jobs:
  build-and-deploy:
    <span class="c1"># 服务器环境：最新版 Ubuntu</span>
    runs-on: ubuntu-latest

    steps:
      <span class="c1"># 拉取代码</span>
      - name: Checkout
        uses: actions/checkout@v2
        with:
          persist-credentials: <span class="nb">false</span>

      <span class="c1"># 1、生成静态文件</span>
      - name: Build
        run: yarn install <span class="o">&amp;&amp;</span> yarn vite-bd

      <span class="c1"># 2、部署到 GitHub Pages</span>
      <span class="c1"># 预先设置好仓库的 secrets.ACCESS_TOKEN</span>
      - name: Deploy
        uses: JamesIves/github-pages-deploy-action@releases/v3
        with:
          ACCESS_TOKEN: <span class="si">${</span><span class="p">{ secrets.ACCESS_TOKEN </span><span class="si">}</span><span class="o">}</span>
          REPOSITORY_NAME: xmasuhai/vueel3-demo-website
          BRANCH: gh-pages
          FOLDER: dist</code></pre></td></tr></table>
</div>
</div>
<hr />

<h2 id="发布-vueel-ui-至-npm">发布 Vueel UI 至 npm</h2>

<h3 id="打包库文件">打包库文件</h3>

<blockquote>
<p>vite不支持打包，需要自行配置rollup</p>
</blockquote>

<ul>
<li>创建 <code>lin/index.ts</code>，将所有需要导出的东西导出</li>
<li>创建 <code>rollup.config.js</code>，放在根目录下，告诉rollup怎么打包</li>
<li>安装<code>rollup</code>相关依赖

<ul>
<li><code>yarn global add rollup</code></li>
<li><code>yarn add -D rollup-plugin-esbuild rollup-plugin-vue rollup-plugin-scss sass rollup-plugin-terser @vue/compiler-sfc</code></li>
</ul></li>
<li>运行<code>rollup -c</code> 编译库文件</li>
</ul>

<blockquote>
<p><code>lin/index.ts</code></p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="c1">// import Switch from &#39;./Switch&#39;;
</span><span class="c1">// export {Switch};
</span><span class="c1">// 可以合并成依据
</span><span class="c1"></span><span class="kr">export</span> <span class="p">{</span><span class="k">default</span> <span class="nx">as</span> <span class="nx">Switch</span><span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;Switch.vue&#39;</span><span class="p">;</span>
<span class="kr">export</span> <span class="p">{</span><span class="k">default</span> <span class="nx">as</span> <span class="nx">Button</span><span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;Button.vue&#39;</span><span class="p">;</span>
<span class="kr">export</span> <span class="p">{</span><span class="k">default</span> <span class="nx">as</span> <span class="nx">Tabs</span><span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;Tabs.vue&#39;</span><span class="p">;</span>
<span class="kr">export</span> <span class="p">{</span><span class="k">default</span> <span class="nx">as</span> <span class="nx">Tab</span><span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;Tab.vue&#39;</span><span class="p">;</span>
<span class="kr">export</span> <span class="p">{</span><span class="k">default</span> <span class="nx">as</span> <span class="nx">Dialog</span><span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;Dialog.vue&#39;</span><span class="p">;</span>
<span class="kr">export</span> <span class="p">{</span><span class="nx">useDialog</span> <span class="nx">as</span> <span class="nx">useDialog</span><span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;./hooks/useDialog&#39;</span><span class="p">;</span>
<span class="kr">export</span> <span class="p">{</span><span class="nx">useCheckSlots</span> <span class="nx">as</span> <span class="nx">useCheckSlots</span><span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;./hooks/useCheckSlots&#39;</span><span class="p">;</span>
<span class="kr">export</span> <span class="p">{</span><span class="nx">useGetSlots</span> <span class="nx">as</span> <span class="nx">useGetSlots</span><span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;./hooks/useGetSlots&#39;</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div>
<blockquote>
<p><code>rollup.config.js</code></p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="c1">// 请先安装 rollup-plugin-esbuild rollup-plugin-vue rollup-plugin-scss sass rollup-plugin-terser
</span><span class="c1"></span><span class="kr">import</span> <span class="nx">esbuild</span> <span class="nx">from</span> <span class="s1">&#39;rollup-plugin-esbuild&#39;</span>
<span class="kr">import</span> <span class="nx">vue</span> <span class="nx">from</span> <span class="s1">&#39;rollup-plugin-vue&#39;</span>
<span class="kr">import</span> <span class="nx">scss</span> <span class="nx">from</span> <span class="s1">&#39;rollup-plugin-scss&#39;</span>
<span class="kr">import</span> <span class="nx">dartSass</span> <span class="nx">from</span> <span class="s1">&#39;sass&#39;</span>
<span class="kr">import</span> <span class="p">{</span><span class="nx">terser</span><span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;rollup-plugin-terser&#39;</span>
<span class="kr">import</span> <span class="nx">alias</span> <span class="nx">from</span> <span class="s1">&#39;@rollup/plugin-alias&#39;</span>

<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="p">{</span>
  <span class="nx">input</span><span class="o">:</span> <span class="s1">&#39;src/lib/index.ts&#39;</span><span class="p">,</span>
  <span class="nx">output</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">globals</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">vue</span><span class="o">:</span> <span class="s1">&#39;Vue&#39;</span>
    <span class="p">},</span>
    <span class="nx">name</span><span class="o">:</span> <span class="s1">&#39;Vueel3-demo&#39;</span><span class="p">,</span>
    <span class="nx">file</span><span class="o">:</span> <span class="s1">&#39;dist/lib/gulu.js&#39;</span><span class="p">,</span>
    <span class="nx">format</span><span class="o">:</span> <span class="s1">&#39;umd&#39;</span><span class="p">,</span> <span class="c1">// format: &#39;cjs&#39;,
</span><span class="c1"></span>    <span class="nx">plugins</span><span class="o">:</span> <span class="p">[</span><span class="nx">terser</span><span class="p">()],</span>
    <span class="c1">// dir: &#39;output&#39;,
</span><span class="c1"></span>  <span class="p">},</span>
  <span class="nx">plugins</span><span class="o">:</span> <span class="p">[</span>
    <span class="nx">alias</span><span class="p">({</span>
      <span class="nx">entries</span><span class="o">:</span> <span class="p">[</span>
        <span class="p">{</span><span class="nx">find</span><span class="o">:</span> <span class="s1">&#39;@&#39;</span><span class="p">,</span> <span class="nx">replacement</span><span class="o">:</span> <span class="s1">&#39;./src&#39;</span><span class="p">},</span>
        <span class="p">{</span><span class="s1">&#39;vue-types&#39;</span><span class="o">:</span> <span class="s1">&#39;vue-types/shim&#39;</span><span class="p">}</span>
      <span class="p">]</span>
    <span class="p">}),</span>
    <span class="nx">scss</span><span class="p">({</span><span class="nx">include</span><span class="o">:</span> <span class="sr">/\.scss$/</span><span class="p">,</span> <span class="nx">sass</span><span class="o">:</span> <span class="nx">dartSass</span><span class="p">}),</span>
    <span class="nx">esbuild</span><span class="p">({</span>
      <span class="nx">include</span><span class="o">:</span> <span class="sr">/\.[jt]s$/</span><span class="p">,</span>
      <span class="nx">minify</span><span class="o">:</span> <span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">NODE_ENV</span> <span class="o">===</span> <span class="s1">&#39;production&#39;</span><span class="p">,</span>
      <span class="nx">target</span><span class="o">:</span> <span class="s1">&#39;es2015&#39;</span>
    <span class="p">}),</span>
    <span class="nx">vue</span><span class="p">({</span>
      <span class="nx">include</span><span class="o">:</span> <span class="sr">/\.vue$/</span><span class="p">,</span>
    <span class="p">})</span>
  <span class="p">]</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div>
<h3 id="rollup-c-编译库文件"><code>rollup -c</code>  编译库文件</h3>

<blockquote>
<p>运行<code>rollup -c</code>发现报错</p>
</blockquote>

<ul>
<li>逐个删除插件尝试</li>
<li>改变插件顺序</li>
</ul>

<blockquote>
<p><code>rollup.config.js</code></p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="c1">// 请先安装 rollup-plugin-esbuild rollup-plugin-vue rollup-plugin-scss sass rollup-plugin-terser
</span><span class="c1">// rollup-plugin-esbuild
</span><span class="c1">// rollup-plugin-vue
</span><span class="c1">// rollup-plugin-scss
</span><span class="c1">// sass
</span><span class="c1">// rollup-plugin-terser
</span><span class="c1"></span><span class="kr">import</span> <span class="nx">dartSass</span> <span class="nx">from</span> <span class="s1">&#39;sass&#39;</span>
<span class="kr">import</span> <span class="nx">vuePlugin</span> <span class="nx">from</span> <span class="s1">&#39;rollup-plugin-vue&#39;</span>
<span class="kr">import</span> <span class="nx">esbuildPlugin</span> <span class="nx">from</span> <span class="s1">&#39;rollup-plugin-esbuild&#39;</span>
<span class="kr">import</span> <span class="nx">scssPlugin</span> <span class="nx">from</span> <span class="s1">&#39;rollup-plugin-scss&#39;</span>
<span class="kr">import</span> <span class="p">{</span><span class="nx">terser</span><span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;rollup-plugin-terser&#39;</span> <span class="c1">// 压缩 js 代码，包括 ES6 代码压缩
</span><span class="c1"></span>
<span class="kr">export</span> <span class="k">default</span> <span class="p">{</span>
  <span class="nx">input</span><span class="o">:</span> <span class="s1">&#39;src/lib/index.ts&#39;</span><span class="p">,</span>
  <span class="nx">output</span><span class="o">:</span> <span class="p">{</span>
    <span class="c1">// exports: &#39;vueel3&#39;,
</span><span class="c1"></span>    <span class="nx">globals</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">vue</span><span class="o">:</span> <span class="s1">&#39;vue&#39;</span> <span class="c1">// 告诉rollup全局变量Vue即是vue
</span><span class="c1"></span>    <span class="p">},</span>
    <span class="nx">name</span><span class="o">:</span> <span class="s1">&#39;vueel3-ui&#39;</span><span class="p">,</span>
    <span class="nx">file</span><span class="o">:</span> <span class="s1">&#39;dist/lib/vueel3.js&#39;</span><span class="p">,</span>
    <span class="nx">format</span><span class="o">:</span> <span class="s1">&#39;umd&#39;</span><span class="p">,</span> <span class="c1">// format: &#39;cjs&#39;,
</span><span class="c1"></span>    <span class="nx">plugins</span><span class="o">:</span> <span class="p">[</span><span class="nx">terser</span><span class="p">()],</span>
  <span class="p">},</span>
  <span class="nx">external</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;vue&#39;</span><span class="p">],</span>
  <span class="nx">plugins</span><span class="o">:</span> <span class="p">[</span>
    <span class="c1">// .vue -&gt; .js
</span><span class="c1"></span>    <span class="nx">vuePlugin</span><span class="p">({</span>
      <span class="nx">include</span><span class="o">:</span> <span class="sr">/\.vue$/</span><span class="p">,</span>
      <span class="c1">// 把单文件组件中的样式，插入到html中的style标签
</span><span class="c1"></span>      <span class="nx">css</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
      <span class="c1">// 把组件转换成 render 函数
</span><span class="c1"></span>      <span class="nx">compileTemplate</span><span class="o">:</span> <span class="kc">true</span>
    <span class="p">}),</span>
    <span class="c1">// .ts -&gt; .js
</span><span class="c1"></span>    <span class="nx">esbuildPlugin</span><span class="p">({</span>
      <span class="nx">include</span><span class="o">:</span> <span class="sr">/\.[jt]s$/</span><span class="p">,</span>
      <span class="nx">minify</span><span class="o">:</span> <span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">NODE_ENV</span> <span class="o">===</span> <span class="s1">&#39;production&#39;</span><span class="p">,</span>
      <span class="nx">target</span><span class="o">:</span> <span class="s1">&#39;es2015&#39;</span>
    <span class="p">}),</span>
    <span class="c1">// .scss -&gt; css
</span><span class="c1"></span>    <span class="nx">scssPlugin</span><span class="p">({</span><span class="nx">include</span><span class="o">:</span> <span class="sr">/\.scss$/</span><span class="p">,</span> <span class="nx">sass</span><span class="o">:</span> <span class="nx">dartSass</span><span class="p">})</span>
  <span class="p">]</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div>
<blockquote>
<p>忽略警告</p>
</blockquote>

<ul>
<li><code>(!) Unresolved dependencies...</code></li>
<li><code>(!) Missing global variable names...</code></li>
</ul>

<blockquote>
<p>编译<code>src/lib/index.ts → dist/lib/vueel3.js...</code></p>
</blockquote>

<ul>
<li>生成<code>dist/lib/vueel3.css</code>和<code>dist/lib/vueel3.js</code></li>
</ul>

<h3 id="解释-rollup-config-js">解释 rollup.config.js</h3>

<blockquote>
<p>新增几个插件</p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="c1">// 请先安装 
</span><span class="c1">// rollup-plugin-esbuild
</span><span class="c1">// rollup-plugin-vue
</span><span class="c1">// sass
</span><span class="c1">// rollup-plugin-scss
</span><span class="c1">// rollup-plugin-terser
</span><span class="c1">// @rollup/plugin-alias
</span><span class="c1">// rollup-plugin-filesize
</span><span class="c1"></span><span class="kr">import</span> <span class="nx">path</span> <span class="nx">from</span> <span class="s1">&#39;path&#39;</span>
<span class="kr">import</span> <span class="nx">dartSass</span> <span class="nx">from</span> <span class="s1">&#39;sass&#39;</span> <span class="c1">// 支持 &#39;rollup-plugin-scss&#39;
</span><span class="c1"></span><span class="kr">import</span> <span class="nx">vuePlugin</span> <span class="nx">from</span> <span class="s1">&#39;rollup-plugin-vue&#39;</span> <span class="c1">// 编译vue为js
</span><span class="c1"></span><span class="kr">import</span> <span class="nx">esbuildPlugin</span> <span class="nx">from</span> <span class="s1">&#39;rollup-plugin-esbuild&#39;</span> <span class="c1">// 编译ts为js
</span><span class="c1"></span><span class="kr">import</span> <span class="nx">scssPlugin</span> <span class="nx">from</span> <span class="s1">&#39;rollup-plugin-scss&#39;</span> <span class="c1">// 编译scss为js
</span><span class="c1"></span><span class="kr">import</span> <span class="nx">bundleSize</span> <span class="nx">from</span> <span class="s1">&#39;rollup-plugin-filesize&#39;</span> <span class="c1">// 显示打包完成的体积
</span><span class="c1"></span><span class="kr">import</span> <span class="nx">alias</span> <span class="nx">from</span> <span class="s1">&#39;@rollup/plugin-alias&#39;</span> <span class="c1">// 替换别名
</span><span class="c1"></span><span class="kr">import</span> <span class="p">{</span><span class="nx">terser</span><span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;rollup-plugin-terser&#39;</span> <span class="c1">// 压缩 js 代码，包括 ES6 代码压缩 作用和uglify相同 import { uglify } from &#39;rollup-plugin-uglify&#39;;
</span><span class="c1"></span><span class="kr">import</span> <span class="nx">pkg</span> <span class="nx">from</span> <span class="s1">&#39;./package.json&#39;</span>

<span class="kr">const</span> <span class="nx">pathResolve</span> <span class="o">=</span> <span class="nx">p</span> <span class="p">=&gt;</span> <span class="nx">path</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="nx">__dirname</span><span class="p">,</span> <span class="nx">p</span><span class="p">)</span>

<span class="kr">export</span> <span class="k">default</span> <span class="p">{</span>
  <span class="nx">input</span><span class="o">:</span> <span class="s1">&#39;src/lib/index.ts&#39;</span><span class="p">,</span>
  <span class="nx">output</span><span class="o">:</span> <span class="p">{</span>
    <span class="c1">// exports: &#39;vueel3&#39;,
</span><span class="c1"></span>    <span class="nx">globals</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">vue</span><span class="o">:</span> <span class="s1">&#39;Vue&#39;</span> <span class="c1">// 告诉rollup全局变量Vue即是vue 不用打包
</span><span class="c1"></span>    <span class="p">},</span>
    <span class="nx">name</span><span class="o">:</span> <span class="s1">&#39;vueel3-ui&#39;</span><span class="p">,</span> <span class="c1">// 影响输出时的全局变量名
</span><span class="c1"></span>    <span class="nx">file</span><span class="o">:</span> <span class="s1">&#39;dist/lib/vueel3.js&#39;</span><span class="p">,</span> <span class="c1">// 自动创建css，不用重复添加
</span><span class="c1"></span>    <span class="nx">format</span><span class="o">:</span> <span class="s1">&#39;umd&#39;</span><span class="p">,</span> <span class="c1">// 相较于format: &#39;cjs&#39;, `umd`既适用于浏览器，用适用于node环境
</span><span class="c1"></span>    <span class="nx">plugins</span><span class="o">:</span> <span class="p">[</span><span class="nx">terser</span><span class="p">()],</span> <span class="c1">// 丑化代码
</span><span class="c1"></span>  <span class="p">},</span>
  <span class="nx">external</span><span class="o">:</span> <span class="p">[</span><span class="nb">Object</span><span class="p">.</span><span class="nx">keys</span><span class="p">(</span><span class="nx">pkg</span><span class="p">.</span><span class="nx">dependencies</span><span class="p">)],</span>
  <span class="nx">plugins</span><span class="o">:</span> <span class="p">[</span>
    <span class="c1">// .vue -&gt; .js
</span><span class="c1"></span>    <span class="nx">vuePlugin</span><span class="p">({</span>
      <span class="nx">include</span><span class="o">:</span> <span class="sr">/\.vue$/</span><span class="p">,</span>
      <span class="c1">// 把单文件组件中的样式，插入到html中的style标签
</span><span class="c1"></span>      <span class="nx">css</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
      <span class="c1">// 把组件转换成 render 函数
</span><span class="c1"></span>      <span class="nx">compileTemplate</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
      <span class="nx">template</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">isProduction</span><span class="o">:</span> <span class="o">!</span><span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">ROLLUP_WATCH</span><span class="p">,</span>
        <span class="nx">compilerOptions</span><span class="o">:</span> <span class="p">{</span><span class="nx">preserveWhitespace</span><span class="o">:</span> <span class="kc">false</span><span class="p">}</span>
      <span class="p">}</span>
    <span class="p">}),</span>
    <span class="c1">// .ts -&gt; .js
</span><span class="c1"></span>    <span class="nx">esbuildPlugin</span><span class="p">({</span>
      <span class="nx">include</span><span class="o">:</span> <span class="sr">/\.[jt]s$/</span><span class="p">,</span>
      <span class="nx">minify</span><span class="o">:</span> <span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">NODE_ENV</span> <span class="o">===</span> <span class="s1">&#39;production&#39;</span><span class="p">,</span>
      <span class="nx">target</span><span class="o">:</span> <span class="s1">&#39;es2015&#39;</span> <span class="c1">// 支持ES6
</span><span class="c1"></span>    <span class="p">}),</span>
    <span class="c1">// .scss -&gt; css
</span><span class="c1"></span>    <span class="nx">scssPlugin</span><span class="p">({</span><span class="nx">include</span><span class="o">:</span> <span class="sr">/\.scss$/</span><span class="p">,</span> <span class="nx">sass</span><span class="o">:</span> <span class="nx">dartSass</span><span class="p">}),</span>
    <span class="nx">alias</span><span class="p">({</span>
      <span class="s1">&#39;@&#39;</span><span class="o">:</span> <span class="nx">pathResolve</span><span class="p">(</span><span class="s1">&#39;src&#39;</span><span class="p">)</span>
    <span class="p">}),</span>
    <span class="nx">bundleSize</span><span class="p">(),</span>
  <span class="p">]</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div>
<h3 id="发布-dist-lib-目录-上传到npm服务器">发布 <code>dist/lib</code> 目录，上传到npm服务器</h3>

<h4 id="在-package-json-中添加-files-和-main">在<code>package.json</code>中添加<code>files</code>和<code>main</code></h4>

<blockquote>
<p><code>package.json</code></p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-json" data-lang="json"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-json" data-lang="json"><span class="p">{</span>
  <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;vue3-demo-ui-1&#34;</span><span class="p">,</span>
  <span class="nt">&#34;version&#34;</span><span class="p">:</span> <span class="s2">&#34;0.0.0&#34;</span><span class="p">,</span>
  <span class="nt">&#34;author&#34;</span><span class="p">:</span> <span class="s2">&#34;Xu Shuai&#34;</span><span class="p">,</span>
  <span class="nt">&#34;license&#34;</span><span class="p">:</span> <span class="s2">&#34;MIT&#34;</span><span class="p">,</span>
  <span class="nt">&#34;files&#34;</span><span class="p">:</span> <span class="p">[</span>
    <span class="s2">&#34;dist/lib/*&#34;</span>
  <span class="p">],</span>
  <span class="nt">&#34;main&#34;</span><span class="p">:</span> <span class="s2">&#34;dist/lib/vueel3.js&#34;</span><span class="p">,</span>
  <span class="nt">&#34;scripts&#34;</span><span class="p">:</span> <span class="p">{</span>
    <span class="nt">&#34;rpc&#34;</span><span class="p">:</span> <span class="s2">&#34;rollup -c&#34;</span><span class="p">,</span>
    <span class="nt">&#34;dev&#34;</span><span class="p">:</span> <span class="s2">&#34;vite&#34;</span><span class="p">,</span>
    <span class="nt">&#34;vite-bd&#34;</span><span class="p">:</span> <span class="s2">&#34;vite build&#34;</span><span class="p">,</span>
    <span class="nt">&#34;build&#34;</span><span class="p">:</span> <span class="s2">&#34;vue-tsc --noEmit &amp;&amp; vite build&#34;</span>
  <span class="p">},</span>
  <span class="nt">&#34;resolutions&#34;</span><span class="p">:</span> <span class="p">{</span>
    <span class="nt">&#34;node-sass&#34;</span><span class="p">:</span> <span class="s2">&#34;npm:sass@^1.39.2&#34;</span>
  <span class="p">},</span>
  <span class="nt">&#34;dependencies&#34;</span><span class="p">:</span> <span class="p">{</span>
    <span class="nt">&#34;github-markdown-css&#34;</span><span class="p">:</span> <span class="s2">&#34;^5.0.0&#34;</span><span class="p">,</span>
    <span class="nt">&#34;mitt&#34;</span><span class="p">:</span> <span class="s2">&#34;^3.0.0&#34;</span><span class="p">,</span>
    <span class="nt">&#34;prismjs&#34;</span><span class="p">:</span> <span class="s2">&#34;^1.25.0&#34;</span><span class="p">,</span>
    <span class="nt">&#34;vite&#34;</span><span class="p">:</span> <span class="s2">&#34;^2.5.7&#34;</span><span class="p">,</span>
    <span class="nt">&#34;vue-router&#34;</span><span class="p">:</span> <span class="s2">&#34;4.0.11&#34;</span>
  <span class="p">},</span>
  <span class="nt">&#34;devDependencies&#34;</span><span class="p">:</span> <span class="p">{</span>
    <span class="nt">&#34;@rollup/plugin-alias&#34;</span><span class="p">:</span> <span class="s2">&#34;^3.1.8&#34;</span><span class="p">,</span>
    <span class="nt">&#34;@types/marked&#34;</span><span class="p">:</span> <span class="s2">&#34;^3.0.2&#34;</span><span class="p">,</span>
    <span class="nt">&#34;@types/node&#34;</span><span class="p">:</span> <span class="s2">&#34;^16.9.1&#34;</span><span class="p">,</span>
    <span class="nt">&#34;@types/prismjs&#34;</span><span class="p">:</span> <span class="s2">&#34;^1.16.6&#34;</span><span class="p">,</span>
    <span class="nt">&#34;@vitejs/plugin-vue&#34;</span><span class="p">:</span> <span class="s2">&#34;^1.6.1&#34;</span><span class="p">,</span>
    <span class="nt">&#34;@vue/compiler-sfc&#34;</span><span class="p">:</span> <span class="s2">&#34;^3.2.21&#34;</span><span class="p">,</span>
    <span class="nt">&#34;marked&#34;</span><span class="p">:</span> <span class="s2">&#34;^3.0.7&#34;</span><span class="p">,</span>
    <span class="nt">&#34;postcss&#34;</span><span class="p">:</span> <span class="s2">&#34;^8.3.11&#34;</span><span class="p">,</span>
    <span class="nt">&#34;rollup-plugin-esbuild&#34;</span><span class="p">:</span> <span class="s2">&#34;^4.6.0&#34;</span><span class="p">,</span>
    <span class="nt">&#34;rollup-plugin-filesize&#34;</span><span class="p">:</span> <span class="s2">&#34;^9.1.1&#34;</span><span class="p">,</span>
    <span class="nt">&#34;rollup-plugin-scss&#34;</span><span class="p">:</span> <span class="s2">&#34;^3.0.0&#34;</span><span class="p">,</span>
    <span class="nt">&#34;rollup-plugin-terser&#34;</span><span class="p">:</span> <span class="s2">&#34;^7.0.2&#34;</span><span class="p">,</span>
    <span class="nt">&#34;rollup-plugin-vue&#34;</span><span class="p">:</span> <span class="s2">&#34;^6.0.0&#34;</span><span class="p">,</span>
    <span class="nt">&#34;sass&#34;</span><span class="p">:</span> <span class="s2">&#34;1.39.2&#34;</span><span class="p">,</span>
    <span class="nt">&#34;sass-loader&#34;</span><span class="p">:</span> <span class="s2">&#34;8.0.2&#34;</span><span class="p">,</span>
    <span class="nt">&#34;typescript&#34;</span><span class="p">:</span> <span class="s2">&#34;^4.4.3&#34;</span><span class="p">,</span>
    <span class="nt">&#34;vite&#34;</span><span class="p">:</span> <span class="s2">&#34;^2.5.7&#34;</span><span class="p">,</span>
    <span class="nt">&#34;vite-plugin-components&#34;</span><span class="p">:</span> <span class="s2">&#34;^0.13.3&#34;</span><span class="p">,</span>
    <span class="nt">&#34;vite-plugin-md&#34;</span><span class="p">:</span> <span class="s2">&#34;^0.11.2&#34;</span><span class="p">,</span>
    <span class="nt">&#34;vue&#34;</span><span class="p">:</span> <span class="s2">&#34;^3.2.20&#34;</span><span class="p">,</span>
    <span class="nt">&#34;vue-loader&#34;</span><span class="p">:</span> <span class="s2">&#34;^16.8.2&#34;</span><span class="p">,</span>
    <span class="nt">&#34;vue-tsc&#34;</span><span class="p">:</span> <span class="s2">&#34;^0.2.2&#34;</span><span class="p">,</span>
    <span class="nt">&#34;vue-types&#34;</span><span class="p">:</span> <span class="s2">&#34;^4.1.1&#34;</span>
  <span class="p">},</span>
  <span class="nt">&#34;peerDependencies&#34;</span><span class="p">:</span> <span class="p">{</span>
    <span class="nt">&#34;vue&#34;</span><span class="p">:</span> <span class="s2">&#34;^3.2.6&#34;</span>
  <span class="p">}</span>
<span class="p">}</span></code></pre></td></tr></table>
</div>
</div>
<ul>
<li><code>&quot;files&quot;: [ &quot;dist/lib/*&quot; ]</code> 写上所有需要上传的文件</li>
<li><code>&quot;main&quot;: &quot;dist/lib/vueel3.js&quot;,</code> 说明主文件</li>
</ul>

<h4 id="npm-login"><code>npm login</code></h4>

<blockquote>
<p>确保已切换至npm官方源，而没有使用淘宝源</p>
</blockquote>

<ul>
<li>查看npm源<code>npm config get registry</code></li>
<li>切换至npm官方源<code>npm config set registry https://registry.npmjs.org</code></li>
<li>切换回npm淘宝源<code>npm config set registry https://registry.npm.taobao.org/</code></li>
</ul>

<blockquote>
<p>注册npm，之后在命令行中使用<code>npm login</code>登录</p>
</blockquote>

<ul>
<li><code>npm login</code></li>
<li>按提示输入<code>Username</code>、<code>Email</code>和<code>Password</code></li>
<li>注意只有使用了官方源，才能正确登录</li>
</ul>

<h4 id="npm-publish"><code>npm publish</code></h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-sh" data-lang="sh"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-sh" data-lang="sh">卐 npm publish
npm notice
npm notice package: vue3-demo-ui-1@0.0.0
npm <span class="nv">notice</span> <span class="o">===</span> Tarball <span class="nv">Contents</span> <span class="o">===</span>
npm notice <span class="m">1</span>.1kB LICENSE
npm notice <span class="m">2</span>.4kB README.md
npm notice <span class="m">2</span>.2kB dist/lib/vueel3.css
npm notice <span class="m">1</span>.6kB dist/lib/vueel3.js
npm notice <span class="m">1</span>.3kB package.json
npm <span class="nv">notice</span> <span class="o">===</span> Tarball <span class="nv">Details</span> <span class="o">===</span>
npm notice name:          vue3-demo-ui-1
npm notice version:       <span class="m">0</span>.0.0
npm notice filename:      vue3-demo-ui-1-0.0.0.tgz
npm notice package size:  <span class="m">4</span>.4 kB
npm notice unpacked size: <span class="m">8</span>.6 kB
npm notice shasum:        bfdc2825cf74db0e25f89c8f0fc2d925c5279d3b
npm notice integrity:     sha512-KIJx0x4g0Eu9t<span class="o">[</span>...<span class="o">]</span><span class="nv">Htcv7IaAHffdw</span><span class="o">==</span>
npm notice total files:   <span class="m">5</span>
npm notice
+ vue3-demo-ui-1@0.0.0</code></pre></td></tr></table>
</div>
</div>
<ul>
<li>完成发布后，就可以通过 <code>yarn add vue3-demo-ui-1</code>来使用了</li>
</ul>

<h4 id="一些细节">一些细节</h4>

<ul>
<li><code>name</code>

<ul>
<li><code>package</code>的<code>name</code>必须是小写字母，可用<code>-</code>或<code>_</code>连接</li>
<li><code>package</code>的<code>name</code>不能和npm上现有的name重名</li>
</ul></li>
<li><code>version</code>

<ul>
<li>每次 publish 的版本不能和之前任何一次的相同</li>
<li>之后的更改中，必须先改 <code>version</code> 再 <code>npm publish</code></li>
</ul></li>
<li>注册 <code>npmjs.com</code> 账号

<ul>
<li>使用网页注册，然后再命令行使用<code>npm login</code>登录</li>
<li>登陆之后才能<code>npm publish</code></li>
<li>使用 <code>npm logout</code>可以退出登录</li>
</ul></li>
</ul>

<h4 id="小技巧">小技巧</h4>

<blockquote>
<p>使用 nrm 快速切换源</p>
</blockquote>

<ul>
<li>安装<code>npm i -g nrm --registry https://registry/npm.taobao.org</code></li>
<li><code>nrm ls</code>可以查看所有源</li>
<li><code>nrm use taobao</code>可以切换到淘宝源</li>
<li><code>nrm use npm</code>可以切换回npm官方源</li>
</ul>

<hr />

<blockquote>
<p>修复本地运行不出现而部署dist后出现的 bug，完善功能</p>
</blockquote>

<h2 id="模拟别人使用自己的组件">模拟别人使用自己的组件</h2>

<blockquote>
<p>测试自己的 package</p>
</blockquote>

<ul>
<li>在空白目录中使用<code>@vue/cli</code>新建一个<code>vue3</code>项目</li>

<li><p>安装自己的包<code>yarn add vue3-demo-ui-1</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-sh" data-lang="sh"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-sh" data-lang="sh">info Direct dependencies
└─ vue3-demo-ui-1@0.0.12
info All dependencies
├─ @vue/devtools-api@6.0.0-beta.20
├─ github-markdown-css@5.0.0
├─ mitt@3.0.0
├─ prismjs@1.25.0
├─ vue-router@4.0.11
└─ vue3-demo-ui-1@0.0.12</code></pre></td></tr></table>
</div>
</div></li>
</ul>

<hr />

<h3 id="重构组件名">重构组件名</h3>

<ul>
<li>统一改为以<code>Vl</code>开头的驼峰模式</li>
</ul>

<h3 id="修复-tabs-组件的-bug">修复 Tabs 组件的 bug</h3>

<blockquote>
<p>使用<code>hs dist -c-1</code>运行打包后的项目时，tab组件报错<code>VlTabs 子标签必须是 VlTabItem</code></p>
</blockquote>

<ul>
<li><p>分别打出本地服务运行和打包后运行信息</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="p">...</span>
<span class="kr">const</span> <span class="p">{</span><span class="nx">defaults</span><span class="p">}</span> <span class="o">=</span> <span class="nx">useGetSlots</span><span class="p">();</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&#34;-&gt; defaults&#34;</span><span class="p">,</span> <span class="nx">defaults</span><span class="p">);</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&#34;-&gt; TabItem&#34;</span><span class="p">,</span> <span class="nx">TabItem</span><span class="p">);</span>
<span class="kr">const</span> <span class="nx">checkTabItem</span> <span class="o">=</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
<span class="nx">defaults</span><span class="p">.</span><span class="nx">forEach</span><span class="p">((</span><span class="nx">tab</span><span class="o">:</span> <span class="nx">VNode</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&#34;-&gt; tab.type&#34;</span><span class="p">,</span> <span class="nx">tab</span><span class="p">.</span><span class="nx">type</span><span class="p">);</span>
<span class="k">if</span> <span class="p">(</span><span class="nx">tab</span><span class="p">.</span><span class="nx">type</span> <span class="o">!==</span> <span class="nx">TabItem</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s1">&#39;VlTabs 子标签必须是 VlTabItem&#39;</span><span class="p">));</span>
<span class="p">}</span>
<span class="p">});</span>
<span class="p">};</span>
<span class="p">...</span>
</code></pre></td></tr></table>
</div>
</div></li>

<li><p>在生产环境下，原始组件和<code>tab.type</code>是不严格相等的</p></li>

<li><p>改为判断组件的<code>name</code>属性，需设置属性</p></li>
</ul>

<blockquote>
<p><code>VlTabItem.vue</code></p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-html" data-lang="html"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-html" data-lang="html"><span class="p">&lt;</span><span class="nt">template</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">div</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">slot</span><span class="p">&gt;</span>
      Tab内容
    <span class="p">&lt;/</span><span class="nt">slot</span><span class="p">&gt;</span>
  <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">template</span><span class="p">&gt;</span>

<span class="p">&lt;</span><span class="nt">script</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;ts&#34;</span><span class="p">&gt;</span>
<span class="kr">export</span> <span class="k">default</span> <span class="p">{</span>
  <span class="nx">name</span><span class="o">:</span> <span class="s1">&#39;VlTabItem&#39;</span>
<span class="p">};</span>
<span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span></code></pre></td></tr></table>
</div>
</div>
<blockquote>
<p>抽出判断组件名的逻辑<code>useCheckSlots.ts</code></p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="kr">import</span> <span class="p">{</span><span class="nx">Component</span><span class="p">,</span> <span class="nx">VNode</span><span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;vue&#39;</span><span class="p">;</span>

<span class="kr">export</span> <span class="kr">const</span> <span class="nx">useCheckSlots</span> <span class="o">=</span> <span class="p">(</span><span class="nx">defaults</span><span class="o">:</span> <span class="nx">VNode</span><span class="p">[],</span> <span class="nx">component</span><span class="o">:</span> <span class="nx">Component</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
  <span class="nx">defaults</span><span class="p">.</span><span class="nx">forEach</span><span class="p">((</span><span class="nx">tab</span><span class="o">:</span> <span class="nx">VNode</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">tab</span><span class="p">.</span><span class="nx">type</span> <span class="o">!==</span> <span class="nx">component</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="sb">`VlTabs 子标签必须是 </span><span class="si">${</span><span class="nx">component</span><span class="p">.</span><span class="nx">name</span><span class="si">}</span><span class="sb">`</span><span class="p">));</span>
    <span class="p">}</span>
  <span class="p">});</span>
<span class="p">};</span>
</code></pre></td></tr></table>
</div>
</div>
<blockquote>
<p><code>VlTabs.vue</code></p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-html" data-lang="html"><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span><span class="lnt">138
</span><span class="lnt">139
</span><span class="lnt">140
</span><span class="lnt">141
</span><span class="lnt">142
</span><span class="lnt">143
</span><span class="lnt">144
</span><span class="lnt">145
</span><span class="lnt">146
</span><span class="lnt">147
</span><span class="lnt">148
</span><span class="lnt">149
</span><span class="lnt">150
</span><span class="lnt">151
</span><span class="lnt">152
</span><span class="lnt">153
</span><span class="lnt">154
</span><span class="lnt">155
</span><span class="lnt">156
</span><span class="lnt">157
</span><span class="lnt">158
</span><span class="lnt">159
</span><span class="lnt">160
</span><span class="lnt">161
</span><span class="lnt">162
</span><span class="lnt">163
</span><span class="lnt">164
</span><span class="lnt">165
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-html" data-lang="html"><span class="p">&lt;</span><span class="nt">script</span> <span class="na">setup</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;ts&#34;</span><span class="p">&gt;</span>
<span class="kr">import</span> <span class="nx">VlTabItem</span> <span class="nx">from</span> <span class="s1">&#39;./VlTabItem.vue&#39;</span><span class="p">;</span>
<span class="kr">import</span> <span class="p">{</span><span class="nx">useGetSlots</span><span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;./hooks/useGetSlots&#39;</span><span class="p">;</span>
<span class="kr">import</span> <span class="p">{</span><span class="nx">useCheckSlots</span><span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;./hooks/useCheckSlots&#39;</span><span class="p">;</span>
<span class="kr">import</span> <span class="p">{</span><span class="nx">onBeforeUpdate</span><span class="p">,</span> <span class="nx">computed</span><span class="p">,</span> <span class="nx">onMounted</span><span class="p">,</span> <span class="nx">ref</span><span class="p">,</span> <span class="nx">VNode</span><span class="p">,</span> <span class="nx">watchEffect</span><span class="p">,</span> <span class="nx">Ref</span><span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;vue&#39;</span><span class="p">;</span>

<span class="c1">// 获取slotsDefaults
</span><span class="c1"></span><span class="kr">const</span> <span class="p">{</span><span class="nx">defaults</span><span class="p">}</span> <span class="o">=</span> <span class="nx">useGetSlots</span><span class="p">();</span>

<span class="c1">// 检查子标签名方法hooks: useCheckSlots
</span><span class="c1"></span><span class="cm">/*
</span><span class="cm">const checkTabItem = () =&gt; {
</span><span class="cm">  defaults.forEach((tag: VNode) =&gt; {
</span><span class="cm">    if (tag.type !== TabItem) {
</span><span class="cm">      console.error(new Error(&#39;Tabs 子标签必须是 TabItem&#39;));
</span><span class="cm">    }
</span><span class="cm">  });
</span><span class="cm">};
</span><span class="cm">*/</span>
<span class="kr">const</span> <span class="nx">checkTabItem</span> <span class="o">=</span> <span class="nx">useCheckSlots</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span> <span class="nx">defaults</span><span class="p">,</span> <span class="nx">VlTabItem</span><span class="p">);</span>

<span class="c1">// 获取子组件VNode中对应title属性组成的数组 titles: string[]
</span><span class="c1"></span><span class="kr">const</span> <span class="nx">titles</span> <span class="o">=</span> <span class="nx">defaults</span><span class="o">?</span><span class="p">.</span><span class="nx">map</span><span class="p">((</span><span class="nx">tag</span><span class="o">:</span> <span class="nx">VNode</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nx">tag</span><span class="o">?</span><span class="p">.</span><span class="nx">props</span><span class="o">?</span><span class="p">.</span><span class="nx">title</span><span class="p">;</span>
<span class="p">});</span>

<span class="c1">// 声明外部数据 获取 props.selected 属性
</span><span class="c1"></span><span class="kr">const</span> <span class="nx">props</span> <span class="o">=</span> <span class="nx">defineProps</span><span class="p">({</span>
  <span class="nx">selected</span><span class="o">:</span> <span class="nb">String</span>
<span class="p">});</span>

<span class="c1">// 对比所有项目的title和当前选中项的title 获取当前选中项currentTab
</span><span class="c1">// filter 性能不如 find，改用find
</span><span class="c1"></span><span class="cm">/*
</span><span class="cm">const getCurrentTab = computed(() =&gt; {
</span><span class="cm">  return defaults?.filter((tag: VNode) =&gt; {
</span><span class="cm">    return tag?.props?.title === props.selected;
</span><span class="cm">  })[0];
</span><span class="cm">});
</span><span class="cm">*/</span>
<span class="kr">const</span> <span class="nx">getCurrentTab</span> <span class="o">=</span> <span class="nx">computed</span><span class="p">(()</span> <span class="p">=&gt;</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nx">defaults</span><span class="p">.</span><span class="nx">find</span><span class="p">((</span><span class="nx">tag</span><span class="o">:</span> <span class="nx">VNode</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">tag</span><span class="o">?</span><span class="p">.</span><span class="nx">props</span><span class="o">?</span><span class="p">.</span><span class="nx">title</span> <span class="o">===</span> <span class="nx">props</span><span class="p">.</span><span class="nx">selected</span><span class="p">;</span>
  <span class="p">});</span>
<span class="p">});</span>

<span class="kr">const</span> <span class="nx">getCurrentTitle</span> <span class="o">=</span> <span class="nx">computed</span><span class="p">(()</span> <span class="p">=&gt;</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nx">defaults</span><span class="p">.</span><span class="nx">find</span><span class="p">((</span><span class="nx">tag</span><span class="o">:</span> <span class="nx">VNode</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">tag</span><span class="o">?</span><span class="p">.</span><span class="nx">props</span><span class="o">?</span><span class="p">.</span><span class="nx">title</span> <span class="o">===</span> <span class="nx">props</span><span class="p">.</span><span class="nx">selected</span><span class="p">;</span>
  <span class="p">})</span><span class="o">!</span><span class="p">.</span><span class="nx">props</span><span class="o">!</span><span class="p">.</span><span class="nx">title</span><span class="p">;</span>
<span class="p">});</span>

<span class="c1">// 声明 发布方法名
</span><span class="c1"></span><span class="kr">const</span> <span class="nx">emits</span> <span class="o">=</span> <span class="nx">defineEmits</span><span class="p">([</span><span class="s1">&#39;update:selected&#39;</span><span class="p">]);</span>

<span class="c1">// 点击选中项目时执行的方法 通知父组件当前的选中项
</span><span class="c1"></span><span class="kr">const</span> <span class="nx">select</span> <span class="o">=</span> <span class="p">(</span><span class="nx">title</span><span class="o">:</span> <span class="nx">string</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
  <span class="nx">emits</span><span class="p">(</span><span class="s1">&#39;update:selected&#39;</span><span class="p">,</span> <span class="nx">title</span><span class="p">);</span>
<span class="p">};</span>

<span class="c1">// 获取导航标签项目引用
</span><span class="c1"></span><span class="kr">const</span> <span class="nx">div</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">&#39;div&#39;</span><span class="p">);</span>
<span class="kd">let</span> <span class="nx">selectedItem</span><span class="o">:</span> <span class="nx">Ref</span> <span class="o">=</span> <span class="nx">ref</span><span class="o">&lt;</span><span class="nx">HTMLDivElement</span><span class="o">&gt;</span><span class="p">(</span><span class="nx">div</span><span class="p">);</span>
<span class="c1">// 获取导航标签指示横线引用
</span><span class="c1"></span><span class="kr">const</span> <span class="nx">indicator</span> <span class="o">=</span> <span class="nx">ref</span><span class="o">&lt;</span><span class="nx">HTMLDivElement</span><span class="o">&gt;</span><span class="p">(</span><span class="nx">div</span><span class="p">);</span>
<span class="c1">// 获取导航外部div引用
</span><span class="c1"></span><span class="kr">const</span> <span class="nx">container</span> <span class="o">=</span> <span class="nx">ref</span><span class="o">&lt;</span><span class="nx">HTMLDivElement</span><span class="o">&gt;</span><span class="p">(</span><span class="nx">div</span><span class="p">);</span>

<span class="c1">// 确保在每次更新之前重置ref
</span><span class="c1"></span><span class="nx">onBeforeUpdate</span><span class="p">(()</span> <span class="p">=&gt;</span> <span class="p">{</span>
  <span class="nx">selectedItem</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="nx">div</span><span class="p">;</span>
<span class="p">});</span>

<span class="nx">onMounted</span><span class="p">(()</span> <span class="p">=&gt;</span> <span class="p">{</span>
  <span class="nx">checkTabItem</span><span class="p">();</span>
<span class="p">});</span>

<span class="c1">// Tab指示下划线跟踪TabItem位置
</span><span class="c1"></span><span class="kr">const</span> <span class="nx">indicatorTraceTab</span> <span class="o">=</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
  <span class="kr">const</span> <span class="p">{</span><span class="nx">width</span><span class="p">,</span> <span class="nx">left</span><span class="p">}</span> <span class="o">=</span> <span class="nx">selectedItem</span><span class="p">.</span><span class="nx">value</span><span class="o">!</span><span class="p">.</span><span class="nx">getBoundingClientRect</span><span class="p">();</span>
  <span class="kr">const</span> <span class="p">{</span><span class="nx">left</span><span class="o">:</span> <span class="nx">containerLeft</span><span class="p">}</span> <span class="o">=</span> <span class="nx">container</span><span class="p">.</span><span class="nx">value</span><span class="o">!</span><span class="p">.</span><span class="nx">getBoundingClientRect</span><span class="p">();</span>
  <span class="kr">const</span> <span class="nx">leftPos</span> <span class="o">=</span> <span class="nx">left</span> <span class="o">-</span> <span class="nx">containerLeft</span><span class="p">;</span>
  <span class="nx">indicator</span><span class="p">.</span><span class="nx">value</span><span class="o">!</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">width</span> <span class="o">=</span> <span class="sb">`</span><span class="si">${</span><span class="nx">width</span><span class="si">}</span><span class="sb">px`</span><span class="p">;</span>
  <span class="nx">indicator</span><span class="p">.</span><span class="nx">value</span><span class="o">!</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">transform</span> <span class="o">=</span> <span class="sb">`translate3D(</span><span class="si">${</span><span class="nx">leftPos</span><span class="si">}</span><span class="sb">px, 0, 0)`</span><span class="p">;</span>
<span class="p">};</span>

<span class="c1">// 追踪 变更，执行回调
</span><span class="c1"></span><span class="nx">watchEffect</span><span class="p">(()</span> <span class="p">=&gt;</span> <span class="p">{</span>
  <span class="nx">indicatorTraceTab</span><span class="p">();</span>
<span class="p">});</span>

<span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>

<span class="p">&lt;</span><span class="nt">template</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;vue-tabs&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">nav</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;vue-tabs-nav&#34;</span> <span class="na">ref</span><span class="o">=</span><span class="s">&#34;container&#34;</span><span class="p">&gt;</span>
      <span class="p">&lt;</span><span class="nt">div</span> <span class="na">v-for</span><span class="o">=</span><span class="s">&#34;(title, index) in titles&#34;</span>
           <span class="na">:key</span><span class="o">=</span><span class="s">&#34;index&#34;</span>
           <span class="na">:ref</span><span class="o">=</span><span class="s">&#34;(el) =&gt; { if (el &amp;&amp; (title === selected)) selectedItem = el }&#34;</span>
           <span class="na">:class</span><span class="o">=</span><span class="s">&#34;{selected: title === selected}&#34;</span>
           <span class="na">class</span><span class="o">=</span><span class="s">&#34;vue-tabs-nav-item&#34;</span>
           <span class="err">@</span><span class="na">click</span><span class="o">=</span><span class="s">&#34;select(title)&#34;</span><span class="p">&gt;</span>
        {{ title }}
      <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
      <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;vue-tabs-nav-indicator&#34;</span>
           <span class="na">ref</span><span class="o">=</span><span class="s">&#34;indicator&#34;</span><span class="p">&gt;</span>
      <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
    <span class="p">&lt;/</span><span class="nt">nav</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;vue-tabs-content&#34;</span><span class="p">&gt;</span>
      <span class="p">&lt;</span><span class="nt">keep-alive</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">component</span> <span class="na">:is</span><span class="o">=</span><span class="s">&#34;getCurrentTab&#34;</span>
                   <span class="na">:key</span><span class="o">=</span><span class="s">&#34;getCurrentTitle&#34;</span>
                   <span class="na">class</span><span class="o">=</span><span class="s">&#34;vue-tabs-content-item&#34;</span><span class="p">&gt;</span>
        <span class="p">&lt;/</span><span class="nt">component</span><span class="p">&gt;</span>
      <span class="p">&lt;/</span><span class="nt">keep-alive</span><span class="p">&gt;</span>
    <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
  <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">template</span><span class="p">&gt;</span>

<span class="p">&lt;</span><span class="nt">script</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;ts&#34;</span><span class="p">&gt;</span>
<span class="kr">export</span> <span class="k">default</span> <span class="p">{</span>
  <span class="nx">name</span><span class="o">:</span> <span class="s1">&#39;Tabs&#39;</span>
<span class="p">};</span>
<span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>

<span class="p">&lt;</span><span class="nt">style</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;scss&#34;</span><span class="p">&gt;</span>
<span class="p">@</span><span class="k">import</span> <span class="s1">&#39;styles/var&#39;</span><span class="p">;</span>

<span class="p">.</span><span class="nc">vue-tabs</span> <span class="p">{</span>
  <span class="err">&amp;-nav</span> <span class="err">{</span>
    <span class="k">display</span><span class="p">:</span> <span class="kc">flex</span><span class="p">;</span>
    <span class="k">color</span><span class="p">:</span> <span class="err">$</span><span class="n">tab-color</span><span class="p">;</span>
    <span class="k">border-bottom</span><span class="p">:</span> <span class="mi">1</span><span class="kt">px</span> <span class="kc">solid</span> <span class="err">$</span><span class="k">border</span><span class="o">-</span><span class="kc">color</span><span class="p">;</span>
    <span class="k">position</span><span class="p">:</span> <span class="kc">relative</span><span class="p">;</span>

    <span class="err">&amp;-item</span> <span class="err">{</span>
      <span class="k">padding</span><span class="p">:</span> <span class="mi">8</span><span class="kt">px</span> <span class="mi">0</span><span class="p">;</span>
      <span class="k">margin</span><span class="p">:</span> <span class="mi">0</span> <span class="mi">16</span><span class="kt">px</span><span class="p">;</span>
      <span class="k">cursor</span><span class="p">:</span> <span class="kc">pointer</span><span class="p">;</span>

      <span class="err">&amp;:first-child</span> <span class="err">{</span>
        <span class="k">margin-left</span><span class="p">:</span> <span class="mi">0</span><span class="p">;</span>
      <span class="p">}</span>

      <span class="o">&amp;</span><span class="p">.</span><span class="nc">selected</span> <span class="p">{</span>
        <span class="k">color</span><span class="p">:</span> <span class="err">$</span><span class="kc">blue</span><span class="o">-</span><span class="n">underscore</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="err">}</span>

    <span class="o">&amp;</span><span class="nt">-indicator</span> <span class="p">{</span>
      <span class="k">position</span><span class="p">:</span> <span class="kc">absolute</span><span class="p">;</span>
      <span class="k">height</span><span class="p">:</span> <span class="mi">3</span><span class="kt">px</span><span class="p">;</span>
      <span class="k">background-color</span><span class="p">:</span> <span class="err">$</span><span class="kc">blue</span><span class="o">-</span><span class="n">underscore</span><span class="p">;</span>
      <span class="k">left</span><span class="p">:</span> <span class="mi">0</span><span class="p">;</span>
      <span class="k">bottom</span><span class="p">:</span> <span class="mi">-1</span><span class="kt">px</span><span class="p">;</span>
      <span class="k">transition</span><span class="p">:</span> <span class="kc">all</span> <span class="mf">.25</span><span class="kt">s</span><span class="p">;</span>
    <span class="p">}</span>

  <span class="err">}</span>

  <span class="o">&amp;</span><span class="nt">-content</span> <span class="p">{</span>
    <span class="k">padding</span><span class="p">:</span> <span class="mi">8</span><span class="kt">px</span> <span class="mi">0</span><span class="p">;</span>
  <span class="p">}</span>
<span class="err">}</span>
<span class="p">&lt;/</span><span class="nt">style</span><span class="p">&gt;</span></code></pre></td></tr></table>
</div>
</div>
<h3 id="显示或隐藏代码">显示或隐藏代码</h3>

<blockquote>
<p><code>Demo.vue</code></p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-html" data-lang="html"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span><span class="lnt">80
</span><span class="lnt">81
</span><span class="lnt">82
</span><span class="lnt">83
</span><span class="lnt">84
</span><span class="lnt">85
</span><span class="lnt">86
</span><span class="lnt">87
</span><span class="lnt">88
</span><span class="lnt">89
</span><span class="lnt">90
</span><span class="lnt">91
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-html" data-lang="html"><span class="p">&lt;</span><span class="nt">script</span> <span class="na">setup</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;ts&#34;</span><span class="p">&gt;</span>
<span class="kr">import</span> <span class="nx">Prism</span> <span class="nx">from</span> <span class="s1">&#39;prismjs&#39;</span><span class="p">;</span>
<span class="kr">import</span> <span class="s1">&#39;prismjs/themes/prism-okaidia.css&#39;</span><span class="p">;</span>
<span class="kr">import</span> <span class="s1">&#39;prismjs/plugins/line-numbers/prism-line-numbers.css&#39;</span><span class="p">;</span>
<span class="kr">import</span> <span class="s1">&#39;prismjs/plugins/line-numbers/prism-line-numbers.min.js&#39;</span><span class="p">;</span>
<span class="kr">import</span> <span class="nx">VlButton</span> <span class="nx">from</span> <span class="s1">&#39;@/lib/VlButton.vue&#39;</span><span class="p">;</span>
<span class="kr">import</span> <span class="p">{</span><span class="nx">computed</span><span class="p">,</span> <span class="nx">ref</span><span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;vue&#39;</span><span class="p">;</span>

<span class="kr">const</span> <span class="nx">codeVisible</span> <span class="o">=</span> <span class="nx">ref</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>
<span class="kr">const</span> <span class="nx">props</span> <span class="o">=</span> <span class="nx">defineProps</span><span class="p">({</span>
  <span class="nx">component</span><span class="o">:</span> <span class="nb">Object</span>
<span class="p">});</span>
<span class="kr">const</span> <span class="nx">toggle</span> <span class="o">=</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
  <span class="nx">codeVisible</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="o">!</span><span class="nx">codeVisible</span><span class="p">.</span><span class="nx">value</span><span class="p">;</span>
<span class="p">};</span>
<span class="kr">const</span> <span class="nx">html</span> <span class="o">=</span> <span class="nx">computed</span><span class="p">(()</span> <span class="p">=&gt;</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nx">Prism</span><span class="p">.</span><span class="nx">highlight</span><span class="p">(</span><span class="nx">props</span><span class="p">.</span><span class="nx">component</span><span class="o">?</span><span class="p">.</span><span class="nx">__sourceCode</span><span class="p">,</span> <span class="nx">Prism</span><span class="p">.</span><span class="nx">languages</span><span class="p">.</span><span class="nx">html</span><span class="p">,</span> <span class="s1">&#39;html&#39;</span><span class="p">);</span>
<span class="p">});</span>

<span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>

<span class="p">&lt;</span><span class="nt">template</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;vue-demo&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">h2</span><span class="p">&gt;</span>{{ component.__sourceCodeTitle }}<span class="p">&lt;/</span><span class="nt">h2</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;vue-demo-component&#34;</span><span class="p">&gt;</span>
      <span class="p">&lt;</span><span class="nt">keep-alive</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">component</span> <span class="na">:is</span><span class="o">=</span><span class="s">&#34;component&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">component</span><span class="p">&gt;</span>
      <span class="p">&lt;/</span><span class="nt">keep-alive</span><span class="p">&gt;</span>
    <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;vue-demo-actions&#34;</span><span class="p">&gt;</span>
      <span class="p">&lt;</span><span class="nt">VlButton</span> <span class="err">@</span><span class="na">click</span><span class="o">=</span><span class="s">&#34;toggle&#34;</span><span class="p">&gt;</span>{{ codeVisible ? &#39;隐藏代码&#39; : &#39;查看代码&#39; }}<span class="p">&lt;/</span><span class="nt">VlButton</span><span class="p">&gt;</span>
    <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;vue-demo-code&#34;</span> <span class="na">v-show</span><span class="o">=</span><span class="s">&#34;codeVisible&#34;</span><span class="p">&gt;</span>
      <span class="p">&lt;</span><span class="nt">pre</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;language-html&#34;</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">code</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;language-html&#34;</span> <span class="na">v-html</span><span class="o">=</span><span class="s">&#34;html&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">code</span><span class="p">&gt;</span>
      <span class="p">&lt;/</span><span class="nt">pre</span><span class="p">&gt;</span>
    <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
  <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">template</span><span class="p">&gt;</span>

<span class="p">&lt;</span><span class="nt">script</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;ts&#34;</span><span class="p">&gt;</span>
<span class="kr">export</span> <span class="k">default</span> <span class="p">{</span>
  <span class="nx">name</span><span class="o">:</span> <span class="s1">&#39;Demo&#39;</span>
<span class="p">};</span>
<span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>

<span class="p">&lt;</span><span class="nt">style</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;scss&#34;</span> <span class="na">scoped</span><span class="p">&gt;</span>
<span class="o">$</span><span class="nt">border-color</span><span class="o">:</span> <span class="p">#</span><span class="nn">d9d9d9</span><span class="o">;</span>

<span class="p">.</span><span class="nc">vue-demo</span> <span class="p">{</span>
  <span class="k">border</span><span class="p">:</span> <span class="mi">1</span><span class="kt">px</span> <span class="kc">solid</span> <span class="err">$</span><span class="k">border</span><span class="o">-</span><span class="kc">color</span><span class="p">;</span>
  <span class="k">margin</span><span class="p">:</span> <span class="mi">16</span><span class="kt">px</span> <span class="mi">0</span> <span class="mi">32</span><span class="kt">px</span><span class="p">;</span>

  <span class="err">&gt;</span> <span class="err">h2</span> <span class="err">{</span>
    <span class="k">font-size</span><span class="p">:</span> <span class="mi">20</span><span class="kt">px</span><span class="p">;</span>
    <span class="k">padding</span><span class="p">:</span> <span class="mi">8</span><span class="kt">px</span> <span class="mi">16</span><span class="kt">px</span><span class="p">;</span>
    <span class="k">border-bottom</span><span class="p">:</span> <span class="mi">1</span><span class="kt">px</span> <span class="kc">solid</span> <span class="err">$</span><span class="k">border</span><span class="o">-</span><span class="kc">color</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="o">&amp;</span><span class="nt">-component</span> <span class="p">{</span>
    <span class="k">padding</span><span class="p">:</span> <span class="mi">16</span><span class="kt">px</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="o">&amp;</span><span class="nt">-actions</span> <span class="p">{</span>
    <span class="k">padding</span><span class="p">:</span> <span class="mi">8</span><span class="kt">px</span> <span class="mi">16</span><span class="kt">px</span><span class="p">;</span>
    <span class="k">border-top</span><span class="p">:</span> <span class="mi">1</span><span class="kt">px</span> <span class="kc">dashed</span> <span class="err">$</span><span class="k">border</span><span class="o">-</span><span class="kc">color</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="o">&amp;</span><span class="nt">-code</span> <span class="p">{</span>
    <span class="k">padding</span><span class="p">:</span> <span class="mi">8</span><span class="kt">px</span> <span class="mi">16</span><span class="kt">px</span><span class="p">;</span>
    <span class="k">border-top</span><span class="p">:</span> <span class="mi">1</span><span class="kt">px</span> <span class="kc">dashed</span> <span class="err">$</span><span class="k">border</span><span class="o">-</span><span class="kc">color</span><span class="p">;</span>

    <span class="err">&gt;</span> <span class="err">pre</span> <span class="err">{</span>
      <span class="k">line-height</span><span class="p">:</span> <span class="mf">1.1</span><span class="p">;</span>
      <span class="k">font-family</span><span class="p">:</span> <span class="n">Consolas</span><span class="p">,</span> <span class="s1">&#39;Courier New&#39;</span><span class="p">,</span> <span class="n">Courier</span><span class="p">,</span> <span class="kc">monospace</span><span class="p">;</span>
      <span class="k">margin</span><span class="p">:</span> <span class="mi">0</span><span class="p">;</span>
      <span class="k">padding-left</span><span class="p">:</span> <span class="mi">70</span><span class="kt">px</span><span class="p">;</span>

      <span class="err">@media(</span><span class="k">max-width</span><span class="p">:</span> <span class="mi">500</span><span class="kt">px</span><span class="p">)</span> <span class="err">{</span>
        <span class="k">padding</span><span class="o">-</span><span class="kc">left</span><span class="o">:</span> <span class="mi">5</span><span class="kt">px</span><span class="p">;</span>
      <span class="p">}</span>

      <span class="o">&gt;</span> <span class="nt">code</span> <span class="p">{</span>
        <span class="err">&amp;:first-child</span> <span class="err">{</span>
          <span class="k">margin-left</span><span class="p">:</span> <span class="mi">-70</span><span class="kt">px</span><span class="p">;</span>
        <span class="p">}</span>
      <span class="err">}</span>
    <span class="err">}</span>
  <span class="err">}</span>
<span class="err">}</span>
<span class="p">&lt;/</span><span class="nt">style</span><span class="p">&gt;</span></code></pre></td></tr></table>
</div>
</div>
<ul>
<li><code>&lt;VlButton @click=&quot;toggle&quot;&gt;{{ codeVisible ? '隐藏代码' : '查看代码' }}&lt;/VlButton&gt;</code></li>
</ul>

<h3 id="修复-watcheffect">修复 <code>watchEffect</code></h3>

<blockquote>
<p>排除所有可能性，剩下的就是真相</p>
</blockquote>

<ul>
<li>不同版本之间的差异

<ul>
<li><code>RC</code>版和正式版</li>
</ul></li>
<li>查看 <a href="https://github.com/vuejs/vue-next/blob/master/CHANGELOG.md"><code>vuejs/vue-next CHANGELOG.md</code></a>，搜索<code>watchEffect</code>

<ul>
<li>找到 <a href="https://github.com/vuejs/vue-next/blob/master/CHANGELOG.md#breaking-changes-2"><code>3.0.0-rc.13 BREAKING CHANGES</code></a></li>
<li><strong><em><code>watch APIs now default to use flush: 'pre' instead of flush: 'post'. This change affects watch, watchEffect, the watch component option, and this.$watch...</code></em></strong></li>
</ul></li>
<li><a href="https://v3.cn.vuejs.org/guide/reactivity-computed-watchers.html#%E5%89%AF%E4%BD%9C%E7%94%A8%E5%88%B7%E6%96%B0%E6%97%B6%E6%9C%BA"><code>watchEffect 副作用刷新时机</code>文档</a></li>
</ul>

<blockquote>
<p><code>VlTabs.vue</code>的实现思路</p>
</blockquote>

<ul>
<li>当用户点击<code>vue-tabs-nav-item</code>时，执行<code>select(title)</code></li>
<li><code>select(title)</code>会向外发布自定义事件<code>emits('update:selected', title);</code>

<ul>
<li>将<code>title</code>传到外部，让外部组件更新自己的外部属性<code>selected</code></li>
</ul></li>
<li>当<code>selected</code>更新了，<code>selectedItem</code>也更新

<ul>
<li><code>selectedItem = ref&lt;HTMLDivElement&gt;(div)</code></li>
<li><code>&lt;div v-for=&quot;(title, index) in titleListOfDefaultSlots&quot; ... :ref=&quot;(el) =&gt; { if (el &amp;&amp; (title === selected)) selectedItem = el }&quot; @click=&quot;select(title)&quot;&gt;...&lt;/div&gt;</code></li>
</ul></li>

<li><p>如果当<code>selected</code>更新了，<code>selectedItem</code>未更新，就会出现bug</p>

<ul>
<li><code>watchEffect</code>追踪的依赖是<code>selectedItem</code></li>
<li><code>selected</code>变了，去渲染DOM</li>
<li>RC <code>watchEffect post</code> 在渲染DOM后，<code>selectedItem</code>变了</li>

<li><p>正式版 <code>watchEffect pre</code> 在渲染DOM前，<code>selectedItem</code>没变</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="p">...</span>
<span class="c1">// Tab指示下划线跟踪TabItem位置
</span><span class="c1"></span><span class="kr">const</span> <span class="nx">indicatorTraceTab</span> <span class="o">=</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
<span class="kr">const</span> <span class="p">{</span><span class="nx">width</span><span class="p">,</span> <span class="nx">left</span><span class="p">}</span> <span class="o">=</span> <span class="nx">selectedItem</span><span class="p">.</span><span class="nx">value</span><span class="o">!</span><span class="p">.</span><span class="nx">getBoundingClientRect</span><span class="p">();</span>
<span class="kr">const</span> <span class="p">{</span><span class="nx">left</span><span class="o">:</span> <span class="nx">containerLeft</span><span class="p">}</span> <span class="o">=</span> <span class="nx">container</span><span class="p">.</span><span class="nx">value</span><span class="o">!</span><span class="p">.</span><span class="nx">getBoundingClientRect</span><span class="p">();</span>
<span class="kr">const</span> <span class="nx">leftPos</span> <span class="o">=</span> <span class="nx">left</span> <span class="o">-</span> <span class="nx">containerLeft</span><span class="p">;</span>
<span class="nx">indicator</span><span class="p">.</span><span class="nx">value</span><span class="o">!</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">width</span> <span class="o">=</span> <span class="sb">`</span><span class="si">${</span><span class="nx">width</span><span class="si">}</span><span class="sb">px`</span><span class="p">;</span>
<span class="nx">indicator</span><span class="p">.</span><span class="nx">value</span><span class="o">!</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">transform</span> <span class="o">=</span> <span class="sb">`translate3D(</span><span class="si">${</span><span class="nx">leftPos</span><span class="si">}</span><span class="sb">px, 0, 0)`</span><span class="p">;</span>
<span class="p">};</span>

<span class="c1">// 追踪 变更，执行回调
</span><span class="c1"></span><span class="nx">watchEffect</span><span class="p">(()</span> <span class="p">=&gt;</span> <span class="p">{</span>
<span class="nx">indicatorTraceTab</span><span class="p">();</span>
<span class="p">});</span>

<span class="p">...</span>
</code></pre></td></tr></table>
</div>
</div></li>
</ul></li>
</ul>

<p><img src="https://note.youdao.com/yws/api/personal/file/B33078098489460093C1D5375FA1D58D?method=download&amp;shareKey=f09ccc13de2f76a72f740dfddfcf7e1a" alt="watchEffect" /></p>

<ul>
<li><code>watchEffect</code>依赖的<code>selectedItem</code>、<code>container</code>、<code>indicator</code>都不变的话，就不会执行<code>watchEffect</code>回调逻辑</li>
<li>需配置第二个参数<code>, {flush: post}</code>表示等到渲染DOM后再执行</li>
</ul>

<h3 id="再次完善官网">再次完善官网</h3>

<blockquote>
<p><code>install.md</code></p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-md" data-lang="md"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-md" data-lang="md"><span class="gh"># 安装
</span><span class="gh"></span>
打开终端运行下列命令：

\\```
npm install vue3-demo-ui-1
\\```

或

\\```
yarn add vue3-demo-ui-1
\\```

下一节：[开始使用](#/docs/get-started)</code></pre></td></tr></table>
</div>
</div>
<blockquote>
<p><code>getStarted.md</code></p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-md" data-lang="md"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-md" data-lang="md"><span class="gh"># 开始使用
</span><span class="gh"></span>
请先[安装](#/docs/install)本组件库。

然后在你的代码中写入下面的代码：

!```
import <span class="ge">* as vueel3 from &#39;vue3-demo-ui-1&#39;
</span><span class="ge">import &#39;vue3-demo-ui-1/dist/lib/style.css&#39;
</span><span class="ge">const {VlButton, VlTabs, VlSwitch, VlDialog, useDialog} = vueel3
</span><span class="ge">!```
</span><span class="ge">
</span><span class="ge">就可以使用我提供的组件了。
</span><span class="ge">
</span><span class="ge">## Vue 单文件组件 使用时不必使用 ts 语法
</span><span class="ge">
</span><span class="ge">代码示例：
</span><span class="ge">
</span><span class="ge">!```
</span><span class="ge">&lt;template&gt;
</span><span class="ge">  &lt;div&gt;
</span><span class="ge">    &lt;VlButton&gt;按钮&lt;/VlButton&gt;
</span><span class="ge">  &lt;/div&gt;
</span><span class="ge">&lt;/template&gt;
</span><span class="ge">
</span><span class="ge">&lt;script&gt;
</span><span class="ge">import *</span> as vueel3 from &#39;vue3-demo-ui-1&#39;
import &#39;vue3-demo-ui-1/dist/lib/style.css&#39;
const {VlButton, VlTabs, VlSwitch, VlDialog, useDialog} = vueel3

export default {
  components: {VlButton, VlTabs, VlSwitch, VlDialog, useDialog}
}
&lt;/script&gt;
!```</code></pre></td></tr></table>
</div>
</div>
<hr />

<h2 id="总结">总结</h2>

<blockquote>
<p>这样就完成了</p>
</blockquote>

<ul class="task-list">
<li><label><input type="checkbox" checked disabled class="task-list-item"> 部署官网到 GitHub</label></li>
<li><label><input type="checkbox" checked disabled class="task-list-item"> 发布官网页面</label></li>
<li><label><input type="checkbox" checked disabled class="task-list-item"> 部署到码云</label></li>
<li><label><input type="checkbox" checked disabled class="task-list-item"> 脚本化部署</label></li>
<li><label><input type="checkbox" checked disabled class="task-list-item"> 使用 GitHub Actions 持续集成</label></li>
<li><label><input type="checkbox" checked disabled class="task-list-item"> 发布组件库至 npm</label></li>
</ul>

<hr />

<p>初步完成的轮子</p>

<ul>
<li>基于Vue 3.2、TS，使用vite2.0构建打包</li>
<li>使用composition API和<script setup>语法糖</li>
<li><a href="https://gitee.com/xmasuhai/vueel3-demo-1">码云仓库地址</a></li>
<li><a href="https://xmasuhai.gitee.io/vueel3-demo-website/#/">码云在线预览</a></li>
</ul>

<h2 id="把项目加到简历-vue-2-如何升级到-vue-3">把项目加到简历，Vue 2 如何升级到 Vue 3</h2>

<ul>
<li>查看 <a href="https://v3.cn.vuejs.org/guide/migration/introduction.html">Vue 官方迁移指南文档</a></li>
<li>使用官方提供的<a href="https://github.com/vuejs/vue-codemod">工具和教程 vue-codemod</a></li>
<li>使用<a href="https://github.com/thx/gogocode">GoGoCode</a></li>
</ul>

<h2 id="更多">更多</h2>

<ul>
<li>添加其他组件

<ul>
<li><code>Popover</code></li>
<li><code>Datepicker</code></li>
<li><code>Tooltip</code></li>
</ul></li>
<li>使用 <code>JSX</code>、<code>TSX</code></li>
<li>使用 <a href="https://v3.cn.vuejs.org/api/global-api.html#definecomponent"><code>defineComponent</code></a>

<ul>
<li>支持泛型，能更好地与 <code>TypeScript</code> 配合使用</li>
</ul></li>
<li>通读<a href="https://v3.cn.vuejs.org/guide/introduction.html">Vue3 中文文档</a></li>
</ul>

<hr />

<hr />

    </div>

    
    
<div class="post-copyright">
  <p class="copyright-item">
    <span class="item-title">文章作者</span>
    <span class="item-content">Joel Xu</span>
  </p>
  <p class="copyright-item">
    <span class="item-title">上次更新</span>
    <span class="item-content">
      2022-06-28
      
        
        
      
    </span>
  </p>
  
  <p class="copyright-item">
    <span class="item-title">许可协议</span>
    <span class="item-content"><a rel="license noopener" href="https://creativecommons.org/licenses/by-nc-nd/4.0/" target="_blank">CC BY-NC-ND 4.0</a></span>
  </p>
</div>


    
    

    <footer class="post-footer">
      <div class="post-tags">
          <a href="http://xmasuhai.xyz/tags/frontend/">FrontEnd</a>
          <a href="http://xmasuhai.xyz/tags/project/">Project</a>
          <a href="http://xmasuhai.xyz/tags/vueel/">vueel</a>
          
        </div>

      
      <nav class="post-nav">
        
          <a class="prev" href="/post/project/share-blog/%E9%A1%B9%E7%9B%AE-%E5%A4%9A%E4%BA%BA%E5%85%B1%E4%BA%AB%E5%8D%9A%E5%AE%A21.%E9%A1%B9%E7%9B%AE%E6%A6%82%E8%BF%B0%E4%B8%8E%E6%90%AD%E5%BB%BA/">
            
            <i class="iconfont">
              <svg  class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="18" height="18">
  <path d="M691.908486 949.511495l75.369571-89.491197c10.963703-12.998035 10.285251-32.864502-1.499144-44.378743L479.499795 515.267417 757.434875 204.940602c11.338233-12.190647 11.035334-32.285311-0.638543-44.850487l-80.46666-86.564541c-11.680017-12.583596-30.356378-12.893658-41.662889-0.716314L257.233596 494.235404c-11.332093 12.183484-11.041474 32.266891 0.657986 44.844348l80.46666 86.564541c1.772366 1.910513 3.706415 3.533476 5.750981 4.877077l306.620399 321.703933C662.505829 963.726242 680.945807 962.528973 691.908486 949.511495z"></path>
</svg>

            </i>
            <span class="prev-text nav-default">【项目 多人共享博客】1.项目概述与搭建</span>
            <span class="prev-text nav-mobile">上一篇</span>
          </a>
        
          <a class="next" href="/post/project/vueel3/%E9%A1%B9%E7%9B%AE-vue3-%E8%BD%AE%E5%AD%901.7-%E5%AE%98%E7%BD%91%E8%A3%85%E4%BF%AE-%E6%96%87%E6%A1%A3%E9%A1%B5/">
            <span class="next-text nav-default">【项目 Vue3 轮子】1.7 官网装修 文档页</span>
            <span class="prev-text nav-mobile">下一篇</span>
            
            <i class="iconfont">
              <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="18" height="18">
  <path d="M332.091514 74.487481l-75.369571 89.491197c-10.963703 12.998035-10.285251 32.864502 1.499144 44.378743l286.278095 300.375162L266.565125 819.058374c-11.338233 12.190647-11.035334 32.285311 0.638543 44.850487l80.46666 86.564541c11.680017 12.583596 30.356378 12.893658 41.662889 0.716314l377.434212-421.426145c11.332093-12.183484 11.041474-32.266891-0.657986-44.844348l-80.46666-86.564541c-1.772366-1.910513-3.706415-3.533476-5.750981-4.877077L373.270379 71.774697C361.493148 60.273758 343.054193 61.470003 332.091514 74.487481z"></path>
</svg>

            </i>
          </a>
      </nav>
    </footer>
  </article>

  
  
  
  

  
  

  

  
  

  

  

  

    

  

        </div>
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="icon-links">
  
  
    <a href="mailto:xmasuhai@163.com" rel="me noopener" class="iconfont"
      title="email" >
      <svg class="icon" viewBox="0 0 1451 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="36" height="36">
  <path d="M664.781909 681.472759 0 97.881301C0 3.997201 71.046997 0 71.046997 0L474.477909 0 961.649408 0 1361.641813 0C1361.641813 0 1432.688811 3.997201 1432.688811 97.881301L771.345323 681.472759C771.345323 681.472759 764.482731 685.154773 753.594283 688.65053L753.594283 688.664858C741.602731 693.493018 729.424896 695.068979 718.077952 694.839748 706.731093 695.068979 694.553173 693.493018 682.561621 688.664858L682.561621 688.65053C671.644501 685.140446 664.781909 681.472759 664.781909 681.472759L664.781909 681.472759ZM718.063616 811.603883C693.779541 811.016482 658.879232 802.205449 619.10784 767.734955 542.989056 701.759633 0 212.052267 0 212.052267L0 942.809523C0 942.809523 0 1024 83.726336 1024L682.532949 1024 753.579947 1024 1348.948139 1024C1432.688811 1024 1432.688811 942.809523 1432.688811 942.809523L1432.688811 212.052267C1432.688811 212.052267 893.138176 701.759633 817.019477 767.734955 777.248 802.205449 742.347691 811.03081 718.063616 811.603883L718.063616 811.603883Z"></path>
</svg>

    </a>
  
    <a href="https://github.com/xmasuhai" rel="me noopener" class="iconfont"
      title="github"  target="_blank"
      >
      <svg class="icon" style="" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="36" height="36">
  <path d="M512 12.672c-282.88 0-512 229.248-512 512 0 226.261333 146.688 418.133333 350.08 485.76 25.6 4.821333 34.986667-11.008 34.986667-24.618667 0-12.16-0.426667-44.373333-0.64-87.04-142.421333 30.890667-172.458667-68.693333-172.458667-68.693333C188.672 770.986667 155.008 755.2 155.008 755.2c-46.378667-31.744 3.584-31.104 3.584-31.104 51.413333 3.584 78.421333 52.736 78.421333 52.736 45.653333 78.293333 119.850667 55.68 149.12 42.581333 4.608-33.109333 17.792-55.68 32.426667-68.48-113.706667-12.8-233.216-56.832-233.216-253.013333 0-55.893333 19.84-101.546667 52.693333-137.386667-5.76-12.928-23.04-64.981333 4.48-135.509333 0 0 42.88-13.738667 140.8 52.48 40.96-11.392 84.48-17.024 128-17.28 43.52 0.256 87.04 5.888 128 17.28 97.28-66.218667 140.16-52.48 140.16-52.48 27.52 70.528 10.24 122.581333 5.12 135.509333 32.64 35.84 52.48 81.493333 52.48 137.386667 0 196.693333-119.68 240-233.6 252.586667 17.92 15.36 34.56 46.762667 34.56 94.72 0 68.522667-0.64 123.562667-0.64 140.202666 0 13.44 8.96 29.44 35.2 24.32C877.44 942.592 1024 750.592 1024 524.672c0-282.752-229.248-512-512-512"></path>
</svg>

    </a>
  
    <a href="https://www.zhihu.com/people/xue-shou-41/posts" rel="me noopener" class="iconfont"
      title="zhihu"  target="_blank"
      >
      <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="36" height="36">
  <path d="M351.791182 562.469462l192.945407 0c0-45.367257-21.3871-71.939449-21.3871-71.939449L355.897709 490.530013c3.977591-82.182744 7.541767-187.659007 8.816806-226.835262l159.282726 0c0 0-0.86367-67.402109-18.578124-67.402109s-279.979646 0-279.979646 0 16.850783-88.141456 39.318494-127.053698c0 0-83.60514-4.510734-112.121614 106.962104S81.344656 355.077018 76.80834 367.390461c-4.536316 12.313443 24.62791 5.832845 36.941354 0 12.313443-5.832845 68.050885-25.924439 84.252893-103.69571l86.570681 0c1.165546 49.28652 4.596691 200.335724 3.515057 226.835262L109.86113 490.530013c-25.275663 18.147312-33.701566 71.939449-33.701566 71.939449L279.868105 562.469462c-8.497535 56.255235-23.417339 128.763642-44.275389 167.210279-33.05279 60.921511-50.55235 116.65793-169.802314 212.576513 0 0-19.442818 14.257725 40.829917 9.073656 60.273758-5.185093 117.305683-20.739347 156.840094-99.807147 20.553105-41.107233 41.805128-93.250824 58.386782-146.138358l-0.055259 0.185218 167.855986 193.263655c0 0 22.035876-51.847855 5.832845-108.880803L371.045711 650.610918l-42.1244 31.157627-0.045025 0.151449c11.69946-41.020252 20.11206-81.5749 22.726607-116.858498C351.665315 564.212152 351.72876 563.345412 351.791182 562.469462z"></path>
  <path d="M584.918753 182.033893l0 668.840094 70.318532 0 28.807093 80.512708 121.875768-80.512708 153.600307 0L959.520453 182.033893 584.918753 182.033893zM887.150192 778.934538l-79.837326 0-99.578949 65.782216-23.537066-65.782216-24.855084 0L659.341766 256.673847l227.807403 0L887.149169 778.934538z"></path>
</svg>

    </a>


<a href="http://xmasuhai.xyz/index.xml" rel="noopener alternate" type="application/rss&#43;xml"
    class="iconfont" title="rss" target="_blank">
    <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="30" height="30">
  <path d="M819.157333 1024C819.157333 574.592 449.408 204.8 0 204.8V0c561.706667 0 1024 462.293333 1024 1024h-204.842667zM140.416 743.04a140.8 140.8 0 0 1 140.501333 140.586667A140.928 140.928 0 0 1 140.074667 1024C62.72 1024 0 961.109333 0 883.626667s62.933333-140.544 140.416-140.586667zM678.784 1024h-199.04c0-263.210667-216.533333-479.786667-479.744-479.786667V345.173333c372.352 0 678.784 306.517333 678.784 678.826667z"></path>
</svg>

  </a>
   
</div>

<div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://gohugo.io">Hugo</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Theme - <a class="theme-link" href="https://github.com/xianmin/hugo-theme-jane">Jane</a>
  </span>

  <span class="copyright-year">
    &copy;
    
      2019 -
    2026
    <span class="heart">
      
      <i class="iconfont">
        <svg class="icon" viewBox="0 0 1025 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="14" height="14">
  <path d="M1000.1 247.9c-15.5-37.3-37.6-70.6-65.7-98.9-54.4-54.8-125.8-85-201-85-85.7 0-166 39-221.4 107.4C456.6 103 376.3 64 290.6 64c-75.1 0-146.5 30.4-201.1 85.6-28.2 28.5-50.4 61.9-65.8 99.3-16 38.8-24 79.9-23.6 122.2 0.7 91.7 40.1 177.2 108.1 234.8 3.1 2.6 6 5.1 8.9 7.8 14.9 13.4 58 52.8 112.6 102.7 93.5 85.5 209.9 191.9 257.5 234.2 7 6.1 15.8 9.5 24.9 9.5 9.2 0 18.1-3.4 24.9-9.5 34.5-30.7 105.8-95.9 181.4-165 74.2-67.8 150.9-138 195.8-178.2 69.5-57.9 109.6-144.4 109.9-237.3 0.1-42.5-8-83.6-24-122.2z"
   fill="#8a8a8a"></path>
</svg>

      </i>
    </span><span class="author">
        Joel Xu
        
      </span></span>

  
  

  
</div>

    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont">
        
        <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="35" height="35">
  <path d="M510.866688 227.694839 95.449397 629.218702l235.761562 0-2.057869 328.796468 362.40389 0L691.55698 628.188232l241.942331-3.089361L510.866688 227.694839zM63.840492 63.962777l894.052392 0 0 131.813095L63.840492 195.775872 63.840492 63.962777 63.840492 63.962777zM63.840492 63.962777"></path>
</svg>

      </i>
    </div>
  </div>
  
<script type="text/javascript" src="/lib/jquery/jquery-3.2.1.min.js"></script>
  <script type="text/javascript" src="/lib/slideout/slideout-1.0.1.min.js"></script>




<script type="text/javascript" src="/js/main.638251f4230630f0335d8c6748e53a96f94b72670920b60c09a56fdc8bece214.js" integrity="sha256-Y4JR9CMGMPAzXYxnSOU6lvlLcmcJILYMCaVv3Ivs4hQ=" crossorigin="anonymous"></script>












  
    <script type="text/javascript" src="/js/load-photoswipe.js"></script>
    <script type="text/javascript" src="/lib/photoswipe/photoswipe.min.js"></script>
    <script type="text/javascript" src="/lib/photoswipe/photoswipe-ui-default.min.js"></script>
  















</body>
</html>
